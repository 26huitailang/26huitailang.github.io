[{"content":"å¼€å‘ç¼–è¾‘å™¨/IDE vim vscode goland pycharm CI/CD gitlab CI/CD github actions teamcity éƒ¨ç½²é€‰æ‹© docker supervisor pm2 systemd ç½‘ç»œå·¥å…· wireshark socat tcpdump Go Golang å¼€å‘ç¯å¢ƒå‡†å¤‡å’Œå·¥å…·é€‰æ‹©\nå‚è€ƒAlikhll/golang-developer-roadmapã€‚\næ›´å¤šå…³äºgolangçš„åˆ†äº«ï¼Œå‚è€ƒAwesome-go\nåŒ…ç®¡ç† åŠ é€Ÿ/ç§æœ‰æ¨¡å— ç»„ä»¶ CLIå·¥å…·å¼€å‘ cobra Config viper Web GinğŸº EchoğŸº Beego go-swagger Iris ORM GormğŸº Xorm DB PGğŸº RedisğŸº MongoDB Log ZapğŸº Logrus Websocket gorilla/websocket Task schedule Gron test testify convey, bdd python lint black isort darker ","permalink":"https://26huitailang.github.io/posts/devenv/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/","summary":"å¼€å‘ç¼–è¾‘å™¨/IDE vim vscode goland pycharm CI/CD gitlab CI/CD github actions teamcity éƒ¨ç½²é€‰æ‹© docker supervisor pm2 systemd ç½‘ç»œå·¥å…· wireshark socat tcpdump Go Golang å¼€å‘ç¯å¢ƒå‡†å¤‡å’Œå·¥å…·é€‰æ‹©\nå‚è€ƒAlikhll/golang-developer-roadmapã€‚\næ›´å¤šå…³äºgolangçš„åˆ†äº«ï¼Œå‚è€ƒAwesome-go\nåŒ…ç®¡ç† åŠ é€Ÿ/ç§æœ‰æ¨¡å— ç»„ä»¶ CLIå·¥å…·å¼€å‘ cobra Config viper Web GinğŸº EchoğŸº Beego go-swagger Iris ORM GormğŸº Xorm DB PGğŸº RedisğŸº MongoDB Log ZapğŸº Logrus Websocket gorilla/websocket Task schedule Gron test testify convey, bdd python lint black isort darker ","title":"å¼€å‘ç¯å¢ƒ"},{"content":"é—®é¢˜ åœ¨Centosä¸Šé‡åˆ°sqlite3ç‰ˆæœ¬è¿‡ä½çš„é—®é¢˜, 3.7., ä½†æ˜¯djangoè¦æ±‚ç‰ˆæœ¬ä¸ä½äº3.8., è‡ªå·±ç¼–è¯‘å‡çº§å, è¿˜æ˜¯æ— æ³•è§£å†³: åŸå› æ˜¯pythonæ‰¾å¯»åŠ¨æ€åº“çš„ä½ç½®ä¸å¯¹\n# ä¸‹è½½å¹¶è§£å‹ [root@linux ~]# wget https://www.sqlite.org/2019/sqlite-autoconf-3270200.tar.gz [root@linux ~]# tar xf sqlite-autoconf-3270200.tar.gz # configure ç”Ÿæˆmakefileå¹¶æŒ‡å®šå®‰è£…è·¯å¾„ [root@linux ~]# cd sqlite-autoconf-3270200 [root@linux sqlite-autoconf-3270200]# ./configure --prefix=/usr/local/ [root@linux sqlite-autoconf-3270200]# make \u0026amp;\u0026amp; make install # å¤‡ä»½æ—§ç‰ˆæœ¬ [root@linux ~]# mv /usr/bin/sqlite3 /usr/bin/sqlite3_backupold # é“¾æ¥æ–°ç‰ˆæœ¬ [root@linux ~]# ln -s /usr/local/bin/sqlite3 /usr/bin/sqlite3 # ç¯å¢ƒå˜é‡è®¾ç½® [root@linux ~]# vim ~/.bashrc æ·»åŠ å†…å®¹å¦‚ä¸‹, LD_LIBRARY_PATH é»˜è®¤æ˜¯æ²¡æœ‰è®¾ç½®çš„, å¦‚æœè®¾ç½®äº†ä¼šä¼˜å…ˆä½¿ç”¨\nexport LD_LIBRARY_PATH=\u0026#34;/usr/local/lib\u0026#34; json1 å‚è€ƒï¼šhowto_get_going_with_sqlite_json1\nä½¿ç”¨ç‰ˆæœ¬3.7.17ï¼Œæœ€ä½æ”¯æŒç‰ˆæœ¬3.9.0\nå°è¯•ç¼–è¯‘json.so å»3.7.17ä¸­.load json.so ç»“è®ºï¼š3.7.17 å¯ä»¥åŠ è½½ï¼Œä½†æ˜¯è¿è¡ŒæŠ¥é”™segmentation faultï¼Œåº”è¯¥è¿˜æ˜¯æœ‰ä»£ç ä¸å…¼å®¹ï¼Œç›´æ¥åœ¨3.9.0ä¸Šå¯åŠ è½½ã€å¯è¿è¡Œ ä¸‹è½½ï¼š\nwget https://www.sqlite.org/2013/sqlite-autoconf-3071700.tar.gz # sqlite ä¸­æŸ¥çœ‹ç¼–è¯‘é€‰é¡¹ ENABLE_JSON1 pragma compile_options; ä½¿ç”¨Makefileç”Ÿæˆjson1.soï¼Œ3.38ä»£ç å·²ç»ç§»åŠ¨åˆ°src/ç›®å½•\n# Makefile json1.so: json1.lo $(LTCOMPILE) -c -fPIC $(TOP)/ext/misc/json1.c $(TCC) -shared -o json1.so json1.o $ make $ make json1.so pythoné›†æˆ sqlite-autoconf-3420000.tar.gzï¼Œé»˜è®¤æ”¯æŒjson1 Python-2.7.5.tar.xz Python-3.8.6.tar.xz tar -xf sqlite3-autoconf-3420000.tar.gz tar -xf Python-2.7.5.tar.xz tar -xf Python-3.8.6.tar.xz cd sqlite3-autoconf-3420000 ./configure make make install sqlite3 -version # py2 sudo apt-get install build-essential libsqlite3-dev zlib1g-dev libncurses5-dev libgdbm-dev libbz2-dev libssl-dev libdb-dev ./configure --prefix=/usr --enable-shared --with-ensurepip=install --enable-optimizations make make install # py3 ./configure --prefix=/usr --enable-shared --enable-optimizations make make install sqlalchemy slqite jsonæ”¯æŒ\nnew in version 1.3 pip install sqlalchemy\u0026gt;=1.3 demo\n-- test.sql CREATE table users(id int, data json); INSERT INTO users (id, data) VALUES (1, json(\u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;Alice\u0026#34;, \u0026#34;age\u0026#34;: 25, \u0026#34;email\u0026#34;: \u0026#34;alice@example.com\u0026#34;}\u0026#39;)); INSERT INTO users (id, data) VALUES (2, json(\u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;Bob\u0026#34;, \u0026#34;age\u0026#34;: 35, \u0026#34;email\u0026#34;: \u0026#34;bob@example.com\u0026#34;}\u0026#39;)); INSERT INTO users (id, data) VALUES (3, json(\u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;Chalice\u0026#34;, \u0026#34;age\u0026#34;: 17, \u0026#34;email\u0026#34;: \u0026#34;chalice@example.com\u0026#34;}\u0026#39;)); INSERT INTO users (id, data) VALUES (4, json(\u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;David\u0026#34;, \u0026#34;age\u0026#34;: 80, \u0026#34;email\u0026#34;: \u0026#34;david@example.com\u0026#34;}\u0026#39;)); åˆ›å»ºæµ‹è¯•db\nsqlite3 testdb \u0026lt; test.sql import sqlite3 from sqlalchemy import JSON, Column, Integer, Sequence, create_engine from sqlalchemy.ext.declarative import declarative_base from sqlalchemy.orm import sessionmaker print(f\u0026#34;sqlite3.version {sqlite3.version}\u0026#34;) print(f\u0026#34;sqlite3.sqlite_version {sqlite3.sqlite_version}\u0026#34;) c = sqlite3.connect(\u0026#34;testdb\u0026#34;) cur = c.cursor() res = cur.execute( \u0026#34;select * from users, json_each(users.data) where json_each.key=\u0026#39;age\u0026#39; and json_each.value\u0026lt;30;\u0026#34; ) data = res.fetchall() print(\u0026#34;use json_each and raw query: \\n\u0026#34;) print(data) print(data[1], type(data[1])) print(\u0026#34;use sqlalchemy\u0026#34;) engine = create_engine(\u0026#34;sqlite:///testdb\u0026#34;, echo=True) EntityBase = declarative_base() class Item(EntityBase): __tablename__ = \u0026#34;users\u0026#34; id = Column(Integer, primary_key=True, nullable=False) data = Column(JSON, nullable=True) Session = sessionmaker(bind=engine) session = Session() for item in session.query(Item).all(): print(type(item.data)) print(item.id, item.data) (py3) 26huitailang in ~/PycharmProjects/sqlite3-json-demo Î» python main.py sqlite3.version 2.6.0 sqlite3.sqlite_version 3.39.5 use json_each and raw query: [(1, \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;Alice\u0026#34;,\u0026#34;age\u0026#34;:25,\u0026#34;email\u0026#34;:\u0026#34;alice@example.com\u0026#34;}\u0026#39;, \u0026#39;age\u0026#39;, 25, \u0026#39;integer\u0026#39;, 25, 4, None, \u0026#39;$.age\u0026#39;, \u0026#39;$\u0026#39;), (3, \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;Chalice\u0026#34;,\u0026#34;age\u0026#34;:17,\u0026#34;email\u0026#34;:\u0026#34;chalice@example.com\u0026#34;}\u0026#39;, \u0026#39;age\u0026#39;, 17, \u0026#39;integer\u0026#39;, 17, 4, None, \u0026#39;$.age\u0026#39;, \u0026#39;$\u0026#39;)] (3, \u0026#39;{\u0026#34;name\u0026#34;:\u0026#34;Chalice\u0026#34;,\u0026#34;age\u0026#34;:17,\u0026#34;email\u0026#34;:\u0026#34;chalice@example.com\u0026#34;}\u0026#39;, \u0026#39;age\u0026#39;, 17, \u0026#39;integer\u0026#39;, 17, 4, None, \u0026#39;$.age\u0026#39;, \u0026#39;$\u0026#39;) \u0026lt;class \u0026#39;tuple\u0026#39;\u0026gt; use sqlalchemy 2023-09-13 15:45:14,558 INFO sqlalchemy.engine.base.Engine SELECT CAST(\u0026#39;test plain returns\u0026#39; AS VARCHAR(60)) AS anon_1 2023-09-13 15:45:14,558 INFO sqlalchemy.engine.base.Engine () 2023-09-13 15:45:14,558 INFO sqlalchemy.engine.base.Engine SELECT CAST(\u0026#39;test unicode returns\u0026#39; AS VARCHAR(60)) AS anon_1 2023-09-13 15:45:14,558 INFO sqlalchemy.engine.base.Engine () 2023-09-13 15:45:14,559 INFO sqlalchemy.engine.base.Engine BEGIN (implicit) 2023-09-13 15:45:14,559 INFO sqlalchemy.engine.base.Engine SELECT users.id AS users_id, users.data AS users_data FROM users 2023-09-13 15:45:14,559 INFO sqlalchemy.engine.base.Engine () \u0026lt;class \u0026#39;dict\u0026#39;\u0026gt; 1 {\u0026#39;name\u0026#39;: \u0026#39;Alice\u0026#39;, \u0026#39;age\u0026#39;: 25, \u0026#39;email\u0026#39;: \u0026#39;alice@example.com\u0026#39;} \u0026lt;class \u0026#39;dict\u0026#39;\u0026gt; 2 {\u0026#39;name\u0026#39;: \u0026#39;Bob\u0026#39;, \u0026#39;age\u0026#39;: 35, \u0026#39;email\u0026#39;: \u0026#39;bob@example.com\u0026#39;} \u0026lt;class \u0026#39;dict\u0026#39;\u0026gt; 3 {\u0026#39;name\u0026#39;: \u0026#39;Chalice\u0026#39;, \u0026#39;age\u0026#39;: 17, \u0026#39;email\u0026#39;: \u0026#39;chalice@example.com\u0026#39;} \u0026lt;class \u0026#39;dict\u0026#39;\u0026gt; 4 {\u0026#39;name\u0026#39;: \u0026#39;David\u0026#39;, \u0026#39;age\u0026#39;: 80, \u0026#39;email\u0026#39;: \u0026#39;david@example.com\u0026#39;} ","permalink":"https://26huitailang.github.io/posts/database/sqlite/","summary":"é—®é¢˜ åœ¨Centosä¸Šé‡åˆ°sqlite3ç‰ˆæœ¬è¿‡ä½çš„é—®é¢˜, 3.7., ä½†æ˜¯djangoè¦æ±‚ç‰ˆæœ¬ä¸ä½äº3.8., è‡ªå·±ç¼–è¯‘å‡çº§å, è¿˜æ˜¯æ— æ³•è§£å†³: åŸå› æ˜¯pythonæ‰¾å¯»åŠ¨æ€åº“çš„ä½ç½®ä¸å¯¹\n# ä¸‹è½½å¹¶è§£å‹ [root@linux ~]# wget https://www.sqlite.org/2019/sqlite-autoconf-3270200.tar.gz [root@linux ~]# tar xf sqlite-autoconf-3270200.tar.gz # configure ç”Ÿæˆmakefileå¹¶æŒ‡å®šå®‰è£…è·¯å¾„ [root@linux ~]# cd sqlite-autoconf-3270200 [root@linux sqlite-autoconf-3270200]# ./configure --prefix=/usr/local/ [root@linux sqlite-autoconf-3270200]# make \u0026amp;\u0026amp; make install # å¤‡ä»½æ—§ç‰ˆæœ¬ [root@linux ~]# mv /usr/bin/sqlite3 /usr/bin/sqlite3_backupold # é“¾æ¥æ–°ç‰ˆæœ¬ [root@linux ~]# ln -s /usr/local/bin/sqlite3 /usr/bin/sqlite3 # ç¯å¢ƒå˜é‡è®¾ç½® [root@linux ~]# vim ~/.bashrc æ·»åŠ å†…å®¹å¦‚ä¸‹, LD_LIBRARY_PATH é»˜è®¤æ˜¯æ²¡æœ‰è®¾ç½®çš„, å¦‚æœè®¾ç½®äº†ä¼šä¼˜å…ˆä½¿ç”¨\nexport LD_LIBRARY_PATH=\u0026#34;/usr/local/lib\u0026#34; json1 å‚è€ƒï¼šhowto_get_going_with_sqlite_json1\nä½¿ç”¨ç‰ˆæœ¬3.7.17ï¼Œæœ€ä½æ”¯æŒç‰ˆæœ¬3.9.0\nå°è¯•ç¼–è¯‘json.so å»3.7.17ä¸­.load json.so ç»“è®ºï¼š3.7.17 å¯ä»¥åŠ è½½ï¼Œä½†æ˜¯è¿è¡ŒæŠ¥é”™segmentation faultï¼Œåº”è¯¥è¿˜æ˜¯æœ‰ä»£ç ä¸å…¼å®¹ï¼Œç›´æ¥åœ¨3.","title":"sqliteè§†å›¾"},{"content":"Fabricå­¦ä¹  [toc]\næ€»ç»“ fabric3 ç§»é™¤äº†å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½å’Œè£…é¥°å™¨ï¼Œå˜å¾—æ›´ç²¾ç®€äº†ï¼Œå¦å¤–fabè¿™ä¸ªcliå…¥å£æä¾›çš„å‚æ•°èƒ½åŠ›ä¹Ÿå˜å¼±äº†ï¼Œç›®å‰ä¸ªäººå®ç”¨çš„æ–¹å¼æ˜¯typer+fabric3+makefileï¼š\ntyper ä½œä¸ºå‚æ•°è§£æå…¥å£ makefile å›ºå®šä¸€äº›æ“ä½œé€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨å®ƒçš„å¹¶å‘æ“ä½œï¼Œè€Œä¸æ˜¯ThreadingGroup Link Welcome to Fabric! Welcome to Invokeâ€™s documentation! ä½¿ç”¨ Fabric è‡ªåŠ¨åŒ–éƒ¨ç½² What is Fabric pythonçš„ä¸€ä¸ªhigh levelçš„åº“ï¼Œé€šè¿‡sshæ‰§è¡Œshellå‘½ä»¤ã€‚\nåŸºäºä»¥ä¸‹ä¸¤ä¸ªåŒ…æ„å»ºçš„ï¼š\nInvokeï¼Œsubprocess command execution and command-line features Paramikoï¼ŒSSH protocol implementation ç§é’¥é…ç½® é…ç½®sshçš„authorized_keysï¼Œå°†æœ¬æœºçš„id_rsa.pubä¿¡æ¯å¤åˆ¶åˆ°è¿œç¨‹çš„authorized_keysæ–‡ä»¶ä¸­ ç®€è¦ç”¨æ³• pty(prompt by hand)ï¼Œå¦‚æœsudoæœ‰å¯†ç ï¼Œé‚£ä¹ˆç”¨ptyæ¥æ‰‹åŠ¨è¾“å…¥ \u0026gt;\u0026gt;\u0026gt; from fabric import Connection \u0026gt;\u0026gt;\u0026gt; c = Connection(\u0026#39;192.168.9.139\u0026#39;) \u0026gt;\u0026gt;\u0026gt; c.run(\u0026#39;sudo useradd mydbuser\u0026#39;, pty=True) [sudo] password: \u0026lt;Result cmd=\u0026#39;sudo useradd mydbuser\u0026#39; exited=0\u0026gt; \u0026gt;\u0026gt;\u0026gt; c.run(\u0026#39;id -u mydbuser\u0026#39;) åˆ©ç”¨Invokeçš„è‡ªåŠ¨å›åº”æ¥è¾“å…¥sudoå¯†ç ï¼Œæ³¨æ„patternçš„æ­£ç¡®åŒ¹é…ï¼Œä»¥åŠrepsoneseçš„ç»“å°¾ç¬¦å· \u0026gt;\u0026gt;\u0026gt; from invoke import Responder \u0026gt;\u0026gt;\u0026gt; from fabric import Connection \u0026gt;\u0026gt;\u0026gt; c = Connection(\u0026#39;host\u0026#39;) \u0026gt;\u0026gt;\u0026gt; sudopass = Responder( ... pattern=r\u0026#39;\\[sudo\\] password:\u0026#39;, ... response=\u0026#39;mypassword\\n\u0026#39;, ... ) \u0026gt;\u0026gt;\u0026gt; c.run(\u0026#39;sudo whoami\u0026#39;, pty=True, watchers=[sudopass]) [sudo] password: root \u0026lt;Result cmd=\u0026#39;sudo whoami\u0026#39; exited=0\u0026gt; watchersè™½ç„¶æä¾›äº†è‡ªåŠ¨å¡«å……å¯†ç çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä»£ç ä¸­å¤šæ¬¡å¼•ç”¨è¿™ç§é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥è€ƒè™‘å°†sudopassçš„å†…å®¹æ”¾å…¥é…ç½®é‡Œé¢ï¼Œè®©Connection.sudoæ¥å¤„ç†å‰©ä¸‹çš„å·¥ä½œã€‚ \u0026gt;\u0026gt;\u0026gt; import getpass \u0026gt;\u0026gt;\u0026gt; from fabric import Connection, Config \u0026gt;\u0026gt;\u0026gt; sudo_pass = getpass.getpass(\u0026#34;What\u0026#39;s your sudo password?\u0026#34;) What\u0026#39;s your sudo password? \u0026gt;\u0026gt;\u0026gt; config = Config(overrides={\u0026#39;sudo\u0026#39;: {\u0026#39;password\u0026#39;: sudo_pass}}) \u0026gt;\u0026gt;\u0026gt; c = Connection(\u0026#39;db1\u0026#39;, config=config) \u0026gt;\u0026gt;\u0026gt; c.sudo(\u0026#39;whoami\u0026#39;, hide=\u0026#39;stderr\u0026#39;) root \u0026lt;Result cmd=\u0026#34;...whoami\u0026#34; exited=0\u0026gt; \u0026gt;\u0026gt;\u0026gt; c.sudo(\u0026#39;useradd mydbuser\u0026#39;) \u0026lt;Result cmd=\u0026#34;...useradd mydbuser\u0026#34; exited=0\u0026gt; \u0026gt;\u0026gt;\u0026gt; c.run(\u0026#39;id -u mydbuser\u0026#39;) 1001 \u0026lt;Result cmd=\u0026#39;id -u mydbuser\u0026#39; exited=0\u0026gt; æ–‡ä»¶ä¼ è¾“ï¼Œtransfer filesï¼Œåˆ©ç”¨Connection.putå’ŒConnection.getã€‚åœ¨ä½¿ç”¨æ—¶å‘ç°å¦‚æœåƒä¸‹é¢è¿™æ ·å®šä¹‰remoteçš„è¯ï¼Œä¼šæŠ¥é”™OSErrorï¼Œè¦å¸¦ä¸Šè¿œç¨‹çš„æ–‡ä»¶é‡å‘½åå°±ä¸ä¼šæŠ¥é”™ã€‚ \u0026gt;\u0026gt;\u0026gt; from fabric import Connection \u0026gt;\u0026gt;\u0026gt; result = Connection(\u0026#39;web1\u0026#39;).put(\u0026#39;myfiles.tgz\u0026#39;, remote=\u0026#39;/opt/mydata/\u0026#39;) \u0026gt;\u0026gt;\u0026gt; print(\u0026#34;Uploaded {0.local} to {0.remote}\u0026#34;.format(result)) Uploaded /local/myfiles.tgz to /opt/mydata/ ä¹‹å‰éƒ½æ˜¯å•è¡Œçš„æ“ä½œï¼Œå®é™…å¤šåŠä¸æ˜¯è¿™æ ·ï¼Œå¤šä¸ªåŒæ—¶æ‰§è¡Œï¼Œå¦‚ä¸Šä¼ ã€è§£å‹ï¼Œè·¯å¾„ã€æ–‡ä»¶åå¯ä»¥ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä»¥ä¾¿å¤ç”¨å‡½æ•° from fabric import Connection c = Connection(\u0026#39;web1\u0026#39;) c.put(\u0026#39;myfiles.tgz\u0026#39;, \u0026#39;/opt/mydata\u0026#39;) c.run(\u0026#39;tar -C /opt/mydata -xzvf /opt/mydata/myfiles.tgz\u0026#39;) def upload_and_unpack(c): c.put(\u0026#39;myfiles.tgz\u0026#39;, \u0026#39;/opt/mydata\u0026#39;) c.run(\u0026#39;tar -C /opt/mydata -xzvf /opt/mydata/myfiles.tgz\u0026#39;) å¤šæœåŠ¡å™¨çš„æƒ…å†µï¼Œè¿™ä¸ªå•åˆ—å‡ºæ¥ æœ€ç›´è§‚çš„æ–¹æ³•æ˜¯éå†ä¸€ä¸ªconnectionåˆ—è¡¨ \u0026gt;\u0026gt;\u0026gt; from fabric import Connection \u0026gt;\u0026gt;\u0026gt; for host in (\u0026#39;web1\u0026#39;, \u0026#39;web2\u0026#39;, \u0026#39;mac1\u0026#39;): \u0026gt;\u0026gt;\u0026gt; result = Connection(host).run(\u0026#39;uname -s\u0026#39;) ... print(\u0026#34;{}: {}\u0026#34;.format(host, result.stdout.strip())) ... ... web1: Linux web2: Linux mac1: Darwin fabricæä¾›äº†ä¸€ä¸ªæ›´å¥½çš„è§£å†³åŠæ³•ï¼ŒæŠŠæ‰€æœ‰çš„å¯¹è±¡æ”¾åˆ°ä¸€ä¸ªGroupé‡Œé¢ã€‚ Groupå’ŒSerialGroup(Subclass of Group which executes in simple, serial fashion. New in version 2.0.) è¿”å›çš„ç»“æœçœ‹ï¼ŒConnectionè¿”å›å•ä¸ªçš„Resultå¯¹è±¡ï¼ŒGroupè¿”å›GroupResultå¯¹è±¡ï¼Œdict-like In [18]: results = Group(\u0026#39;peter@192.168.9.218\u0026#39;, \u0026#39;peter@192.168.9.208\u0026#39;).run(\u0026#39;uname -s\u0026#39;) Linux Linux In [19]: for conn, result in results.items(): ...: print(\u0026#34;{0.host}: {1.stdout}\u0026#34;.format(conn, result)) ...: 192.168.9.218: Linux 192.168.9.208: Linux Groupå¯¹è±¡æ¥æ‰§è¡Œçš„æ“ä½œä¼šå¯¹æ‰€æœ‰æœåŠ¡å™¨ç”Ÿæ•ˆï¼Œä½†æ˜¯è¿™é‡Œå®˜æ–¹æ•™ç¨‹çš„pool.putä¼šå¾—åˆ°ä¸€ä¸ªAttributeError: 'SerialGroup' object has no attribute 'put'é”™è¯¯ï¼Œå·²åœ¨githubæäº¤issue from fabric import SerialGroup as Group pool = Group(\u0026#39;web1\u0026#39;, \u0026#39;web2\u0026#39;, \u0026#39;web3\u0026#39;) pool.put(\u0026#39;myfiles.tgz\u0026#39;, \u0026#39;/opt/mydata\u0026#39;) pool.run(\u0026#39;tar -C /opt/mydata -xzvf /opt/mydata/myfiles.tgz\u0026#39;) fab cli tool å°è£…äº†Invokeçš„CLIåŠŸèƒ½ï¼Œèƒ½å¤Ÿå¾ˆå¿«çš„åœ¨å¤šä¸ªæœºå™¨ä¸Šè¿è¡Œtasksã€‚\nå°†ä¹‹å‰çš„ä»»åŠ¡ç¼–ç¨‹ä¸€ä¸ªfab taskæ¥è¿è¡Œï¼Œè¦å®šä¹‰ä¸€ä¸ªfabfile.py å®é™…éƒ¨ç½² è¿™é‡Œå‚è€ƒçš„ä¸€ç¯‡åšå®¢ï¼Œä½¿ç”¨çš„æ˜¯python2ç‰ˆæœ¬çš„fabricï¼Œä»…ä¾›å­¦ä¹ æ€è·¯ã€‚\næµç¨‹ è¿œç¨‹è¿æ¥æœåŠ¡å™¨ã€‚ è¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°çš„ä»£ç ã€‚ å¦‚æœé¡¹ç›®å¼•å…¥äº†æ–°çš„ä¾èµ–ï¼Œéœ€è¦æ‰§è¡Œ pip install -r requirement.txt å®‰è£…æœ€æ–°ä¾èµ–ã€‚ å¦‚æœä¿®æ”¹æˆ–æ–°å¢äº†é¡¹ç›®é™æ€æ–‡ä»¶ï¼Œéœ€è¦æ‰§è¡Œ python manage.py collectstatic æ”¶é›†é™æ€æ–‡ä»¶ã€‚ å¦‚æœæ•°æ®åº“å‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦æ‰§è¡Œ python manage.py migrate è¿ç§»æ•°æ®åº“ã€‚ é‡å¯ Nginx å’Œ Gunicorn ä½¿æ”¹åŠ¨ç”Ÿæ•ˆã€‚ fabfile.py ä½äºé¡¹ç›®(çœŸæ­£çš„ä»£ç é¡¹ç›®ï¼Œè€ŒéåŒ…å«å„ç§é…ç½®çš„éƒ¨ç½²é¡¹ç›®)çš„æ ¹ç›®å½•ï¼Œ\npython2 fabric macè·¯å¾„é—®é¢˜ pip installation /usr/local/opt/python/bin/python2.7: bad interpreter: No such file or directory I got same problem. If I run brew link --overwrite python2. There was still zsh: /usr/local/bin//fab: bad interpreter: /usr/local/opt/python/bin/python2.7: no such file or directory.\næ–¹æ¡ˆ1 å¦‚æœpythonæœ¬æ¥æŒ‡å‘äº†Cellerçš„python3.6ï¼Œé‚£ä¹ˆå…ˆç§»é™¤è¿™ä¸ªé“¾æ¥ ç„¶ååœ¨ç”¨è¿‡ln -s python2 pythonè½¯è¿æ¥ å¦‚æœæ²¡æœ‰python2å¯ä»¥ç”¨brew reinstall python2ï¼Œä¹‹åå°±èƒ½æŸ¥çœ‹åˆ° æ–¹æ¡ˆ2 cd /usr/local/opt/ mv python2 python Solved it! Now we can use python2 version fabric.\n","permalink":"https://26huitailang.github.io/posts/devops/fabric/","summary":"Fabricå­¦ä¹  [toc]\næ€»ç»“ fabric3 ç§»é™¤äº†å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½å’Œè£…é¥°å™¨ï¼Œå˜å¾—æ›´ç²¾ç®€äº†ï¼Œå¦å¤–fabè¿™ä¸ªcliå…¥å£æä¾›çš„å‚æ•°èƒ½åŠ›ä¹Ÿå˜å¼±äº†ï¼Œç›®å‰ä¸ªäººå®ç”¨çš„æ–¹å¼æ˜¯typer+fabric3+makefileï¼š\ntyper ä½œä¸ºå‚æ•°è§£æå…¥å£ makefile å›ºå®šä¸€äº›æ“ä½œé€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨å®ƒçš„å¹¶å‘æ“ä½œï¼Œè€Œä¸æ˜¯ThreadingGroup Link Welcome to Fabric! Welcome to Invokeâ€™s documentation! ä½¿ç”¨ Fabric è‡ªåŠ¨åŒ–éƒ¨ç½² What is Fabric pythonçš„ä¸€ä¸ªhigh levelçš„åº“ï¼Œé€šè¿‡sshæ‰§è¡Œshellå‘½ä»¤ã€‚\nåŸºäºä»¥ä¸‹ä¸¤ä¸ªåŒ…æ„å»ºçš„ï¼š\nInvokeï¼Œsubprocess command execution and command-line features Paramikoï¼ŒSSH protocol implementation ç§é’¥é…ç½® é…ç½®sshçš„authorized_keysï¼Œå°†æœ¬æœºçš„id_rsa.pubä¿¡æ¯å¤åˆ¶åˆ°è¿œç¨‹çš„authorized_keysæ–‡ä»¶ä¸­ ç®€è¦ç”¨æ³• pty(prompt by hand)ï¼Œå¦‚æœsudoæœ‰å¯†ç ï¼Œé‚£ä¹ˆç”¨ptyæ¥æ‰‹åŠ¨è¾“å…¥ \u0026gt;\u0026gt;\u0026gt; from fabric import Connection \u0026gt;\u0026gt;\u0026gt; c = Connection(\u0026#39;192.168.9.139\u0026#39;) \u0026gt;\u0026gt;\u0026gt; c.run(\u0026#39;sudo useradd mydbuser\u0026#39;, pty=True) [sudo] password: \u0026lt;Result cmd=\u0026#39;sudo useradd mydbuser\u0026#39; exited=0\u0026gt; \u0026gt;\u0026gt;\u0026gt; c.run(\u0026#39;id -u mydbuser\u0026#39;) åˆ©ç”¨Invokeçš„è‡ªåŠ¨å›åº”æ¥è¾“å…¥sudoå¯†ç ï¼Œæ³¨æ„patternçš„æ­£ç¡®åŒ¹é…ï¼Œä»¥åŠrepsoneseçš„ç»“å°¾ç¬¦å· \u0026gt;\u0026gt;\u0026gt; from invoke import Responder \u0026gt;\u0026gt;\u0026gt; from fabric import Connection \u0026gt;\u0026gt;\u0026gt; c = Connection(\u0026#39;host\u0026#39;) \u0026gt;\u0026gt;\u0026gt; sudopass = Responder( .","title":"Fabric"},{"content":"æŸ¥çœ‹ä¾èµ– å·¥å…· pipdeptree\næ”¯æŒæ­£å‘ã€åå‘æŸ¥çœ‹ä¾èµ– å¤šç§æ ¼å¼è¾“å‡ºï¼Œå®‰è£…äº†graphvizè¿˜å¯ä»¥è¾“å‡ºå›¾å½¢ [root@10-113-57-176 /] pip install pipdeptree [root@10-113-57-176 /] pipdeptree --help usage: pipdeptree [-h] [-v] [-f] [--python PYTHON] [-a] [-l] [-u] [-w [{silence,suppress,fail}]] [-r] [-p PACKAGES] [-e PACKAGES] [-j] [--json-tree] [--graph-output OUTPUT_FORMAT] Dependency tree of the installed python packages optional arguments: -h, --help show this help message and exit -v, --version show program\u0026#39;s version number and exit -f, --freeze Print names so as to write freeze files --python PYTHON Python to use to look for packages in it (default: where installed) -a, --all list all deps at top level -l, --local-only If in a virtualenv that has global access do not show globally installed packages -u, --user-only Only show installations in the user site dir -w [{silence,suppress,fail}], --warn [{silence,suppress,fail}] Warning control. \u0026#34;suppress\u0026#34; will show warnings but return 0 whether or not they are present. \u0026#34;silence\u0026#34; will not show warnings at all and always return 0. \u0026#34;fail\u0026#34; will show warnings and return 1 if any are present. The default is \u0026#34;suppress\u0026#34;. -r, --reverse Shows the dependency tree in the reverse fashion ie. the sub- dependencies are listed with the list of packages that need them under them. -p PACKAGES, --packages PACKAGES Comma separated list of select packages to show in the output. If set, --all will be ignored. -e PACKAGES, --exclude PACKAGES Comma separated list of select packages to exclude from the output. If set, --all will be ignored. -j, --json Display dependency tree as json. This will yield \u0026#34;raw\u0026#34; output that may be used by external tools. This option overrides all other options. --json-tree Display dependency tree as json which is nested the same way as the plain text output printed by default. This option overrides all other options (except --json). --graph-output OUTPUT_FORMAT Print a dependency graph in the specified output format. Available are all formats supported by GraphViz, e.g.: dot, jpeg, pdf, png, svg ","permalink":"https://26huitailang.github.io/posts/python/pip/dependency/","summary":"æŸ¥çœ‹ä¾èµ– å·¥å…· pipdeptree\næ”¯æŒæ­£å‘ã€åå‘æŸ¥çœ‹ä¾èµ– å¤šç§æ ¼å¼è¾“å‡ºï¼Œå®‰è£…äº†graphvizè¿˜å¯ä»¥è¾“å‡ºå›¾å½¢ [root@10-113-57-176 /] pip install pipdeptree [root@10-113-57-176 /] pipdeptree --help usage: pipdeptree [-h] [-v] [-f] [--python PYTHON] [-a] [-l] [-u] [-w [{silence,suppress,fail}]] [-r] [-p PACKAGES] [-e PACKAGES] [-j] [--json-tree] [--graph-output OUTPUT_FORMAT] Dependency tree of the installed python packages optional arguments: -h, --help show this help message and exit -v, --version show program\u0026#39;s version number and exit -f, --freeze Print names so as to write freeze files --python PYTHON Python to use to look for packages in it (default: where installed) -a, --all list all deps at top level -l, --local-only If in a virtualenv that has global access do not show globally installed packages -u, --user-only Only show installations in the user site dir -w [{silence,suppress,fail}], --warn [{silence,suppress,fail}] Warning control.","title":"pip dependency"},{"content":"å‚è€ƒ https://www.cnblogs.com/zihanxing/articles/6224263.html\néªŒè¯ zdump -v /usr/share/zoneinfo/America/Los_Angeles ï½œ grep 2022 ln -sf /usr/share/zoneinfo/America/Los_Angeles /etc/localtime service ntpd stop date -s \u0026#34;2022-03-13 01:59:40\u0026#34; for i in `seq 1 1000`;do date;python -c \u0026#39;import time;print(int(time.time()))\u0026#39;;python -c \u0026#39;import datetime;print(datetime.datetime.now())\u0026#39;;sleep 1;done ","permalink":"https://26huitailang.github.io/posts/linux/daylight/","summary":"å‚è€ƒ https://www.cnblogs.com/zihanxing/articles/6224263.html\néªŒè¯ zdump -v /usr/share/zoneinfo/America/Los_Angeles ï½œ grep 2022 ln -sf /usr/share/zoneinfo/America/Los_Angeles /etc/localtime service ntpd stop date -s \u0026#34;2022-03-13 01:59:40\u0026#34; for i in `seq 1 1000`;do date;python -c \u0026#39;import time;print(int(time.time()))\u0026#39;;python -c \u0026#39;import datetime;print(datetime.datetime.now())\u0026#39;;sleep 1;done ","title":"Daylight Saving Time"},{"content":"å·¥å…· hercules goï¼Œç»´æŠ¤è‰¯å¥½ï¼Œè¾ƒä¸ºå¤æ‚ï¼Œå¯ä»¥å°è¯•\nhttps://github.com/src-d/hercules\ngitinspector Python ä½†æ˜¯æœ€åä¸€æ¬¡ç»´æŠ¤æ˜¯Oct 19, 2020ï¼Œä¸èƒ½åœ¨py3ä¸‹è¿è¡Œï¼Œå¯ä»¥å°è¯•\nhttps://github.com/ejwa/gitinspector\ngit-stats åˆå¹¶ç¨‹åºæ˜¯äºŒè¿›åˆ¶ï¼Œè¾“å‡ºæ˜¯jsï¼Œä¸å¥½æ”¹é€ \nhttps://github.com/IonicaBizau/git-stats\ngit-quick-stats written by shell(ä¸å¤ªå¥½æ”¹é€ )ï¼ŒæŒç»­æœ‰ç»´æŠ¤ï¼Œå¯ä»¥å°è¯•\nhttps://github.com/arzzen/git-quick-stats#macos-homebrew\nbrew install git-quick-stats\nYou can use the Docker image provided:\nBuild: docker build -t arzzen/git-quick-stats . Run interactive menu: docker run --rm -it -v $(pwd):/git arzzen/git-quick-stats Docker pull command: docker pull arzzen/git-quick-stats docker repository docker run --rm -it -e _GIT_SINCE=\u0026#34;2017-01-20\u0026#34; -v $(pwd):/git arzzen/git-quick-stats -j ç»Ÿè®¡ ä»£ç é‡ git log \u0026ndash;format=\u0026rsquo;%aN\u0026rsquo; | sort -u | while read name; do echo -en \u0026ldquo;$name\\t\u0026rdquo;; git log \u0026ndash;author=\u0026quot;$name\u0026quot; \u0026ndash;pretty=tformat: \u0026ndash;since=2020-02-03 \u0026ndash;until=2020-03-27 \u0026ndash;numstat | awk \u0026lsquo;{ add += $1; subs += $2; loc += $1 - $2 } END { printf \u0026ldquo;added lines: %s, removed lines: %s, total lines: %s\\n\u0026rdquo;, add, subs, loc }\u0026rsquo; -; done\n","permalink":"https://26huitailang.github.io/posts/git/statistics/","summary":"å·¥å…· hercules goï¼Œç»´æŠ¤è‰¯å¥½ï¼Œè¾ƒä¸ºå¤æ‚ï¼Œå¯ä»¥å°è¯•\nhttps://github.com/src-d/hercules\ngitinspector Python ä½†æ˜¯æœ€åä¸€æ¬¡ç»´æŠ¤æ˜¯Oct 19, 2020ï¼Œä¸èƒ½åœ¨py3ä¸‹è¿è¡Œï¼Œå¯ä»¥å°è¯•\nhttps://github.com/ejwa/gitinspector\ngit-stats åˆå¹¶ç¨‹åºæ˜¯äºŒè¿›åˆ¶ï¼Œè¾“å‡ºæ˜¯jsï¼Œä¸å¥½æ”¹é€ \nhttps://github.com/IonicaBizau/git-stats\ngit-quick-stats written by shell(ä¸å¤ªå¥½æ”¹é€ )ï¼ŒæŒç»­æœ‰ç»´æŠ¤ï¼Œå¯ä»¥å°è¯•\nhttps://github.com/arzzen/git-quick-stats#macos-homebrew\nbrew install git-quick-stats\nYou can use the Docker image provided:\nBuild: docker build -t arzzen/git-quick-stats . Run interactive menu: docker run --rm -it -v $(pwd):/git arzzen/git-quick-stats Docker pull command: docker pull arzzen/git-quick-stats docker repository docker run --rm -it -e _GIT_SINCE=\u0026#34;2017-01-20\u0026#34; -v $(pwd):/git arzzen/git-quick-stats -j ç»Ÿè®¡ ä»£ç é‡ git log \u0026ndash;format=\u0026rsquo;%aN\u0026rsquo; | sort -u | while read name; do echo -en \u0026ldquo;$name\\t\u0026rdquo;; git log \u0026ndash;author=\u0026quot;$name\u0026quot; \u0026ndash;pretty=tformat: \u0026ndash;since=2020-02-03 \u0026ndash;until=2020-03-27 \u0026ndash;numstat | awk \u0026lsquo;{ add += $1; subs += $2; loc += $1 - $2 } END { printf \u0026ldquo;added lines: %s, removed lines: %s, total lines: %s\\n\u0026rdquo;, add, subs, loc }\u0026rsquo; -; done","title":"Git Statistics"},{"content":"man page https://man7.org/linux/man-pages/man3/syslog.3.html\ninstall yum install rsyslog systemctl start rsyslog systemctl enable rsyslog systemctl status rsyslog config server\n# for udp #module(load=â€imudpâ€) #input(type=â€imudpâ€ port=â€514\u0026#34;) # for tcp #module(load=â€imtcpâ€) #input(type=â€imtcpâ€ port=â€514\u0026#34;) facility: the type of process sending logs, can be kernel, cron, daemon, etc. priority: the security level or type of log, emerg (0), alert (1), crit (2), err-(3), warn (4), notice (5), info (6), debug (7). destination: location to save log messages, local file host (/var/log directory), or remote syslog server identified by @ IP:port. e.g. server with udp opened, for local7.* facility msg:\n... module(load=â€imudpâ€) input(type=â€imudpâ€ port=â€514\u0026#34;) ... local7.* /var/log/local7 client\n... local7.* @SERVER_IP:514 test\nlogger content ","permalink":"https://26huitailang.github.io/posts/linux/rsyslog/","summary":"man page https://man7.org/linux/man-pages/man3/syslog.3.html\ninstall yum install rsyslog systemctl start rsyslog systemctl enable rsyslog systemctl status rsyslog config server\n# for udp #module(load=â€imudpâ€) #input(type=â€imudpâ€ port=â€514\u0026#34;) # for tcp #module(load=â€imtcpâ€) #input(type=â€imtcpâ€ port=â€514\u0026#34;) facility: the type of process sending logs, can be kernel, cron, daemon, etc. priority: the security level or type of log, emerg (0), alert (1), crit (2), err-(3), warn (4), notice (5), info (6), debug (7). destination: location to save log messages, local file host (/var/log directory), or remote syslog server identified by @ IP:port.","title":"rsyslog"},{"content":"msgfmt -c zh_HK.po -o zh_HK.mo ","permalink":"https://26huitailang.github.io/posts/i18n/i18n/","summary":"msgfmt -c zh_HK.po -o zh_HK.mo ","title":"i18n"},{"content":"brew install tesseract pngpaste brew install tesseract-lang # è¯­è¨€æ”¯æŒ ctrl + shift + command + 4 æˆªå›¾\npngpaste - | tesseract -l chi_sim stdin stdout åŠ å…¥zsh alias,.zshrc\nalias ocr=\u0026#39;pngpaste - | tesseract -l chi_sim stdin stdout\u0026#39; ","permalink":"https://26huitailang.github.io/posts/tools/ocr/","summary":"brew install tesseract pngpaste brew install tesseract-lang # è¯­è¨€æ”¯æŒ ctrl + shift + command + 4 æˆªå›¾\npngpaste - | tesseract -l chi_sim stdin stdout åŠ å…¥zsh alias,.zshrc\nalias ocr=\u0026#39;pngpaste - | tesseract -l chi_sim stdin stdout\u0026#39; ","title":"OCR"},{"content":"socks5 # ç›‘å¬1080ä¸ºä»£ç†åœ°å€ ssh -f -N -D 0.0.0.0:1080 root@127.0.0.1 # test curl -v -k -x \u0026#34;socks5://USER:PASSWORD@HOSTIP:1080\u0026#34; https://baidu.com socat # forward è®¿é—®ç›®æ ‡æœåŠ¡ socat TCP4-LISTEN:\u0026lt;æœ¬åœ°ç«¯å£\u0026gt;,bind=\u0026lt;ç›‘å¬æœ¬æœºçš„åœ°å€\u0026gt;,reuseaddr,fork TCP:\u0026lt;ç›®æ ‡åœ°å€\u0026gt;:\u0026lt;ç›®æ ‡ç«¯å£\u0026gt; 3proxy ä¸‰æ–¹å®¹å™¨ï¼š 3128 http, 1080 socks5\n$ docker run --rm -d \\ -p \u0026#34;3128:3128/tcp\u0026#34; \\ -p \u0026#34;1080:1080/tcp\u0026#34; \\ tarampampam/3proxy:latest ","permalink":"https://26huitailang.github.io/posts/test/proxy-test/","summary":"socks5 # ç›‘å¬1080ä¸ºä»£ç†åœ°å€ ssh -f -N -D 0.0.0.0:1080 root@127.0.0.1 # test curl -v -k -x \u0026#34;socks5://USER:PASSWORD@HOSTIP:1080\u0026#34; https://baidu.com socat # forward è®¿é—®ç›®æ ‡æœåŠ¡ socat TCP4-LISTEN:\u0026lt;æœ¬åœ°ç«¯å£\u0026gt;,bind=\u0026lt;ç›‘å¬æœ¬æœºçš„åœ°å€\u0026gt;,reuseaddr,fork TCP:\u0026lt;ç›®æ ‡åœ°å€\u0026gt;:\u0026lt;ç›®æ ‡ç«¯å£\u0026gt; 3proxy ä¸‰æ–¹å®¹å™¨ï¼š 3128 http, 1080 socks5\n$ docker run --rm -d \\ -p \u0026#34;3128:3128/tcp\u0026#34; \\ -p \u0026#34;1080:1080/tcp\u0026#34; \\ tarampampam/3proxy:latest ","title":"Proxy Test"},{"content":"image docker pull mcr.microsoft.com/playwright/python:v1.20.0-focal\næœ¬åœ°ç¯å¢ƒ pip install playwright -i https://pypi.tuna.tsinghua.edu.cn/simple playwright install\n","permalink":"https://26huitailang.github.io/posts/test/playwright/","summary":"image docker pull mcr.microsoft.com/playwright/python:v1.20.0-focal\næœ¬åœ°ç¯å¢ƒ pip install playwright -i https://pypi.tuna.tsinghua.edu.cn/simple playwright install","title":"Playwright"},{"content":"è®¿é—®å®¿ä¸»æœºç½‘ç»œ host mode ä½¿ç”¨hostæ¨¡å¼ï¼š\ndocker run -d --network=host my-container:latest services: my-service: network_mode: host æ·»åŠ hosts ä½¿ç”¨--add-hosté€‰é¡¹æ·»åŠ æ˜ å°„åˆ°/etc/hostsæ–‡ä»¶ï¼Œæ·»åŠ host.docker.internalåˆ°hosts\ndocker run --rm -it --add-host host.docker.internal:host-gateway goexpect bash hosts in container\nroot@00e0febe04e2:/app# cat /etc/hosts 127.0.0.1 localhost ::1 localhost ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters 192.168.65.2 host.docker.internal 172.17.0.2 00e0febe04e2 è®¿é—®å®¿ä¸»æœºç½‘ç»œ\nssh root@host.docker.internal -p 2222 ","permalink":"https://26huitailang.github.io/posts/docker/docker-network/","summary":"è®¿é—®å®¿ä¸»æœºç½‘ç»œ host mode ä½¿ç”¨hostæ¨¡å¼ï¼š\ndocker run -d --network=host my-container:latest services: my-service: network_mode: host æ·»åŠ hosts ä½¿ç”¨--add-hosté€‰é¡¹æ·»åŠ æ˜ å°„åˆ°/etc/hostsæ–‡ä»¶ï¼Œæ·»åŠ host.docker.internalåˆ°hosts\ndocker run --rm -it --add-host host.docker.internal:host-gateway goexpect bash hosts in container\nroot@00e0febe04e2:/app# cat /etc/hosts 127.0.0.1 localhost ::1 localhost ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters 192.168.65.2 host.docker.internal 172.17.0.2 00e0febe04e2 è®¿é—®å®¿ä¸»æœºç½‘ç»œ\nssh root@host.docker.internal -p 2222 ","title":"Docker Network"},{"content":" äº†è§£ vim text objectæ¦‚å¿µ installation brew install neovim brew install font-hack-nerd-font # æ£€ç´¢ brew install ripgrep fzf # lsp format brew install efm-langserver lazy-nvim tokyonight lualine barbecue bufferline indent_blankline gitsigns.nvim alpha-nvim nvim-telescope https://github.com/nvim-treesitter/nvim-treesitter https://github.com/nvim-treesitter/nvim-treesitter-textobjects https://github.com/neovim/nvim-lspconfig https://github.com/williamboman/mason.nvim https://github.com/hrsh7th/nvim-cmp lsp-format å‚è€ƒ lazyvim kickstart nvim æ•´ç†ä¸­ my lazyvim config\nplugin use https://github.com/junegunn/vim-plug, install this firstï¼š\nsh -c \u0026#39;curl -fLo \u0026#34;${XDG_DATA_HOME:-$HOME/.local/share}\u0026#34;/nvim/site/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim\u0026#39; mkdir ~/.config/nvim/ nvim ~/.config/nvim/init.vim cat \u0026lt;\u0026lt; EOF \u0026gt; ~/.config/nvim/init.vim call plug#begin(\u0026#39;~/.vim/plugged\u0026#39;) call plug#end() EOF write Plug 'fatih/vim-go' between call run :PlugInstall vim config is .vimrc language support use coc.nvim\nPlug \u0026#39;neoclide/coc.nvim\u0026#39;, {\u0026#39;branch\u0026#39;: \u0026#39;release\u0026#39;} :PlugInstall coc-settings.json\n{ \u0026#34;languageserver\u0026#34;: { \u0026#34;go\u0026#34;: { \u0026#34;command\u0026#34;: \u0026#34;gopls\u0026#34;, \u0026#34;rootPatterns\u0026#34;: [\u0026#34;go.mod\u0026#34;], \u0026#34;trace.server\u0026#34;: \u0026#34;verbose\u0026#34;, \u0026#34;filetypes\u0026#34;: [\u0026#34;go\u0026#34;] } } } problem:\nbuild/index.js not found, please install dependencies and compile coc.nvim by: yarn install\ncd ~/.vim/plugged/coc.nvim yarn install yarn build ctags plugin: \u0026lsquo;preservim/tagbar\u0026rsquo; need ctags installation\nbrew install universal-ctags config init.vim\nnmap \u0026lt;F8\u0026gt; :TagbarToggle\u0026lt;CR\u0026gt; python ä½¿ç”¨ python language serverï¼Œneovimå†…ç½®æ”¯æŒ\npip install \u0026#39;python-language-server[all]\u0026#39; config coc-settings.jsonï¼Œè®¾ç½®ä¸ºå…¨å±€å®‰è£…python-language-serverçš„pythonè·¯å¾„\nè¾“å…¥æ³•åˆ‡æ¢é—®é¢˜ å‚è€ƒ https://github.com/laishulu/macism/issues/4\nim-select brew tap daipeihust/tap brew install im-select è®¾ç½®ç¦»å¼€insertæ¨¡å¼çš„é…ç½® autocmd InsertLeave * :silent !/usr/local/bin/im-select com.apple.keylayout.ABC -- imselect.lua --- éƒ½æ˜¯ç²‰è‰²çš„æ‰‹åŠ¨å‘é€åœ°æ–¹å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥åˆ‡æ¢è¾“å…¥æ³• local M = {} function M.setInputMethod() vim.fn.system(\u0026#39;/usr/local/bin/im-select com.apple.keylayout.ABC\u0026#39;) end return M --essentials.lua -- åœ¨é€€å‡ºæ’å…¥æ¨¡å¼æ—¶è§¦å‘ setInputMethod å‡½æ•° local imselect = require(\u0026#39;imselect\u0026#39;) vim.cmd([[ augroup SetInputMethod autocmd! autocmd InsertLeave * lua require(\u0026#39;imselect\u0026#39;).setInputMethod() augroup END ]]) ","permalink":"https://26huitailang.github.io/posts/tools/neovim/","summary":"äº†è§£ vim text objectæ¦‚å¿µ installation brew install neovim brew install font-hack-nerd-font # æ£€ç´¢ brew install ripgrep fzf # lsp format brew install efm-langserver lazy-nvim tokyonight lualine barbecue bufferline indent_blankline gitsigns.nvim alpha-nvim nvim-telescope https://github.com/nvim-treesitter/nvim-treesitter https://github.com/nvim-treesitter/nvim-treesitter-textobjects https://github.com/neovim/nvim-lspconfig https://github.com/williamboman/mason.nvim https://github.com/hrsh7th/nvim-cmp lsp-format å‚è€ƒ lazyvim kickstart nvim æ•´ç†ä¸­ my lazyvim config\nplugin use https://github.com/junegunn/vim-plug, install this firstï¼š\nsh -c \u0026#39;curl -fLo \u0026#34;${XDG_DATA_HOME:-$HOME/.local/share}\u0026#34;/nvim/site/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim\u0026#39; mkdir ~/.config/nvim/ nvim ~/.config/nvim/init.vim cat \u0026lt;\u0026lt; EOF \u0026gt; ~/.config/nvim/init.vim call plug#begin(\u0026#39;~/.","title":"Neovim"},{"content":"å¤åˆ¶å†…å®¹åˆ°å‰ªè´´æ¿ +å¯ä»¥æŠŠå†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿å¯„å­˜å™¨ï¼Œå°±èƒ½åœ¨å…¶ä»–åº”ç”¨ä¸­è´´ã€‚ :reg [register_name] æŸ¥çœ‹æŒ‡å®šå¯„å­˜å™¨çš„å†…å®¹ \u0026#34;+yy // å¤åˆ¶å½“å‰è¡Œåˆ°å‰ªåˆ‡æ¿ \u0026#34;+p // å°†å‰ªåˆ‡æ¿å†…å®¹ç²˜è´´åˆ°å…‰æ ‡åé¢ \u0026#34;ayy // å¤åˆ¶å½“å‰è¡Œåˆ°å¯„å­˜å™¨ a \u0026#34;ap // å°†å¯„å­˜å™¨ a ä¸­çš„å†…å®¹ç²˜è´´åˆ°å…‰æ ‡åé¢ Vim æœ‰ 12 ä¸ªç²˜è´´æ¿ä¾æ¬¡ç¼–å·ä¸ºï¼š0ã€1ã€2ã€\u0026hellip;ã€9ã€aã€\u0026quot;ã€+ï¼Œå…¶ä¸­ + å·ä¸ºç³»ç»Ÿç²˜è´´æ¿ï¼Œâ€ ä¸ºä¸´æ—¶ç²˜è´´æ¿ã€‚ç³»ç»Ÿå‰ªåˆ‡æ¿ä¸­çš„å†…å®¹å¯åœ¨å…¶ä»–ç¨‹åºä¸­ä½¿ç”¨ã€‚ä¸Šé¢çš„å¤åˆ¶æŒ‡ä»¤éƒ½å¯ä»¥é…åˆå‰ªåˆ‡æ¿è¿›è¡Œæ“ä½œã€‚\u0026ldquo;nyw å¤åˆ¶å½“å‰å•è¯åˆ° n å·å‰ªåˆ‡æ¿ï¼ˆåŒå¼•å·å¼€å§‹ï¼‰ \u0026ldquo;np ç²˜è´´ n å·å‰ªåˆ‡æ¿å†…å®¹åˆ°å½“å‰ä½ç½®å \u0026ldquo;+Y å¤åˆ¶å½“å‰è¡Œåˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿\u0026rdquo;+nY å¤åˆ¶å½“å‰è¡Œå¾€ä¸‹ n è¡Œåˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿\u0026rdquo;+p ç²˜è´´ç³»ç»Ÿå‰ªåˆ‡æ¿å†…å®¹åˆ°å½“å‰ä½ç½®å\næ ‡è®°ï¼Œmark ä¸€ä¸‹ mcæ ‡è®°ä¸€ä¸ªä½ç½®cï¼Œå½“åœ¨æœ¬é¡µå…¶ä»–åœ°æ–¹å®Œæˆä»£ç ä¹‹åï¼Œæœ‰æ—¶å› ä¸ºä¸æ˜¯ç”¨çš„ vim çš„Gæˆ–gä½ç§»æ“ä½œï¼Œæ‰€ä»¥ä¸¤ä¸ªç‚¹å·ä¸ä¸€å®šèƒ½å›æ¥ï¼Œä½†æ˜¯å¦‚æœåœ¨ç¦»å¼€å‰å°± mark äº†å®ƒï¼Œ`c ä¸€ä¸‹å°±èƒ½ä¼šåˆ° c æ ‡è®°çš„åœ°æ–¹ï¼Œè¿™é‡Œç”¨å…¶ä»–å­—æ¯ä¹Ÿè¡Œï¼Œåªè¦è‡ªå·±èƒ½è®°ä½ï¼Œæˆ‘ä»åˆ«çš„åœ°æ–¹å­¦çš„æ˜¯ e - endï¼Œc - currentï¼Œs - startï¼Œæ¯”å¦‚ä»£ç å¼€å¤´çš„ import å†…å®¹æˆ–è€…å¸¸é‡ä¸å¯¹è°ƒæ•´ï¼Œåˆ™æ ‡è®°ä¸€ä¸ª sï¼Œå½“å‰çš„ä»£ç å·¥ä½œåœ°æ–¹æ ‡è®°ä¸º cï¼Œè¿™æ ·å¯ä»¥åœ¨å¼€å¤´å’Œå½“å‰ä¸æ–­è·³è½¬ã€‚\nreplace Search and replace :%s/foo/bar/g, Find each occurrence of \u0026lsquo;foo\u0026rsquo; (in all lines), and replace it with \u0026lsquo;bar\u0026rsquo;. æ’ä»¶ Youcompleteme æ–‡ç« \né€šè¿‡ vundle æ·»åŠ æ’ä»¶\ncall vundle#begin() . . . Plugin \u0026lsquo;Valloric/YouCompleteMe â€™ . . . call vundle#end()\nvim é‡Œé¢é€šè¿‡:PluginInstallå®‰è£…\nå¦‚æœä¸æ˜¯è‡ªå·±æƒ³è¦çš„ä¾èµ–ï¼Œå¯ä»¥è‡ªå·±ç¼–è¯‘ï¼Œæœ€è¿‘åœ¨çœ‹ cï¼Œæ‰€ä»¥å°±è¯•ç€é…ç½®äº†ä¸€ä¸‹ï¼š\ncd ~/.vim/bundle/YouCompleteMe/ ./install.py --clang-completer --go-completerï¼ŒåŒ…å« c family è¿™é‡Œå¯èƒ½ä¼šæŠ¥ python è·¯å¾„ä¸å¯¹ï¼Œæ³¨æ„.zshrc æˆ–.bashrc çš„è·¯å¾„é…ç½®ï¼Œä¼šå½±å“ï¼Œæœ€å¥½ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ï¼Œæ˜¯å«æœ‰ lib åŠ¨æ€æ–‡ä»¶çš„ .vimrc é…ç½® let g:ycm_server_python_interpreter=\u0026lsquo;python\u0026rsquo; # ä¸æŒ‡å®šç»å¯¹è·¯å¾„ï¼Œç”¨äº† virtualenv æ’ä»¶ï¼Œå¯ä»¥è‡ªå·±è¯†åˆ«å½“å‰çš„ venv python(Plugin \u0026lsquo;plytophogy/vim-virtualenv\u0026rsquo;) let g:ycm_global_ycm_extra_conf=\u0026rsquo;~/.vim/.ycm_extra_conf.py\u0026rsquo;ï¼Œycm çš„é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼Œcp ~/.vim/bundle/YouCompleteMe/third_party/ycmd/examples/.ycm_extra_conf.py ~/.vim/ mac ä¸‹çš„ vimé…ç½® VIM é…ç½® è¯´æ˜ vim ç¥å™¨ä¸å¿…å¤šè¯´ï¼Œå…³äºå®ƒçš„è®¨è®ºä»¥åŠæœ€å¥½ç¼–è¾‘å™¨çš„äº‰è®ºä»æœªåœæ¯. äº‰è®®çš„ä¸œè¥¿å°±ä¸å¤šè¯´äº†ï¼Œä¸»è¦æ˜¯è‡ªå·±ä½¿ç”¨vimçš„ä¸€äº›ä¸ªè®¾ç½®å’Œé…ç½®ï¼ŒåŸºæœ¬åŸåˆ™æ˜¯å°½é‡å°‘ç”¨æ’ä»¶å®‰è£…ï¼Œå®‰è£…æ’ä»¶å…·æœ‰ç®€å•å¤åˆ¶æ€§ï¼Œonlineç‰¹æ€§ã€‚ï¼ˆps:ä»¥åå†™ä¸ªä¸€é”®å®‰è£…è„šæœ¬ï¼ŒåŸè°…æˆ‘æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ‡’çš„coderï¼‰ ä¸Šé¢è¯´äº†é‚£ä¹ˆå¤šæ˜¯ä¸æ˜¯å››ä¸ªå­—æ¯å°±å¯ä»¥äº† \u0026ndash;\u0026gt; kiss\nåŸºç¡€é…ç½® åŸºç¡€å¹³å°ï¼šMacBook Air ï¼Œå‡ºå»è£…é€¼çš„æ—¶å€™ç”¨ï¼Œç”µæ± ç‰›é€¼ï¼Œä¸æ’ç”µcodingä¹Ÿæœ‰å®‰å…¨æ„Ÿï¼ŒåŸç”Ÿshellæ”¯æŒï¼Œå…¨å±terminal ï¼Œå†å¼€ä¸ªmarkdownï¼Œé€¼å“¥å’±é€¼å“¥ã€‚ mac è‡ªå¸¦çš„æ˜¯viï¼Œéœ€è¦å®‰è£…vimï¼Œå¯¹Gvimå’ŒMACviméƒ½æ— çˆ±,homebrew å®‰è£…so ez:brew install vim é…ç½®æ–‡ä»¶åœ¨ç”¨æˆ·ç›®å½•ä¸‹~/.vimrc ,å¦‚æœæ²¡æœ‰ï¼Œå°±è‡ªå·±åˆ›å»ºä¸€ä¸ªã€‚\n\u0026#34; æ˜¾ç¤ºè¡Œå· set number \u0026#34; æ˜¾ç¤ºæ ‡å°º set ruler \u0026#34; å†å²çºªå½• set history=1000 \u0026#34; è¾“å…¥çš„å‘½ä»¤æ˜¾ç¤ºå‡ºæ¥ï¼Œçœ‹çš„æ¸…æ¥šäº› set showcmd \u0026#34; çŠ¶æ€è¡Œæ˜¾ç¤ºçš„å†…å®¹ set statusline=%F%m%r%h%w\\ [FORMAT=%{\u0026amp;ff}]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %{strftime(\\\u0026#34;%d/%m/%y\\ -\\ %H:%M\\\u0026#34;)} \u0026#34; å¯åŠ¨æ˜¾ç¤ºçŠ¶æ€è¡Œ1ï¼Œæ€»æ˜¯æ˜¾ç¤ºçŠ¶æ€è¡Œ2 set laststatus=2 \u0026#34; è¯­æ³•é«˜äº®æ˜¾ç¤º syntax on set fileencodings=utf-8,gb2312,gbk,cp936,latin-1 set fileencoding=utf-8 set termencoding=utf-8 set fileformat=unix set encoding=utf-8 \u0026#34; é…è‰²æ–¹æ¡ˆ colorscheme desert \u0026#34; æŒ‡å®šé…è‰²æ–¹æ¡ˆæ˜¯256è‰² set t_Co=256 set wildmenu \u0026#34; å»æ‰æœ‰å…³viä¸€è‡´æ€§æ¨¡å¼ï¼Œé¿å…ä»¥å‰ç‰ˆæœ¬çš„ä¸€äº›bugå’Œå±€é™ï¼Œè§£å†³backspaceä¸èƒ½ä½¿ç”¨çš„é—®é¢˜ set nocompatible set backspace=indent,eol,start set backspace=2 \u0026#34; å¯ç”¨è‡ªåŠ¨å¯¹é½åŠŸèƒ½ï¼ŒæŠŠä¸Šä¸€è¡Œçš„å¯¹é½æ ¼å¼åº”ç”¨åˆ°ä¸‹ä¸€è¡Œ set autoindent \u0026#34; ä¾æ®ä¸Šé¢çš„æ ¼å¼ï¼Œæ™ºèƒ½çš„é€‰æ‹©å¯¹é½æ–¹å¼ï¼Œå¯¹äºç±»ä¼¼Cè¯­è¨€ç¼–å†™å¾ˆæœ‰ç”¨å¤„ set smartindent \u0026#34; vimç¦ç”¨è‡ªåŠ¨å¤‡ä»½ set nobackup set nowritebackup set noswapfile \u0026#34; ç”¨ç©ºæ ¼ä»£æ›¿tab set expandtab \u0026#34; è®¾ç½®æ˜¾ç¤ºåˆ¶è¡¨ç¬¦çš„ç©ºæ ¼å­—ç¬¦ä¸ªæ•°,æ”¹è¿›tabç¼©è¿›å€¼ï¼Œé»˜è®¤ä¸º8ï¼Œç°æ”¹ä¸º4 set tabstop=4 \u0026#34; ç»Ÿä¸€ç¼©è¿›ä¸º4ï¼Œæ–¹ä¾¿åœ¨å¼€å¯äº†etåä½¿ç”¨é€€æ ¼(backspace)é”®ï¼Œæ¯æ¬¡é€€æ ¼å°†åˆ é™¤Xä¸ªç©ºæ ¼ set softtabstop=4 \u0026#34; è®¾å®šè‡ªåŠ¨ç¼©è¿›ä¸º4ä¸ªå­—ç¬¦ï¼Œç¨‹åºä¸­è‡ªåŠ¨ç¼©è¿›æ‰€ä½¿ç”¨çš„ç©ºç™½é•¿åº¦ set shiftwidth=4 \u0026#34; è®¾ç½®å¸®åŠ©æ–‡ä»¶ä¸ºä¸­æ–‡(éœ€è¦å®‰è£…vimcdocæ–‡æ¡£) set helplang=cn \u0026#34; æ˜¾ç¤ºåŒ¹é…çš„æ‹¬å· set showmatch \u0026#34; æ–‡ä»¶ç¼©è¿›åŠtabä¸ªæ•° au FileType html,python,vim,javascript setl shiftwidth=4 au FileType html,python,vim,javascript setl tabstop=4 au FileType java,php setl shiftwidth=4 au FileType java,php setl tabstop=4 \u0026#34; é«˜äº®æœç´¢çš„å­—ç¬¦ä¸² set hlsearch \u0026#34; æ£€æµ‹æ–‡ä»¶çš„ç±»å‹ filetype on filetype plugin on filetype indent on \u0026#34; Cé£æ ¼ç¼©è¿› set cindent set completeopt=longest,menu \u0026#34; åŠŸèƒ½è®¾ç½® \u0026#34; å»æ‰è¾“å…¥é”™è¯¯æç¤ºå£°éŸ³ set noeb \u0026#34; è‡ªåŠ¨ä¿å­˜ set autowrite \u0026#34; çªå‡ºæ˜¾ç¤ºå½“å‰è¡Œ set cursorline \u0026#34; çªå‡ºæ˜¾ç¤ºå½“å‰åˆ— set cursorcolumn \u0026#34;è®¾ç½®å…‰æ ‡æ ·å¼ä¸ºç«–çº¿vertical bar \u0026#34; Change cursor shape between insert and normal mode in iTerm2.app \u0026#34;if $TERM_PROGRAM =~ \u0026#34;iTerm\u0026#34; let \u0026amp;t_SI = \u0026#34;\\\u0026lt;Esc\u0026gt;]50;CursorShape=1\\x7\u0026#34; \u0026#34; Vertical bar in insert mode let \u0026amp;t_EI = \u0026#34;\\\u0026lt;Esc\u0026gt;]50;CursorShape=0\\x7\u0026#34; \u0026#34; Block in normal mode \u0026#34;endif \u0026#34; å…±äº«å‰ªè´´æ¿ set clipboard+=unnamed \u0026#34; æ–‡ä»¶è¢«æ”¹åŠ¨æ—¶è‡ªåŠ¨è½½å…¥ set autoread \u0026#34; é¡¶éƒ¨åº•éƒ¨ä¿æŒ3è¡Œè·ç¦» set scrolloff=3 æ’ä»¶å®‰è£…å’Œé…ç½® é¦–å…ˆå®‰è£…æ’ä»¶ç®¡å®¶ Vundle:\ngit clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim .vimrc ä¸­æ·»åŠ é…ç½®ä½¿ç®¡å®¶ä¸Šä»»ï¼š\nfiletype off set rtp+=~/.vim/bundle/Vundle.vim call vundle#begin() Plugin \u0026#39;VundleVim/Vundle.vim\u0026#39; Plugin \u0026#39;ä½ çš„æ’ä»¶\u0026#39; call vundle#end() filetype plugin indent on ä½¿ç”¨vundleå®‰è£…æ’ä»¶:\n\u0026#34; let Vundle manage Vundle, required Plugin \u0026#39;VundleVim/Vundle.vim\u0026#39; \u0026#34; Plugin \u0026#39;tpope/vim-surround\u0026#39; \u0026#34; Plugin \u0026#39;scrooloose/nerdtree\u0026#39; Plugin \u0026#39;Lokaltog/vim-powerline\u0026#39; Plugin \u0026#39;valloric/youcompleteme\u0026#39; Plugin \u0026#39;yggdroot/indentline\u0026#39; Plugin \u0026#39;jiangmiao/auto-pairs\u0026#39; æ’ä»¶ç›¸å…³é…ç½®ï¼š\n\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;plugin configuration\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34;\u0026#34; \u0026#34;NERDTree \u0026#34;F2å¼€å¯å’Œå…³é—­æ ‘\u0026#34; \u0026#34;map \u0026lt;F2\u0026gt; :NERDTreeToggle\u0026lt;CR\u0026gt; \u0026#34;let NERDTreeChDirMode=1 \u0026#34;\u0026#34;æ˜¾ç¤ºä¹¦ç­¾\u0026#34; \u0026#34;let NERDTreeShowBookmarks=1 \u0026#34;è®¾ç½®å¿½ç•¥æ–‡ä»¶ç±»å‹\u0026#34; \u0026#34;let NERDTreeIgnore=[\u0026#39;\\~$\u0026#39;, \u0026#39;\\.pyc$\u0026#39;, \u0026#39;\\.swp$\u0026#39;] \u0026#34;\u0026#34;çª—å£å¤§å°\u0026#34; \u0026#34;let NERDTreeWinSize=25 \u0026#34;indentLine \u0026#34;ç¼©è¿›æŒ‡ç¤ºçº¿\u0026#34; let g:indentLine_char=\u0026#39;|\u0026#39; let g:indentLine_enabled=1 OK ï¼Œeverything\u0026rsquo;s ready æ‰“å¼€vimå“ˆçš®çš„codingå§ã€‚\n","permalink":"https://26huitailang.github.io/posts/tools/vim/","summary":"å¤åˆ¶å†…å®¹åˆ°å‰ªè´´æ¿ +å¯ä»¥æŠŠå†…å®¹å¤åˆ¶åˆ°å‰ªè´´æ¿å¯„å­˜å™¨ï¼Œå°±èƒ½åœ¨å…¶ä»–åº”ç”¨ä¸­è´´ã€‚ :reg [register_name] æŸ¥çœ‹æŒ‡å®šå¯„å­˜å™¨çš„å†…å®¹ \u0026#34;+yy // å¤åˆ¶å½“å‰è¡Œåˆ°å‰ªåˆ‡æ¿ \u0026#34;+p // å°†å‰ªåˆ‡æ¿å†…å®¹ç²˜è´´åˆ°å…‰æ ‡åé¢ \u0026#34;ayy // å¤åˆ¶å½“å‰è¡Œåˆ°å¯„å­˜å™¨ a \u0026#34;ap // å°†å¯„å­˜å™¨ a ä¸­çš„å†…å®¹ç²˜è´´åˆ°å…‰æ ‡åé¢ Vim æœ‰ 12 ä¸ªç²˜è´´æ¿ä¾æ¬¡ç¼–å·ä¸ºï¼š0ã€1ã€2ã€\u0026hellip;ã€9ã€aã€\u0026quot;ã€+ï¼Œå…¶ä¸­ + å·ä¸ºç³»ç»Ÿç²˜è´´æ¿ï¼Œâ€ ä¸ºä¸´æ—¶ç²˜è´´æ¿ã€‚ç³»ç»Ÿå‰ªåˆ‡æ¿ä¸­çš„å†…å®¹å¯åœ¨å…¶ä»–ç¨‹åºä¸­ä½¿ç”¨ã€‚ä¸Šé¢çš„å¤åˆ¶æŒ‡ä»¤éƒ½å¯ä»¥é…åˆå‰ªåˆ‡æ¿è¿›è¡Œæ“ä½œã€‚\u0026ldquo;nyw å¤åˆ¶å½“å‰å•è¯åˆ° n å·å‰ªåˆ‡æ¿ï¼ˆåŒå¼•å·å¼€å§‹ï¼‰ \u0026ldquo;np ç²˜è´´ n å·å‰ªåˆ‡æ¿å†…å®¹åˆ°å½“å‰ä½ç½®å \u0026ldquo;+Y å¤åˆ¶å½“å‰è¡Œåˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿\u0026rdquo;+nY å¤åˆ¶å½“å‰è¡Œå¾€ä¸‹ n è¡Œåˆ°ç³»ç»Ÿå‰ªåˆ‡æ¿\u0026rdquo;+p ç²˜è´´ç³»ç»Ÿå‰ªåˆ‡æ¿å†…å®¹åˆ°å½“å‰ä½ç½®å\næ ‡è®°ï¼Œmark ä¸€ä¸‹ mcæ ‡è®°ä¸€ä¸ªä½ç½®cï¼Œå½“åœ¨æœ¬é¡µå…¶ä»–åœ°æ–¹å®Œæˆä»£ç ä¹‹åï¼Œæœ‰æ—¶å› ä¸ºä¸æ˜¯ç”¨çš„ vim çš„Gæˆ–gä½ç§»æ“ä½œï¼Œæ‰€ä»¥ä¸¤ä¸ªç‚¹å·ä¸ä¸€å®šèƒ½å›æ¥ï¼Œä½†æ˜¯å¦‚æœåœ¨ç¦»å¼€å‰å°± mark äº†å®ƒï¼Œ`c ä¸€ä¸‹å°±èƒ½ä¼šåˆ° c æ ‡è®°çš„åœ°æ–¹ï¼Œè¿™é‡Œç”¨å…¶ä»–å­—æ¯ä¹Ÿè¡Œï¼Œåªè¦è‡ªå·±èƒ½è®°ä½ï¼Œæˆ‘ä»åˆ«çš„åœ°æ–¹å­¦çš„æ˜¯ e - endï¼Œc - currentï¼Œs - startï¼Œæ¯”å¦‚ä»£ç å¼€å¤´çš„ import å†…å®¹æˆ–è€…å¸¸é‡ä¸å¯¹è°ƒæ•´ï¼Œåˆ™æ ‡è®°ä¸€ä¸ª sï¼Œå½“å‰çš„ä»£ç å·¥ä½œåœ°æ–¹æ ‡è®°ä¸º cï¼Œè¿™æ ·å¯ä»¥åœ¨å¼€å¤´å’Œå½“å‰ä¸æ–­è·³è½¬ã€‚\nreplace Search and replace :%s/foo/bar/g, Find each occurrence of \u0026lsquo;foo\u0026rsquo; (in all lines), and replace it with \u0026lsquo;bar\u0026rsquo;.","title":"Vim"},{"content":"å¼€å‘å®‰å…¨çš„ API æ‰€éœ€è¦æ ¸å¯¹çš„æ¸…å•\nhttps://github.com/shieldfy/API-Security-Checklist\nhttps://github.com/shieldfy/API-Security-Checklist/blob/master/README-zh.md\n","permalink":"https://26huitailang.github.io/posts/security/api-security-checklist/","summary":"å¼€å‘å®‰å…¨çš„ API æ‰€éœ€è¦æ ¸å¯¹çš„æ¸…å•\nhttps://github.com/shieldfy/API-Security-Checklist\nhttps://github.com/shieldfy/API-Security-Checklist/blob/master/README-zh.md","title":"api security checklist"},{"content":"docker cheatsheet docker\n# ä¸ä½¿ç”¨ç¼“å­˜é‡æ–°build docker build . --no-cache # tag docker build -t peterchen0802/mypandoc:latest . docker tag peterchen0802/mypandoc:latest mypandoc:latest # æŸ¥çœ‹å®¹å™¨æ—¥å¿— docker logs SERVICE_NAME [-f] # å¯¼å‡ºå®¹å™¨ # æ³¨ï¼šç”¨æˆ·æ—¢å¯ä»¥ä½¿ç”¨ docker load æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ docker import æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ã€‚è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ã€‚æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚ docker export CONTAINER \u0026gt; TARFILENAME docker export CONTAINER -o TARFILENAME # å¯¼å…¥å®¹å™¨ docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]] docker import mypandoc.tar peterchen0802/mypandoc:latest # æŒ‡å®šå¯¼å…¥çš„é•œåƒåç§° # -----æ¸…ç† start----- ## ç£ç›˜å®¹é‡æŸ¥çœ‹ docker system df ## æ¸…ç† docker rmi $(docker images --filter \u0026#34;dangling=true\u0026#34; -q) ## æ¸…ç†æ— æ ‡ç­¾çš„é•œåƒ docker image prune ## æ¸…ç†ç£ç›˜ï¼Œåˆ é™¤å…³é—­çš„å®¹å™¨ã€æ— ç”¨çš„æ•°æ®å·ã€ç½‘ç»œï¼Œä»¥åŠdanglingé•œåƒï¼ˆæ— tagçš„é•œåƒï¼‰ã€‚ docker system prune ## æ›´å½»åº•çš„åˆ é™¤ï¼Œå°†æ²¡æœ‰å®¹å™¨ä½¿ç”¨çš„é•œåƒåˆ é™¤ï¼š docker system prune -a # -----æ¸…ç† end----- docker-compose\n# æŒ‡å®šå¯åŠ¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ç”¨docker-compose.dev.yml åŒºåˆ«å¼€å‘å’Œç”Ÿäº§é…ç½® docker-compose -f YML up # å¼ºåˆ¶é‡æ–°build, --build docker-compose -f YML up --build # æ‰©å®¹ï¼Œå¦‚æœè¦ä¸´æ—¶å¢åŠ ï¼Œå¯ä»¥ä½¿ç”¨`--scale`å‚æ•°é…åˆ`up`æŒ‡ä»¤ï¼Œæ¥å—å¤šä¸ªå®¹å™¨ä¼ é€’ï¼š docker-compose up --scale web=2 celery-worker=3 zsh zshæ’ä»¶æ”¯æŒdockerå’Œdocker-compose\nDockfile ç”¨äºæ„å»ºimageçš„æ–‡ä»¶ã€‚\ndocker-compose.yml ç®¡ç†å’Œä½¿ç”¨dockeræœåŠ¡çš„å·¥å…·ï¼Œå¯ä»¥ç±»ä¼¼vagrantçš„é…ç½®ï¼Œå¯ä»¥å¾ˆå¿«çš„ç¼–æ’éœ€è¦çš„servicesä»¥åŠnetworkså¹¶å¯åŠ¨ã€‚\ndocker-compose -f YML-CONF-FILE upï¼Œå¯ä»¥æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œè¿™æ ·å¯ä»¥åŒºåˆ«æ­£å¼ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒçš„docker upå¯ä»¥æ˜¯åˆ«æ²¡æœ‰çš„æœåŠ¡å¹¶é‡æ–°buildï¼Œä¹Ÿå¯ä»¥ç”¨\u0026ndash;buildå¼ºåˆ¶ ","permalink":"https://26huitailang.github.io/posts/docker/cheatsheet/","summary":"docker cheatsheet docker\n# ä¸ä½¿ç”¨ç¼“å­˜é‡æ–°build docker build . --no-cache # tag docker build -t peterchen0802/mypandoc:latest . docker tag peterchen0802/mypandoc:latest mypandoc:latest # æŸ¥çœ‹å®¹å™¨æ—¥å¿— docker logs SERVICE_NAME [-f] # å¯¼å‡ºå®¹å™¨ # æ³¨ï¼šç”¨æˆ·æ—¢å¯ä»¥ä½¿ç”¨ docker load æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ docker import æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ã€‚è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ã€‚æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚ docker export CONTAINER \u0026gt; TARFILENAME docker export CONTAINER -o TARFILENAME # å¯¼å…¥å®¹å™¨ docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]] docker import mypandoc.tar peterchen0802/mypandoc:latest # æŒ‡å®šå¯¼å…¥çš„é•œåƒåç§° # -----æ¸…ç† start----- ## ç£ç›˜å®¹é‡æŸ¥çœ‹ docker system df ## æ¸…ç† docker rmi $(docker images --filter \u0026#34;dangling=true\u0026#34; -q) ## æ¸…ç†æ— æ ‡ç­¾çš„é•œåƒ docker image prune ## æ¸…ç†ç£ç›˜ï¼Œåˆ é™¤å…³é—­çš„å®¹å™¨ã€æ— ç”¨çš„æ•°æ®å·ã€ç½‘ç»œï¼Œä»¥åŠdanglingé•œåƒï¼ˆæ— tagçš„é•œåƒï¼‰ã€‚ docker system prune ## æ›´å½»åº•çš„åˆ é™¤ï¼Œå°†æ²¡æœ‰å®¹å™¨ä½¿ç”¨çš„é•œåƒåˆ é™¤ï¼š docker system prune -a # -----æ¸…ç† end----- docker-compose","title":"Docker Cheatsheet"},{"content":"tmux ç»ˆç«¯æœç”¨è½¯ä»¶ï¼Œsessionå¯ä»¥ä¿å­˜åœ¨tmux serverä¸­ï¼Œå°±ç®—itermç­‰ç»ˆç«¯å…³é—­ä¹Ÿå¯ä»¥æ¢å¤ï¼Œè¿œç¨‹è¿æ¥çš„æ—¶å€™é¿å…æ‰çº¿ï¼ˆç±»ä¼¼çš„åŠŸèƒ½çš„è½¯ä»¶è¿˜æœ‰ï¼Œscreenï¼‰ã€‚\nå‚è€ƒ ååˆ†é’Ÿå­¦ä¼š tmux Tmux - Linuxä»ä¸šè€…å¿…å¤‡åˆ©å™¨ * cheatsheet ä¼˜é›…åœ°ä½¿ç”¨å‘½ä»¤è¡Œï¼šTmux ç»ˆç«¯å¤ç”¨ Tmuxä½¿ç”¨æ‰‹å†Œ æœ¬æœºï¼Œcheatsheet-tmux å®‰è£… brew install tmux åŸºäºå‚è€ƒç¬¬äºŒç¯‡æ–‡ç« ï¼Œé…ç½®ï¼š\n$ cd $ rm -rf .tmux $ git clone https://github.com/gpakosz/.tmux.git $ ln -s -f .tmux/.tmux.conf $ cp .tmux/.tmux.conf.local . æ¦‚å¿µ sessionï¼Œä¸åŒçš„ä¼šè¯ windowï¼Œä¸åŒçš„çª—å£ï¼Œç‰©ç†åˆ’åˆ†ï¼Œä¸€ä¸ªsessionå¯ä»¥æœ‰å¤šä¸ªwindow paneï¼Œçª—æ ¼ï¼Œä¸€ä¸ªwindowå¯ä»¥ç”¨è¿‡ %/\u0026quot; åˆ’åˆ†ä¸ºå¤šä¸ªçª—æ ¼ tmuxæ“ä½œ tmux lsï¼ŒæŸ¥çœ‹æ‰“å¼€çš„session tmux aï¼Œæ¢å¤ tmux a -t SESSION,æ¢å¤æŒ‡å®šsession C-bæ“ä½œ å‰ç¼€å¿«æ·é”®ï¼Œ^b % å·¦å³å¹³åˆ†å‡ºä¸¤ä¸ªpane \u0026quot; ä¸Šä¸‹å¹³åˆ†å‡ºä¸¤ä¸ªpane x å…³é—­å½“å‰çª—æ ¼ { å½“å‰çª—æ ¼å‰ç§» } å½“å‰çª—æ ¼åç§» ; é€‰æ‹©ä¸Šæ¬¡ä½¿ç”¨çš„çª—æ ¼ o é€‰æ‹©ä¸‹ä¸€ä¸ªçª—æ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šä¸‹å·¦å³æ–¹å‘é”®æ¥é€‰æ‹© space åˆ‡æ¢çª—æ ¼å¸ƒå±€ï¼Œtmux å†…ç½®äº†äº”ç§çª—æ ¼å¸ƒå±€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ âŒ¥1 è‡³ âŒ¥5æ¥åˆ‡æ¢ z æœ€å¤§åŒ–å½“å‰çª—æ ¼ï¼Œå†æ¬¡æ‰§è¡Œå¯æ¢å¤åŸæ¥å¤§å° q æ˜¾ç¤ºæ‰€æœ‰çª—æ ¼çš„åºå·ï¼Œåœ¨åºå·å‡ºç°æœŸé—´æŒ‰ä¸‹å¯¹åº”çš„æ•°å­—ï¼Œå³å¯è·³è½¬è‡³å¯¹åº”çš„çª—æ ¼ resize pane C-b :resize-pane -D/U/R/L 20 ä¿®æ”¹é…ç½® ~/.tmux.conf.local ~/.tmux.conf source file\nC-b :source-file ~/.tmux.conf.local ä¿®æ”¹å¤åˆ¶æ¨¡å¼ä¸ºviæ¨¡å¼ï¼Œ.tmux.conf.local\nset-option -g mode-keys vi å¤åˆ¶ ä¿®æ”¹viæ¨¡å¼å\nC-b + [ è¿›å»å¤åˆ¶æ¨¡å¼ ç©ºæ ¼å¼€å§‹é€‰æ‹© Enter ç»“æŸ C-b + ] ç²˜è´´ æ’ä»¶ æ¢å¤ä¼šè¯ Tmux Resurrect å®‰è£…\nmkdir -p ~/.tmux/plugins \u0026amp;\u0026amp; cd ~/.tmux/plugins git clone https://github.com/tmux-plugins/tmux-resurrect.git ä¿®æ”¹ ~/.tmux.conf.local run-shell ~/.tmux/plugins/tmux-resurrect/resurrect.tmux prefix + r é‡è½½é…ç½® ä¿å­˜ï¼Œprefix + Ctrl + s\nä¿å­˜ä½ç½®ï¼Œ~/.tmux/resurrectï¼Œå¯ä»¥æ‰‹åŠ¨æ¸…ç†è¿™é‡Œçš„å†å²è®°å½• æ¢å¤ï¼Œprefix + Ctrl + r\nè‡ªåŠ¨æ¢å¤ Tmux Continuum å…ˆç”¨æ‰‹åŠ¨ï¼Œåç»­è¯•è¯•è¿™ä¸ªè‡ªåŠ¨\n","permalink":"https://26huitailang.github.io/posts/devenv/tmux/","summary":"tmux ç»ˆç«¯æœç”¨è½¯ä»¶ï¼Œsessionå¯ä»¥ä¿å­˜åœ¨tmux serverä¸­ï¼Œå°±ç®—itermç­‰ç»ˆç«¯å…³é—­ä¹Ÿå¯ä»¥æ¢å¤ï¼Œè¿œç¨‹è¿æ¥çš„æ—¶å€™é¿å…æ‰çº¿ï¼ˆç±»ä¼¼çš„åŠŸèƒ½çš„è½¯ä»¶è¿˜æœ‰ï¼Œscreenï¼‰ã€‚\nå‚è€ƒ ååˆ†é’Ÿå­¦ä¼š tmux Tmux - Linuxä»ä¸šè€…å¿…å¤‡åˆ©å™¨ * cheatsheet ä¼˜é›…åœ°ä½¿ç”¨å‘½ä»¤è¡Œï¼šTmux ç»ˆç«¯å¤ç”¨ Tmuxä½¿ç”¨æ‰‹å†Œ æœ¬æœºï¼Œcheatsheet-tmux å®‰è£… brew install tmux åŸºäºå‚è€ƒç¬¬äºŒç¯‡æ–‡ç« ï¼Œé…ç½®ï¼š\n$ cd $ rm -rf .tmux $ git clone https://github.com/gpakosz/.tmux.git $ ln -s -f .tmux/.tmux.conf $ cp .tmux/.tmux.conf.local . æ¦‚å¿µ sessionï¼Œä¸åŒçš„ä¼šè¯ windowï¼Œä¸åŒçš„çª—å£ï¼Œç‰©ç†åˆ’åˆ†ï¼Œä¸€ä¸ªsessionå¯ä»¥æœ‰å¤šä¸ªwindow paneï¼Œçª—æ ¼ï¼Œä¸€ä¸ªwindowå¯ä»¥ç”¨è¿‡ %/\u0026quot; åˆ’åˆ†ä¸ºå¤šä¸ªçª—æ ¼ tmuxæ“ä½œ tmux lsï¼ŒæŸ¥çœ‹æ‰“å¼€çš„session tmux aï¼Œæ¢å¤ tmux a -t SESSION,æ¢å¤æŒ‡å®šsession C-bæ“ä½œ å‰ç¼€å¿«æ·é”®ï¼Œ^b % å·¦å³å¹³åˆ†å‡ºä¸¤ä¸ªpane \u0026quot; ä¸Šä¸‹å¹³åˆ†å‡ºä¸¤ä¸ªpane x å…³é—­å½“å‰çª—æ ¼ { å½“å‰çª—æ ¼å‰ç§» } å½“å‰çª—æ ¼åç§» ; é€‰æ‹©ä¸Šæ¬¡ä½¿ç”¨çš„çª—æ ¼ o é€‰æ‹©ä¸‹ä¸€ä¸ªçª—æ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šä¸‹å·¦å³æ–¹å‘é”®æ¥é€‰æ‹© space åˆ‡æ¢çª—æ ¼å¸ƒå±€ï¼Œtmux å†…ç½®äº†äº”ç§çª—æ ¼å¸ƒå±€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ âŒ¥1 è‡³ âŒ¥5æ¥åˆ‡æ¢ z æœ€å¤§åŒ–å½“å‰çª—æ ¼ï¼Œå†æ¬¡æ‰§è¡Œå¯æ¢å¤åŸæ¥å¤§å° q æ˜¾ç¤ºæ‰€æœ‰çª—æ ¼çš„åºå·ï¼Œåœ¨åºå·å‡ºç°æœŸé—´æŒ‰ä¸‹å¯¹åº”çš„æ•°å­—ï¼Œå³å¯è·³è½¬è‡³å¯¹åº”çš„çª—æ ¼ resize pane C-b :resize-pane -D/U/R/L 20 ä¿®æ”¹é…ç½® ~/.","title":"tmux"},{"content":"nginx [toc]\nå¸¸ç”¨å‘½ä»¤ nginx -s stop nginx -s reload ç®€ä»‹ åå‘ä»£ç† ä¸€å¥è¯ï¼š\nä»€ä¹ˆæ˜¯æ­£å‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯å®¢æˆ·ç«¯ ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯æ˜¯æ— æ„ŸçŸ¥çš„ nginxåå‘ä»£ç†é…ç½®\næ­£å¸¸æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; server ä»£ç†æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; clinet proxy â€“(send request)â€”\u0026gt; server åå‘ä»£ç†ï¼š client -(send request)-\u0026gt; server proxy -(send request)-\u0026gt; other server å¯ä»¥çœ‹åˆ°åå‘ä»£ç†å¹¶ä¸æ˜¯çœŸçš„åè¿‡æ¥ï¼Œè€Œæ˜¯ä»£ç†äººçš„èº«ä»½ç”±å®¢æˆ·ç«¯è½¬å‘äº†æœåŠ¡ç«¯ï¼Œä¹Ÿå› ä¸ºä»£ç†æ˜¯åœ¨æœåŠ¡ç«¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ˜¯å¯¹æ­¤æ— æ„ŸçŸ¥çš„ã€‚\nè´Ÿè½½å‡è¡¡ å°†åŸå…ˆé›†ä¸­è¯·æ±‚åˆ°å•ä¸ªæœåŠ¡å™¨çš„è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¯æŒæœåŠ¡æ¨ªå‘æ‰©å±•ã€‚\nåŠ¨é™åˆ†ç¦» é…ç½® å…¨å±€ é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventsä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦æ˜¯è®¾ç½®ä¸€äº›å½±å“nginxè¿è¡Œçš„é…ç½®æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼š\nç”¨æˆ·ï¼ˆç»„ï¼‰ worker processæ•°é‡ è¿›ç¨‹pidå­˜æ”¾è·¯å¾„ æ—¥å¿—å­˜æ”¾è·¯å¾„å’Œç±»å‹ é…ç½®æ–‡ä»¶çš„å¼•å…¥ events é…ç½®nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ï¼Œæ­¤éƒ¨åˆ†å¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåº”æ ¹æ®å®é™…æƒ…å†µå¤„ç†ï¼Œæ¯”å¦‚ï¼š\næ˜¯å¦å¼€å¯å¯¹å¤šworker processä¸‹çš„ç½‘ç»œè¿æ¥è¿›è¡Œåºåˆ—åŒ– æ˜¯å¦å…è®¸åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ é€‰å–å¤„ç†è¿æ¥çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ æ¯ä¸ªworker æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ç­‰ http å…¨å±€é…ç½® serveré…ç½® å…¨å±€ locationé…ç½® server é…ç½®å’ŒåŒ¹é…è§„åˆ™ ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥æœ‰å¤šä¸ªserverï¼Œè€Œå¯¹serverçš„è·¯å¾„åŒ¹é…ï¼Œåå‘ä»£ç†éƒ½æ˜¯åœ¨è¿™é‡Œé…ç½®çš„ã€‚\nåœ¨serverä¸­æœ€é‡è¦çš„ä¸€é¡¹é…ç½®ï¼šserver_nameçš„é…ç½®ã€‚server_nameå†³å®šäº†æ¥äº†ä¸€ä¸ªurlï¼Œåˆ°åº•æ˜¯å“ªä¸ªserverå¤„ç†è¯¥è¯·æ±‚ã€‚nginxä¼šä¾æ¬¡æ‰¾å’Œurlé…ç½®çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„serverã€‚server_nameå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚è€Œä¸”ä¸€ä¸ªserverçš„server_nameå¯ä»¥å¤šä¸ªï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚æ›´è¯¦ç»†çš„å…³äºserver_nameåŒ¹é…è§„åˆ™ï¼Œå‚çœ‹è¿™é‡Œ\nUnix-domain socket(UnixåŸŸå¥—æ¥å­—) Pythonå®ä¾‹æµ…è°ˆä¹‹ä¹ä½¿ç”¨æœ¬åœ°socketæ–‡ä»¶\nUnix domain socket æˆ–è€… IPC socketæ˜¯ä¸€ç§ç»ˆç«¯ï¼Œå¯ä»¥ä½¿åŒä¸€å°æ“ä½œç³»ç»Ÿä¸Šçš„ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹è¿›è¡Œæ•°æ®é€šä¿¡ã€‚ä¸ç®¡é“ç›¸æ¯”ï¼ŒUnix domain sockets æ—¢å¯ä»¥ä½¿ç”¨å­—èŠ‚æµï¼Œåˆå¯ä»¥ä½¿ç”¨æ•°æ®é˜Ÿåˆ—ï¼Œè€Œç®¡é“é€šä¿¡åˆ™åªèƒ½ä½¿ç”¨å­—èŠ‚æµã€‚Unix domain socketsçš„æ¥å£å’ŒInternet socketå¾ˆåƒï¼Œä½†å®ƒä¸ä½¿ç”¨ç½‘ç»œåº•å±‚åè®®æ¥é€šä¿¡ã€‚Unix domain socket çš„åŠŸèƒ½æ˜¯POSIXæ“ä½œç³»ç»Ÿé‡Œçš„ä¸€ç§ç»„ä»¶ã€‚\nUnix domain sockets ä½¿ç”¨ç³»ç»Ÿæ–‡ä»¶çš„åœ°å€æ¥ä½œä¸ºè‡ªå·±çš„èº«ä»½ã€‚å®ƒå¯ä»¥è¢«ç³»ç»Ÿè¿›ç¨‹å¼•ç”¨ã€‚æ‰€ä»¥ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åŒæ—¶æ‰“å¼€ä¸€ä¸ªUnix domain socketsæ¥è¿›è¡Œé€šä¿¡ã€‚ä¸è¿‡è¿™ç§é€šä¿¡æ–¹å¼æ˜¯å‘ç”Ÿåœ¨ç³»ç»Ÿå†…æ ¸é‡Œè€Œä¸ä¼šåœ¨ç½‘ç»œé‡Œä¼ æ’­ã€‚\néƒ¨ç½²åº”ç”¨çš„æ—¶å€™ï¼Œåˆ©ç”¨unix domain socketï¼Œå¯ä»¥é˜²æ­¢ç«¯å£å†²çªï¼Œå¯åŠ¨ç¨‹åºçš„æ—¶å€™è¦å°†è¿™ä¸ªsocketæ–‡ä»¶ç»‘å®šåˆ°Gunicornã€‚\nè¿™ä¸ªæ˜¯ç”¨äºè¿›ç¨‹é—´é€šä¿¡çš„æ–¹å¼ï¼Œé‚£ä¹ˆç½‘ç»œsocketæ˜¯ä»€ä¹ˆï¼Ÿ æ–‡ç« æˆ–æ–‡æ¡£é“¾æ¥ æ­å»ºnginxåå‘ä»£ç†ç”¨åšå†…ç½‘åŸŸåè½¬å‘ WEBè¯·æ±‚å¤„ç†äºŒï¼šNginxè¯·æ±‚åå‘ä»£ç† ä½¿ç”¨ Nginx å’Œ Gunicorn éƒ¨ç½² Django åšå®¢ ","permalink":"https://26huitailang.github.io/posts/nginx/nginx/","summary":"nginx [toc]\nå¸¸ç”¨å‘½ä»¤ nginx -s stop nginx -s reload ç®€ä»‹ åå‘ä»£ç† ä¸€å¥è¯ï¼š\nä»€ä¹ˆæ˜¯æ­£å‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯å®¢æˆ·ç«¯ ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯æ˜¯æ— æ„ŸçŸ¥çš„ nginxåå‘ä»£ç†é…ç½®\næ­£å¸¸æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; server ä»£ç†æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; clinet proxy â€“(send request)â€”\u0026gt; server åå‘ä»£ç†ï¼š client -(send request)-\u0026gt; server proxy -(send request)-\u0026gt; other server å¯ä»¥çœ‹åˆ°åå‘ä»£ç†å¹¶ä¸æ˜¯çœŸçš„åè¿‡æ¥ï¼Œè€Œæ˜¯ä»£ç†äººçš„èº«ä»½ç”±å®¢æˆ·ç«¯è½¬å‘äº†æœåŠ¡ç«¯ï¼Œä¹Ÿå› ä¸ºä»£ç†æ˜¯åœ¨æœåŠ¡ç«¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ˜¯å¯¹æ­¤æ— æ„ŸçŸ¥çš„ã€‚\nè´Ÿè½½å‡è¡¡ å°†åŸå…ˆé›†ä¸­è¯·æ±‚åˆ°å•ä¸ªæœåŠ¡å™¨çš„è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¯æŒæœåŠ¡æ¨ªå‘æ‰©å±•ã€‚\nåŠ¨é™åˆ†ç¦» é…ç½® å…¨å±€ é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventsä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦æ˜¯è®¾ç½®ä¸€äº›å½±å“nginxè¿è¡Œçš„é…ç½®æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼š\nç”¨æˆ·ï¼ˆç»„ï¼‰ worker processæ•°é‡ è¿›ç¨‹pidå­˜æ”¾è·¯å¾„ æ—¥å¿—å­˜æ”¾è·¯å¾„å’Œç±»å‹ é…ç½®æ–‡ä»¶çš„å¼•å…¥ events é…ç½®nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ï¼Œæ­¤éƒ¨åˆ†å¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåº”æ ¹æ®å®é™…æƒ…å†µå¤„ç†ï¼Œæ¯”å¦‚ï¼š\næ˜¯å¦å¼€å¯å¯¹å¤šworker processä¸‹çš„ç½‘ç»œè¿æ¥è¿›è¡Œåºåˆ—åŒ– æ˜¯å¦å…è®¸åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ é€‰å–å¤„ç†è¿æ¥çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ æ¯ä¸ªworker æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ç­‰ http å…¨å±€é…ç½® serveré…ç½® å…¨å±€ locationé…ç½® server é…ç½®å’ŒåŒ¹é…è§„åˆ™ ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥æœ‰å¤šä¸ªserverï¼Œè€Œå¯¹serverçš„è·¯å¾„åŒ¹é…ï¼Œåå‘ä»£ç†éƒ½æ˜¯åœ¨è¿™é‡Œé…ç½®çš„ã€‚\nåœ¨serverä¸­æœ€é‡è¦çš„ä¸€é¡¹é…ç½®ï¼šserver_nameçš„é…ç½®ã€‚server_nameå†³å®šäº†æ¥äº†ä¸€ä¸ªurlï¼Œåˆ°åº•æ˜¯å“ªä¸ªserverå¤„ç†è¯¥è¯·æ±‚ã€‚nginxä¼šä¾æ¬¡æ‰¾å’Œurlé…ç½®çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„serverã€‚server_nameå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚è€Œä¸”ä¸€ä¸ªserverçš„server_nameå¯ä»¥å¤šä¸ªï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚æ›´è¯¦ç»†çš„å…³äºserver_nameåŒ¹é…è§„åˆ™ï¼Œå‚çœ‹è¿™é‡Œ\nUnix-domain socket(UnixåŸŸå¥—æ¥å­—) Pythonå®ä¾‹æµ…è°ˆä¹‹ä¹ä½¿ç”¨æœ¬åœ°socketæ–‡ä»¶","title":"Nginx"},{"content":"Pandoc å¼€å§‹ install pandoc install miktext build ä¸­æ–‡è¦é€‰æ‹©åˆé€‚çš„å­—ä½“å¦åˆ™æ— æ³•æˆåŠŸåˆ›å»º fc-list mac: brew install fontconfig fc-list :lang-zh \u0026gt; fonts.txt fc-list -f \u0026ldquo;%{family}\\n\u0026rdquo; :lang=zh å‚æ•°è§£é‡Š -o: è¾“å‡ºæ–‡ä»¶ \u0026ndash;from: è¾“å…¥æ–‡ä»¶ç±»å‹ \u0026ndash;template: æ¨¡ç‰ˆæ–‡ä»¶ \u0026ndash;listings: åˆ—è¡¨ \u0026ndash;pdf-engine: pdfç”Ÿæˆç”¨çš„å¼•æ“ -V: å‚æ•° CJKmainfont: ä¸­æ–‡æ–‡å­—å­—ä½“ pandoc \u0026#34;README.md\u0026#34; -o \u0026#34;document.pdf\u0026#34; --from markdown --template \u0026#34;./template.latex\u0026#34; --listings --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open document.pdf data-dir DATADIR\nmacos: ~/.local/share/pandoc\nwindows: C:\\Users\\USERNAME\\AppData\\Roaming\\pandoc\ndefaults $DATADIR/defaults/docker.yamlï¼Œå¯ä»¥ä¸ºä¸åŒçš„æ–‡æ¡£è®¾ç½®è‡ªå·±çš„defaultsï¼Œé¿å…åé¢é‡å¤æ“ä½œï¼Œä»…éœ€ä½¿ç”¨pandoc --defaults dockerå³å¯æ‰“åŒ…æ–‡æ¡£\nfrom: markdown # reader: may be used instead of from: to: pdf # writer: may be used instead of to: # leave blank for output to stdout: output-file: docker.pdf # leave blank for input from stdin, use [] for no input: input-files: - é˜¿é‡Œäº‘ä»“åº“.md - ç®¡ç†å·¥å…·.md - åŠ é€Ÿ.md - æ‰©å®¹.md - æ¸…ç†.md - å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥.md - ç§æœ‰registry.md - debian-docker-install.md - env.md - logs.md - usage.md # or you may use input-file: with a single value # pdf-engine: wkhtmltopdf pdf-engine: xelatex self-contained: false standalone: true metadata: author: - Peter titlepage: true toc-own-page: true toc: true number-sections: true # code block wrap listings: true variables: CJKmainfont: KaiTi template: eisvogel verbosity: ERROR log-file: log.json filters: - mermaid-filter.cmd from: markdown # reader: may be used instead of from: to: pdf # writer: may be used instead of to: # leave blank for output to stdout: output-file: docker.pdf # leave blank for input from stdin, use [] for no input: input-files: - é˜¿é‡Œäº‘ä»“åº“.md - ç®¡ç†å·¥å…·.md - åŠ é€Ÿ.md - æ‰©å®¹.md - æ¸…ç†.md - å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥.md - ç§æœ‰registry.md - debian-docker-install.md - env.md - logs.md - usage.md # or you may use input-file: with a single value # pdf-engine: wkhtmltopdf pdf-engine: xelatex self-contained: false standalone: true metadata: author: - Peter titlepage: true toc-own-page: true toc: true number-sections: true # code block wrap listings: true variables: CJKmainfont: KaiTi template: eisvogel verbosity: ERROR log-file: log.json filters: - mermaid-filter.cmd template è®¾ç½®ä¸ºç³»ç»Ÿé…ç½®ï¼Œeisvogel.latexï¼Œgithub\nmacos: mkdir -p ~/.local/share/pandoc/templates windows: mkdir -p C:\\Users\\USERNAME\\AppData\\Roaming\\pandoc\\templates cp ./eisvogel.latex ~/.local/share/pandoc/templates/ pandoc \u0026#34;README.md\u0026#34; -o \u0026#34;document.pdf\u0026#34; --from markdown --template eisvogel --listings --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open document.pdf å¤šä¸ªmdæ–‡ä»¶è¾“å…¥ ä½¿ç”¨ç³»ç»Ÿè·¯å¾„ä¸‹çš„æ¨¡ç‰ˆ eisvogel \u0026ndash;number-sections ä¸ºå„ä¸ªæ ‡é¢˜ç¼–ç  toc æ ‡é¢˜ toc-own-page æ ‡é¢˜é¡µä¹‹åä»æ–°é¡µå¼€å§‹å†…å®¹ titlepage å°é¢ ```markdown --- title: å‰ç«¯ç»„ITæ‰‹å†Œ date: 2021-11-12 author: å‰ç«¯ç»„ titlepage: true toc: true toc-own-page: true --- \u0026gt; pandoc *.md -o \u0026#34;å‰ç«¯ITæ‰‹å†Œ.pdf\u0026#34; --from markdown --template eisvogel --listings --number-sections --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open \u0026#34;å‰ç«¯ITæ‰‹å†Œ.pdf\u0026#34; æ”¯æŒmermaid ä½¿ç”¨filterç‰¹æ€§ï¼Œé¦–å…ˆå®‰è£…å¯¹åº”çš„filter\nnpm install --global mermaid-filter è®¾ç½®å…¨å±€çš„npmå®‰è£…ä½ç½®åˆ°$PATHé‡Œé¢ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«filterã€‚\nåœ¨defaultså¯¹åº”çš„æ–‡ä»¶ä¸­æ·»åŠ filtersï¼š\nfilters: - mermaid-filter.cmd (windows) - mermaid-filter.sh åœ¨cliä¸­æ·»åŠ  \u0026ndash;filterå‚æ•°ï¼š\npandoc --defaults docker --filter mermaid-filter åˆ¶ä½œä¸€ä¸ªpandocé•œåƒ https://github.com/26huitailang/pandoc-demo\n","permalink":"https://26huitailang.github.io/posts/markdown/pandoc/","summary":"Pandoc å¼€å§‹ install pandoc install miktext build ä¸­æ–‡è¦é€‰æ‹©åˆé€‚çš„å­—ä½“å¦åˆ™æ— æ³•æˆåŠŸåˆ›å»º fc-list mac: brew install fontconfig fc-list :lang-zh \u0026gt; fonts.txt fc-list -f \u0026ldquo;%{family}\\n\u0026rdquo; :lang=zh å‚æ•°è§£é‡Š -o: è¾“å‡ºæ–‡ä»¶ \u0026ndash;from: è¾“å…¥æ–‡ä»¶ç±»å‹ \u0026ndash;template: æ¨¡ç‰ˆæ–‡ä»¶ \u0026ndash;listings: åˆ—è¡¨ \u0026ndash;pdf-engine: pdfç”Ÿæˆç”¨çš„å¼•æ“ -V: å‚æ•° CJKmainfont: ä¸­æ–‡æ–‡å­—å­—ä½“ pandoc \u0026#34;README.md\u0026#34; -o \u0026#34;document.pdf\u0026#34; --from markdown --template \u0026#34;./template.latex\u0026#34; --listings --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open document.pdf data-dir DATADIR\nmacos: ~/.local/share/pandoc\nwindows: C:\\Users\\USERNAME\\AppData\\Roaming\\pandoc\ndefaults $DATADIR/defaults/docker.yamlï¼Œå¯ä»¥ä¸ºä¸åŒçš„æ–‡æ¡£è®¾ç½®è‡ªå·±çš„defaultsï¼Œé¿å…åé¢é‡å¤æ“ä½œï¼Œä»…éœ€ä½¿ç”¨pandoc --defaults dockerå³å¯æ‰“åŒ…æ–‡æ¡£\nfrom: markdown # reader: may be used instead of from: to: pdf # writer: may be used instead of to: # leave blank for output to stdout: output-file: docker.","title":"Pandoc"},{"content":"README åˆæ¬¡ä½¿ç”¨ podman rootç”¨æˆ·å’Œérootç”¨æˆ·çš„imageså’Œcontaineræ˜¯åˆ†å¼€çš„ érootç”¨æˆ·ä½¿ç”¨podman generate systemdå‘½ä»¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ‹·è´åˆ°~/.config/systemd/user/ä¸‹é¢ï¼Œä½¿ç”¨systemctl --useræ‰§è¡Œ æµç¨‹æ¼”ç¤º\npodman pull docker.io/nginx:latest podman create --name nginx -p 8080:80 nginx:latest mkdir -p ~/.config/systemd/user cd ~/.config/systemd/user podman generate systemd --files --name nginx systemctl --user enable container-nginx systemctl --user start container-nginx curl http://127.0.0.1:8080 ","permalink":"https://26huitailang.github.io/posts/podman/readme/","summary":"README åˆæ¬¡ä½¿ç”¨ podman rootç”¨æˆ·å’Œérootç”¨æˆ·çš„imageså’Œcontaineræ˜¯åˆ†å¼€çš„ érootç”¨æˆ·ä½¿ç”¨podman generate systemdå‘½ä»¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ‹·è´åˆ°~/.config/systemd/user/ä¸‹é¢ï¼Œä½¿ç”¨systemctl --useræ‰§è¡Œ æµç¨‹æ¼”ç¤º\npodman pull docker.io/nginx:latest podman create --name nginx -p 8080:80 nginx:latest mkdir -p ~/.config/systemd/user cd ~/.config/systemd/user podman generate systemd --files --name nginx systemctl --user enable container-nginx systemctl --user start container-nginx curl http://127.0.0.1:8080 ","title":"Podman"},{"content":"Upgrade debian main version update $ apt-get update \u0026amp;\u0026amp; apt-get upgrade backup sources.list $ cp /etc/apt/sources.list /etc/apt/sources.list.bak replace `stretch` to `buster` of `/etc/apt/sources.list` $ sed -i \u0026#39;s/stretch/buster/g\u0026#39; /etc/apt/sources.list run upgrade $ apt-get update \u0026amp;\u0026amp; apt-get upgrade run dist upgrade $ apt-get dist-upgrade $ reboot $ lsb_release -a clean: $ apt-get autoremove ","permalink":"https://26huitailang.github.io/posts/linux/debian/upgrade/","summary":"Upgrade debian main version update $ apt-get update \u0026amp;\u0026amp; apt-get upgrade backup sources.list $ cp /etc/apt/sources.list /etc/apt/sources.list.bak replace `stretch` to `buster` of `/etc/apt/sources.list` $ sed -i \u0026#39;s/stretch/buster/g\u0026#39; /etc/apt/sources.list run upgrade $ apt-get update \u0026amp;\u0026amp; apt-get upgrade run dist upgrade $ apt-get dist-upgrade $ reboot $ lsb_release -a clean: $ apt-get autoremove ","title":"Upgrade debian main version"},{"content":"Gitlab CI/CD For the development environment.\nInstall with docker Read the official documentation for how to install docker.\nI installed docker on the MacOS.\ngitlab documentation\nsudo docker run --detach \\ --hostname 192.168.8.226 \\ --publish 443:443 --publish 80:80 --publish 8022:22 \\ --name gitlab \\ --restart always \\ --volume ~/gitlab/config:/etc/gitlab \\ --volume ~/gitlab/logs:/var/log/gitlab \\ --volume ~/gitlab/data:/var/opt/gitlab \\ gitlab/gitlab-ce:latest gitlab-runner Order of initialization:\ninstall register custom config documentation\nThere is no difficulty to install gitlab and gitlab-runner in docker.\nsudo docker run -d --name gitlab-runner --restart always \\ -v ~/gitlab-runner/config:/etc/gitlab-runner \\ -v /var/run/docker.sock:/var/run/docker.sock \\ gitlab/gitlab-runner:latest I was confused with the config of gitlab-runner, so I wrote these down.\nregister:\ndocker run --rm -t -i -v ~/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner register, cmd for register a runner. the register info will record in the ~/gitlab-runner/config/config.toml url is the url of the gitlab token is from your gitlab, the project runner and shared runner is different. You can registe it for shared runner and enable for the specified project. executor choose docker, I use the image python:3.7 for my python project. manual operation to edit the config.toml: pull_policy = \u0026quot;if-not-present\u0026quot; default value is always for every time pull the image. network_mode = \u0026quot;host\u0026quot; default value is bridge that runner cannot connect other machines in the same net. for non-interactive register:\ndocker run --rm -v /srv/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner register \\ --non-interactive \\ --executor \u0026#34;docker\u0026#34; \\ --docker-image alpine:latest \\ --url \u0026#34;https://gitlab.com/\u0026#34; \\ --registration-token \u0026#34;PROJECT_REGISTRATION_TOKEN\u0026#34; \\ --description \u0026#34;docker-runner\u0026#34; \\ --tag-list \u0026#34;docker,aws\u0026#34; \\ --run-untagged=\u0026#34;true\u0026#34; \\ --locked=\u0026#34;false\u0026#34; \\ --access-level=\u0026#34;not_protected\u0026#34; config.toml privileged å¦‚æœé‡åˆ°mkdir permission deniedï¼Œè®¾ä¸ºtrueï¼Œå¯ä»¥è§£å†³\n[[runners]] name = \u0026#34;python3.7\u0026#34; url = \u0026#34;http://192.168.8.226/\u0026#34; token = \u0026#34;xxxxxx\u0026#34; executor = \u0026#34;docker\u0026#34; [runners.custom_build_dir] [runners.docker] tls_verify = false image = \u0026#34;python:3.7\u0026#34; privileged = true disable_entrypoint_overwrite = false oom_kill_disable = false disable_cache = false volumes = [\u0026#34;/cache\u0026#34;] shm_size = 0 pull_policy = \u0026#34;if-not-present\u0026#34; network_mode = \u0026#34;host\u0026#34; [runners.cache] [runners.cache.s3] [runners.cache.gcs] [runners.custom] run_exec = \u0026#34;\u0026#34; cache with local files. Npm example:\nvolumes = [\u0026#34;/opt/gitlab-runner/cache:/cache\u0026#34;] ls /opt/gitlab-runner/cache/GROUP/PROJECT_NAME/builds/GROUP/PROJECT_NAME cache.zip cache.zip is the node_modules.zip file.\n.gitlab-ci.yml Use the ssh connect development machine and run the shell command to update the project. cache after the CI. The runner will cache the pip and venv packages. # This file is a template, and might need editing before it works on your project. image: python:3.7 # This folder is cached between builds # http://docs.gitlab.com/ce/ci/yaml/README.html#cache cache: paths: - .cache/pip - venv/ before_script: ## ## Install ssh-agent if not already installed, it is required by Docker. ## (change apt-get to yum if you use an RPM-based image) ## - \u0026#39;which ssh-agent || ( apt-get update -y \u0026amp;\u0026amp; apt-get install openssh-client -y )\u0026#39; ## ## Run ssh-agent (inside the build environment) ## - eval $(ssh-agent -s) ## ## Add the SSH key stored in SSH_PRIVATE_KEY variable to the agent store ## We\u0026#39;re using tr to fix line endings which makes ed25519 keys work ## without extra base64 encoding. ## https://gitlab.com/gitlab-examples/ssh-private-key/issues/1#note_48526556 ## - echo \u0026#34;$SSH_PRIVATE_KEY\u0026#34; \u0026gt; deploy.key - chmod 0600 deploy.key - ssh-add deploy.key - mkdir -p ~/.ssh - chmod 700 ~/.ssh - \u0026#39;[[ -f /.dockerenv ]] \u0026amp;\u0026amp; echo -e \u0026#34;Host *\\n\\tStrictHostKeyChecking no\\n\\n\u0026#34; \u0026gt; ~/.ssh/config\u0026#39; ## ## Optionally, if you will be using any Git commands, set the user name and ## and email. ## #- git config --global user.email \u0026#34;user@example.com\u0026#34; #- git config --global user.name \u0026#34;User name\u0026#34; - python -V # Print out python version for debugging test: script: - python -m venv ./venv - source venv/bin/activate - pip install -U -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/ - cd lq_end # - cp -f config/ci.py config/config.py # - python manage.py devops drop_and_recreate_ci_database # - flask db upgrade # - flask init-db - python -m pytest --cov=. - ssh root@192.168.8.109 \u0026#34;cd /root/test-project \u0026amp;\u0026amp; ./script.sh\u0026#34; #pep8: # script: # - python -m venv ./venv # - source venv/bin/activate # - pip install -U flake8 # - cd projectpath # - flake8 ","permalink":"https://26huitailang.github.io/posts/devops/gitlab/gitlab-ci-cd/","summary":"Gitlab CI/CD For the development environment.\nInstall with docker Read the official documentation for how to install docker.\nI installed docker on the MacOS.\ngitlab documentation\nsudo docker run --detach \\ --hostname 192.168.8.226 \\ --publish 443:443 --publish 80:80 --publish 8022:22 \\ --name gitlab \\ --restart always \\ --volume ~/gitlab/config:/etc/gitlab \\ --volume ~/gitlab/logs:/var/log/gitlab \\ --volume ~/gitlab/data:/var/opt/gitlab \\ gitlab/gitlab-ce:latest gitlab-runner Order of initialization:\ninstall register custom config documentation\nThere is no difficulty to install gitlab and gitlab-runner in docker.","title":"Gitlab CI/CD"},{"content":"Apache Bench Test GET\nab -c 10 -n 40 http://127.0.0.1:8000/api/v1/mzitu/tags/\nPOST, https://blog.csdn.net/chenggong2dm/article/details/51850923\nab -n 1 -c 1 -p f:/postdata.txt -T application/x-www-form-urlencoded \u0026ldquo;http://127.0.0.1/abpost\u0026rdquo; ab -n 100 -c 10 -p data.json -T application/json http://127.0.0.1/api\n// postdata.txt ","permalink":"https://26huitailang.github.io/posts/test/ab-test/","summary":"Apache Bench Test GET\nab -c 10 -n 40 http://127.0.0.1:8000/api/v1/mzitu/tags/\nPOST, https://blog.csdn.net/chenggong2dm/article/details/51850923\nab -n 1 -c 1 -p f:/postdata.txt -T application/x-www-form-urlencoded \u0026ldquo;http://127.0.0.1/abpost\u0026rdquo; ab -n 100 -c 10 -p data.json -T application/json http://127.0.0.1/api\n// postdata.txt ","title":"Apache Bench Test"},{"content":"Prometheus ç®€ä»‹ æ¦‚å¿µ prometheus server exporterï¼Œç”¨äºserveré‡‡é›†æ•°æ®ï¼Œæœ‰å®˜æ–¹æä¾›çš„node-exporterï¼Œä¹Ÿå¯ä»¥é€šè¿‡å„ç§SDKè‡ªå®šä¹‰å¯¼å‡ºå†…å®¹ï¼Œæš´éœ²ä¸€ä¸ªç±»ä¼¼/metricsçš„è·¯å¾„ç”¨äºé‡‡é›† æ³¨æ„ï¼Œexporteråœ¨å¤šè¿›ç¨‹ï¼ˆgunicorn å¤šè¿›ç¨‹ï¼‰æ¨¡å¼ä¸‹ä½¿ç”¨ä¼šæœ‰é™åˆ¶ï¼Œå‚è€ƒæ–‡æ¡£ æ•°æ®æ¨¡å‹ï¼Œå’Œinfluxdbç±»ä¼¼ï¼Œæ˜¯æ—¶åºæ•°æ®åº“ï¼Œä»¥metricä¸ºåç§°ï¼Œå¤šä¸ªlabelï¼ˆkey-valueå½¢å¼ï¼‰ç»„æˆï¼š\u0026lt;metric name\u0026gt;{\u0026lt;label name\u0026gt;=\u0026lt;label value\u0026gt;, ...} é‡è½½é…ç½® Yes, sending SIGHUP to the Prometheus process or an HTTP POST request to the /-/reload endpoint will reload and apply the configuration file. The various components attempt to handle failing changes gracefully.\n","permalink":"https://26huitailang.github.io/posts/k3s/prometheus/","summary":"Prometheus ç®€ä»‹ æ¦‚å¿µ prometheus server exporterï¼Œç”¨äºserveré‡‡é›†æ•°æ®ï¼Œæœ‰å®˜æ–¹æä¾›çš„node-exporterï¼Œä¹Ÿå¯ä»¥é€šè¿‡å„ç§SDKè‡ªå®šä¹‰å¯¼å‡ºå†…å®¹ï¼Œæš´éœ²ä¸€ä¸ªç±»ä¼¼/metricsçš„è·¯å¾„ç”¨äºé‡‡é›† æ³¨æ„ï¼Œexporteråœ¨å¤šè¿›ç¨‹ï¼ˆgunicorn å¤šè¿›ç¨‹ï¼‰æ¨¡å¼ä¸‹ä½¿ç”¨ä¼šæœ‰é™åˆ¶ï¼Œå‚è€ƒæ–‡æ¡£ æ•°æ®æ¨¡å‹ï¼Œå’Œinfluxdbç±»ä¼¼ï¼Œæ˜¯æ—¶åºæ•°æ®åº“ï¼Œä»¥metricä¸ºåç§°ï¼Œå¤šä¸ªlabelï¼ˆkey-valueå½¢å¼ï¼‰ç»„æˆï¼š\u0026lt;metric name\u0026gt;{\u0026lt;label name\u0026gt;=\u0026lt;label value\u0026gt;, ...} é‡è½½é…ç½® Yes, sending SIGHUP to the Prometheus process or an HTTP POST request to the /-/reload endpoint will reload and apply the configuration file. The various components attempt to handle failing changes gracefully.","title":"Prometheus"},{"content":"PyCharm ä½¿ç”¨ Docker pycharm use docker for development and stage\nDevelopment ä½¿ç”¨windowså’Œvirtualboxï¼Œæ²¡æœ‰æ‰“å¼€hyper-væ‰€ä»¥æ— æ³•ä½¿ç”¨dockerï¼Œåœ¨è™šæ‹Ÿæœºä¸­ä½¿ç”¨dockerå¹¶æ‰“å¼€tcpï¼Œä½†æ˜¯ç”±äºvolumeåªèƒ½æŒ‚è½½å®¿ä¸»æœºï¼Œæ‰€ä»¥è¦å…ˆç”¨pycharmmå°†æ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹çš„æ˜ å°„ç›®å½•ï¼Œå†ä½¿ç”¨ã€‚ æ­¤æ–¹æ³•é€‚åˆè¿˜æ²¡æœ‰å‡†å¤‡å¼€å‘ç¯å¢ƒå’Œéœ€è¦ä½¿ç”¨dockerä½œä¸ºå¼€å‘ç¯å¢ƒï¼Œä½†æ˜¯windowsæœ¬æœºæ²¡æœ‰dockerçš„æƒ…å†µ æˆ‘å·²ä½¿ç”¨è™šæ‹Ÿæœºå’Œpycharmè¿œç¨‹åŒæ­¥åŠŸèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœ åœ¨å®¿ä¸»æœºä¸­å¼€å‘æ—¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†dockeré…ç½®é›†æˆåˆ°configurationä¸­ Stage PyCharmçš„dockerä¹Ÿæ”¯æŒä¿®æ”¹registryï¼Œå¦‚æœæœ‰è¿œç¨‹ä»“åº“éœ€è¦çš„ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿åˆ†å‘é•œåƒ\n","permalink":"https://26huitailang.github.io/posts/pycharm/docker/","summary":"PyCharm ä½¿ç”¨ Docker pycharm use docker for development and stage\nDevelopment ä½¿ç”¨windowså’Œvirtualboxï¼Œæ²¡æœ‰æ‰“å¼€hyper-væ‰€ä»¥æ— æ³•ä½¿ç”¨dockerï¼Œåœ¨è™šæ‹Ÿæœºä¸­ä½¿ç”¨dockerå¹¶æ‰“å¼€tcpï¼Œä½†æ˜¯ç”±äºvolumeåªèƒ½æŒ‚è½½å®¿ä¸»æœºï¼Œæ‰€ä»¥è¦å…ˆç”¨pycharmmå°†æ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹çš„æ˜ å°„ç›®å½•ï¼Œå†ä½¿ç”¨ã€‚ æ­¤æ–¹æ³•é€‚åˆè¿˜æ²¡æœ‰å‡†å¤‡å¼€å‘ç¯å¢ƒå’Œéœ€è¦ä½¿ç”¨dockerä½œä¸ºå¼€å‘ç¯å¢ƒï¼Œä½†æ˜¯windowsæœ¬æœºæ²¡æœ‰dockerçš„æƒ…å†µ æˆ‘å·²ä½¿ç”¨è™šæ‹Ÿæœºå’Œpycharmè¿œç¨‹åŒæ­¥åŠŸèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœ åœ¨å®¿ä¸»æœºä¸­å¼€å‘æ—¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†dockeré…ç½®é›†æˆåˆ°configurationä¸­ Stage PyCharmçš„dockerä¹Ÿæ”¯æŒä¿®æ”¹registryï¼Œå¦‚æœæœ‰è¿œç¨‹ä»“åº“éœ€è¦çš„ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿åˆ†å‘é•œåƒ","title":"PyCharm Docker"},{"content":"Djangoæ‰“å¼€gzipå¯¼è‡´æ–‡ä»¶æµcontent-lengthä¸¢å¤± code GZipMiddleware\nuse gzip middleware will del response['Content-Length'] if response.streaming. nginx gzip is the same problem.\nIf file feature is important. You\u0026rsquo;d better be independent from the api or system.\n","permalink":"https://26huitailang.github.io/posts/django/gzip/","summary":"Djangoæ‰“å¼€gzipå¯¼è‡´æ–‡ä»¶æµcontent-lengthä¸¢å¤± code GZipMiddleware\nuse gzip middleware will del response['Content-Length'] if response.streaming. nginx gzip is the same problem.\nIf file feature is important. You\u0026rsquo;d better be independent from the api or system.","title":"Djangoæ‰“å¼€gzipå¯¼è‡´æ–‡ä»¶æµcontent-lengthä¸¢å¤±"},{"content":"k3s åˆæ¬¡ä½¿ç”¨ multipass ç¯å¢ƒå‡†å¤‡ quick-start å‚è€ƒ1 å‚è€ƒ2 # k3s1 node for master 192.168.64.5 multipass launch -v --name k3s1 20.04 multipass shell k3s1 curl -sfL https://get.k3s.io | sh - # default config sudo cat /etc/rancher/k3s/k3s.yaml # node-token sudo cat /var/lib/rancher/k3s/server/node-token # Check for Ready node, takes maybe 30 seconds sudo kubectl get nodes # k3s2 node 192.168.64.6 multipass launch -v --name k3s2 20.04 multipass shell k3s2 # add node to cluster # token in master cat /var/lib/rancher/k3s/server/node-token # K3S_NODE_NAME for unique hostname export K3S_TOKEN=x export K3S_URL=https://192.168.1.21:6443 curl -sfL https://get.k3s.io | K3S_URL=${K3S_URL} K3S_TOKEN=${K3S_TOKEN} sh - # if not register successfully, æŸ¥çœ‹æ—¥å¿—å¯èƒ½æ˜¯å› ä¸ºä¹‹å‰æœ‰é‡å¤node hostname # åŸå› ï¼šhttps://github.com/rancher/k3s/issues/802 ç§»é™¤nodeæ²¡æœ‰ä¸€åŒç§»é™¤å¯†ç  sudo vim /var/lib/rancher/k3s/server/cred/node-passwd æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼š\nsudo kubectl get nodes dashboard kube-dashboard\ninstall\nGITHUB_URL=https://github.com/kubernetes/dashboard/releases VERSION_KUBE_DASHBOARD=$(curl -w \u0026#39;%{url_effective}\u0026#39; -I -L -s -S ${GITHUB_URL}/latest -o /dev/null | sed -e \u0026#39;s|.*/||\u0026#39;) sudo k3s kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/${VERSION_KUBE_DASHBOARD}/aio/deploy/recommended.yaml Dashboard RBAC Configuration\ndashboard.admin-user.yml\napiVersion: v1 kind: ServiceAccount metadata: name: admin-user namespace: kubernetes-dashboard dashboard.admin-user-role.yml\napiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: admin-user roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: admin-user namespace: kubernetes-dashboard sudo k3s kubectl create -f dashboard.admin-user.yml -f dashboard.admin-user-role.yml Obtain the Bearer Token, ç”¨äºtokenç™»å½•dashboard\nsudo k3s kubectl -n kubernetes-dashboard describe secret admin-user-token | grep ^token access\nhttp://192.168.64.5:6443/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/ ingress k3s é»˜è®¤ä½¿ç”¨çš„æ˜¯traefikï¼Œk8sæ¨èçš„æ˜¯GCEå’Œingress-nginxã€‚\nä½†æ˜¯traefiké»˜è®¤é…ç½®: /var/lib/rancher/k3s/server/manifests/traefik.yaml æ²¡æœ‰å¼€å¯dashboardã€‚å°è¯•æ‰“å¼€ï¼š\næŸ¥çœ‹å½“å‰é…ç½®ï¼š\nkubectl describe deploy traefik -n kube-system å¾—çŸ¥é…ç½®æ˜¯ä½¿ç”¨çš„ /config çš„volumeï¼š\nkubectl describe configmap traefik -n kube-system æ·»åŠ setéƒ¨åˆ†å†…å®¹ï¼š\nset: dashboard.enabled: \u0026quot;true\u0026quot; traefik.yml\nroot@k3s1:/var/lib/rancher/k3s/server/manifests# cat traefik.yaml apiVersion: helm.cattle.io/v1 kind: HelmChart metadata: name: traefik namespace: kube-system spec: chart: https://%{KUBERNETES_API}%/static/charts/traefik-1.81.0.tgz set: dashboard.enabled: \u0026#34;true\u0026#34; valuesContent: |- rbac: enabled: true ssl: enabled: true metrics: prometheus: enabled: true kubernetes: ingressEndpoint: useDefaultPublishedService: true image: \u0026#34;rancher/library-traefik\u0026#34; tolerations: - key: \u0026#34;CriticalAddonsOnly\u0026#34; operator: \u0026#34;Exists\u0026#34; - key: \u0026#34;node-role.kubernetes.io/master\u0026#34; operator: \u0026#34;Exists\u0026#34; effect: \u0026#34;NoSchedule\u0026#34; å¦‚ä½•é…ç½®ingressï¼Œé…åˆä¸€ä¸ªdjangoçš„sample\napiVersion: extensions/v1beta1 kind: Ingress metadata: name: my-server spec: rules: - host: my-server.192.168.1.22.xip.io http: paths: - path: /jobs backend: serviceName: web servicePort: 8080 - path: /static backend: serviceName: web servicePort: 8080 cheat sheet cheatsheet\nnginx demo in k3s2 machine\nmkdir ~/controllers cat \u0026gt; nginx-deployment.yaml \u0026lt;\u0026lt;EOL apiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment labels: app: nginx spec: replicas: 3 selector: matchLabels: app: nginx template: metadata: labels: app: nginx spec: containers: - name: nginx image: nginx:1.14.2 ports: - containerPort: 80 EOL é—®é¢˜ vagrant nat 10.0.2.15ç½‘ç»œé—®é¢˜ï¼Œserver/agent é€‰æ‹©å¯¹åº”çš„ç½‘ç»œå¯åŠ¨ï¼Œä¸ç„¶é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª sudo vim /etc/systemd/system/k3s-agent.service sudo vim /etc/systemd/system/k3s.service ExecStart=/usr/local/bin/k3s \\ server --flannel-iface=enp0s8 \\ é•œåƒ docker.io åŠ é€Ÿï¼Œåœ¨containerdçš„configä¸­åŠ å…¥åœ°å€ï¼Œhttp://www.zzfly.net/k3s-installation-and-containerd-registry/ [plugins.cri.registry.mirrors] [plugins.cri.registry.mirrors.\u0026#34;docker.io\u0026#34;] endpoint = [\u0026#34;https://docker.mirrors.ustc.edu.cn\u0026#34;] root@k3s1:/vagrant/samples-master/django# cd /var/lib/rancher/k3s/agent/etc/containerd/ root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# ls config.toml root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# cp config.toml config.toml.tmpl root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# vim config.toml.tmpl root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# systemctl restart k3s root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# crictl info | grep registry -C 10 } }, \u0026#34;noPivot\u0026#34;: false }, \u0026#34;cni\u0026#34;: { \u0026#34;binDir\u0026#34;: \u0026#34;/var/lib/rancher/k3s/data/572dcee7aa63e8f11e61142e4b0fc4f7ce33a0a6fed6a72924c6f6be85781b10/bin\u0026#34;, \u0026#34;confDir\u0026#34;: \u0026#34;/var/lib/rancher/k3s/agent/etc/cni/net.d\u0026#34;, \u0026#34;maxConfNum\u0026#34;: 1, \u0026#34;confTemplate\u0026#34;: \u0026#34;\u0026#34; }, \u0026#34;registry\u0026#34;: { \u0026#34;mirrors\u0026#34;: { \u0026#34;docker.io\u0026#34;: { \u0026#34;endpoint\u0026#34;: [ \u0026#34;https://docker.mirrors.ustc.edu.cn\u0026#34; ] } }, \u0026#34;configs\u0026#34;: null, \u0026#34;auths\u0026#34;: null }, ","permalink":"https://26huitailang.github.io/posts/k3s/k3s/","summary":"k3s åˆæ¬¡ä½¿ç”¨ multipass ç¯å¢ƒå‡†å¤‡ quick-start å‚è€ƒ1 å‚è€ƒ2 # k3s1 node for master 192.168.64.5 multipass launch -v --name k3s1 20.04 multipass shell k3s1 curl -sfL https://get.k3s.io | sh - # default config sudo cat /etc/rancher/k3s/k3s.yaml # node-token sudo cat /var/lib/rancher/k3s/server/node-token # Check for Ready node, takes maybe 30 seconds sudo kubectl get nodes # k3s2 node 192.168.64.6 multipass launch -v --name k3s2 20.04 multipass shell k3s2 # add node to cluster # token in master cat /var/lib/rancher/k3s/server/node-token # K3S_NODE_NAME for unique hostname export K3S_TOKEN=x export K3S_URL=https://192.","title":"k3s"},{"content":"multipass to set development environment å®˜ç½‘\næŒ‡å®šé…ç½® $ multipass launch --name XXX -c 2 -d 20G -m 2G åˆ é™¤ $ multipass delete --purge XXXXX é—®é¢˜ macosä¸‹é¢ä½¿ç”¨virtualboxæš‚æ—¶æ‹¿ä¸åˆ°ipï¼Œåªèƒ½ä½¿ç”¨NATï¼Œæœ€å¥½ä½¿ç”¨hyperkit windowsä¸‹é¢ä¹Ÿä¸è¡Œï¼Œå°è¯•æ·»åŠ ç¬¬äºŒä¸ªç½‘ç»œ(guiæ“ä½œ or vboxmanager)ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†æ¡¥æ¥ï¼Œä¹‹åä¿®æ”¹/etc/network/interfaceså¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œé‡å¯ä¹‹åæŸ¥çœ‹ç½‘å¡èƒ½è·å¾—ip # ubuntu 18.04 allow-hotplug enp0s8 iface enp0s8 inet static address 10.200.242.200 netmask 255.0.0.0 gateway 10.0.0.3 ubuntu20.04æ“ä½œ: ä¿®æ”¹ /etc/netplan/50-cloud-init.yaml åº”ç”¨ sudo netplan apply é‡å¯ sudo reboot # ubuntu 20.04 /etc/netplan/50-cloud-init.yaml network: ethernets: enp0s3: dhcp4: true match: macaddress: 08:00:27:bc:97:36 set-name: enp0s3 version: 2 # change like following part network: ethernets: enp0s3: dhcp4: false addresses: [10.200.242.200/8] gateway4: 10.0.0.3 nameservers: addresses: [8.8.8.8, 8.8.4.4] match: macaddress: 08:00:27:bc:97:36 set-name: enp0s3 version: 2 ","permalink":"https://26huitailang.github.io/posts/linux/ubuntu/multipass/","summary":"multipass to set development environment å®˜ç½‘\næŒ‡å®šé…ç½® $ multipass launch --name XXX -c 2 -d 20G -m 2G åˆ é™¤ $ multipass delete --purge XXXXX é—®é¢˜ macosä¸‹é¢ä½¿ç”¨virtualboxæš‚æ—¶æ‹¿ä¸åˆ°ipï¼Œåªèƒ½ä½¿ç”¨NATï¼Œæœ€å¥½ä½¿ç”¨hyperkit windowsä¸‹é¢ä¹Ÿä¸è¡Œï¼Œå°è¯•æ·»åŠ ç¬¬äºŒä¸ªç½‘ç»œ(guiæ“ä½œ or vboxmanager)ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†æ¡¥æ¥ï¼Œä¹‹åä¿®æ”¹/etc/network/interfaceså¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œé‡å¯ä¹‹åæŸ¥çœ‹ç½‘å¡èƒ½è·å¾—ip # ubuntu 18.04 allow-hotplug enp0s8 iface enp0s8 inet static address 10.200.242.200 netmask 255.0.0.0 gateway 10.0.0.3 ubuntu20.04æ“ä½œ: ä¿®æ”¹ /etc/netplan/50-cloud-init.yaml åº”ç”¨ sudo netplan apply é‡å¯ sudo reboot # ubuntu 20.04 /etc/netplan/50-cloud-init.yaml network: ethernets: enp0s3: dhcp4: true match: macaddress: 08:00:27:bc:97:36 set-name: enp0s3 version: 2 # change like following part network: ethernets: enp0s3: dhcp4: false addresses: [10.","title":"Multipass"},{"content":"Tool Hub å„ä¸ªåˆ†ç±»çš„å·¥å…·æ±‡æ€»\nå¼€å‘ ä»£ç  nvim vscode jetbrains vim ä»£ç ç®¡ç† gitea gitlab CI drone jetbrains teamcity gitlab æ¥å£æµ‹è¯• postman httpie jebrains http test curl æ¥å£mockæµ‹è¯• httpretty: a full fake TCP socket module. Inspired by FakeWeb(ruby), ç”¨äºæ¨¡æ‹Ÿhttpå¤–éƒ¨è®¿é—®è¯·æ±‚ responses: A utility for mocking out the Python Requests library. æ¥å£æ€§èƒ½æµ‹è¯• vegeta pssh + vegeta, psshå¹¶è¡Œåœ¨å¤šä¸ªè®¡ç®—æœºä¸­æ‰§è¡Œå‘½ä»¤ï¼Œvegetaæ¥å£æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒä»£ç ä¿®æ”¹ã€å‘½ä»¤æ¨¡å¼ï¼Œè¾“å‡ºjsonã€textã€gobã€htmlç­‰æ ¼å¼ apache benchmark(ab) ä»£ç æ€§èƒ½åˆ†æ Python memray pytest-memray py-spy, Never use print for debugging again PySnooper, Never use print for debugging again æ–‡æ¡£ markdownï¼š\ntyporaï¼Œå·²æ”¶è´¹ vscode + markdown + mermaid plugin markdown mermaid plantUML pandoc æ„å»ºæ–‡æ¡£ i18n poedit redis another redis desktop manager redis desktop manager å¯†ç  keepass, windows macpass, macos, keepssçš„macå®ç° è¾“å…¥æ•ˆç‡ atext, windows copyQ, windows afred, macos dash, macos ssh/sftp transmit, macos xshell, windows mobaxterm, windows ä½œå›¾ å·¥å…· åŠŸèƒ½ ä»·æ ¼ åœ°å€ draw.io æ”¯æŒåœ¨çº¿/ç¦»çº¿ç»˜å›¾ï¼Œç±»ä¼¼visio å…è´¹ https://www.draw.io/ excalidraw æ”¯æŒåœ¨çº¿/ç¦»çº¿ï¼Œæ‰‹ç»˜é£æ ¼ç™½æ¿ å…è´¹ https://github.com/excalidraw/excalidraw figma åœ¨çº¿ï¼Œå„ç§è®¾è®¡ç»˜å›¾ æœ‰é™åŠŸèƒ½å…è´¹ https://www.figma.com/ whimsical åœ¨çº¿ï¼Œdocs/flowcharts/wireframes/mindmaps/projects æœ‰é™åŠŸèƒ½å…è´¹ https://www.whimsical.com/ æ–‡ä»¶æ¯”å¯¹ beyondcompare diff æ–‡ä»¶åŒæ­¥ rsync FreeFileSyncï¼Œ windows/macos ","permalink":"https://26huitailang.github.io/posts/tools/toolbox/","summary":"Tool Hub å„ä¸ªåˆ†ç±»çš„å·¥å…·æ±‡æ€»\nå¼€å‘ ä»£ç  nvim vscode jetbrains vim ä»£ç ç®¡ç† gitea gitlab CI drone jetbrains teamcity gitlab æ¥å£æµ‹è¯• postman httpie jebrains http test curl æ¥å£mockæµ‹è¯• httpretty: a full fake TCP socket module. Inspired by FakeWeb(ruby), ç”¨äºæ¨¡æ‹Ÿhttpå¤–éƒ¨è®¿é—®è¯·æ±‚ responses: A utility for mocking out the Python Requests library. æ¥å£æ€§èƒ½æµ‹è¯• vegeta pssh + vegeta, psshå¹¶è¡Œåœ¨å¤šä¸ªè®¡ç®—æœºä¸­æ‰§è¡Œå‘½ä»¤ï¼Œvegetaæ¥å£æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒä»£ç ä¿®æ”¹ã€å‘½ä»¤æ¨¡å¼ï¼Œè¾“å‡ºjsonã€textã€gobã€htmlç­‰æ ¼å¼ apache benchmark(ab) ä»£ç æ€§èƒ½åˆ†æ Python memray pytest-memray py-spy, Never use print for debugging again PySnooper, Never use print for debugging again æ–‡æ¡£ markdownï¼š","title":"Toolbox"},{"content":"åˆ©ç”¨proxy è§£å†³ Django Vue å¼€å‘ç¯å¢ƒä¸­çš„è·¨åŸŸé—®é¢˜ æœ€è¿‘ä½¿ç”¨ Django+Vueçš„ç»„åˆå¿«é€Ÿçš„åšä¸€ä¸ªé¡¹ç›®ï¼Œå‰æ®µä¹‹å‰æœ‰çœ‹è¿‡ï¼Œä½†æ˜¯åªæ˜¯ğŸ‘€ä¼šäº†ï¼Œè¿™æ¬¡å®é™…æ“ä½œï¼Œåœ¨å‰åç«¯åˆ†ç¦»åçš„å¼€å‘ç¯å¢ƒä¸­è¸©äº†å‘ã€‚\nç¯å¢ƒ Django + DRF Django Channelsï¼Œä¸»è¦æ˜¯websocket vue-admin-templateï¼Œä¸€ä¸ªå¼€æºçš„é¡¹ç›®ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æœ‰å®ç°ï¼Œæ–°æ‰‹å¯ä»¥ç”¨æ¥æ”¹æ”¹å°±ç”¨ï¼Œè¿˜èƒ½å­¦ä¹  å¼€å‘ç¯å¢ƒï¼š\nwsgi, 8000 asgi, 8001 vue, 9528 é—®é¢˜ æƒ³åƒåœ¨ä½¿ç”¨nginxä¸€æ ·çš„é€æ˜çš„ä½¿ç”¨å¼€å‘ç¯å¢ƒ djangoå·²ç»é…ç½®äº†corsheaders middlewareäº† å°è¯• axiosæ˜¾ç¤ºæŒ‡å®šåœ°å€å’Œç«¯å£åˆ°8000çš„æœåŠ¡ä¸Šï¼Œè§£å†³äº†axioså®ä¾‹çš„è®¿é—®ï¼Œä½†æ˜¯ä½¿ç”¨ el-uploadçš„è¡¨å•æ—¶ï¼Œå‘ç°å°±ä¸å¥½ä½¿äº†ï¼Œlocalhostå’Œå…¶ä»–ä¸åŒåŸŸï¼Œæ‹¿ä¸åˆ° cookieä¸­çš„csrftokenï¼Œå¯¼è‡´è¢« djangoæ‹’ç» è§£å†³ åœ¨æŸ¥çœ‹äº†å„ç§æ–‡æ¡£åï¼Œæœ€æœ‰æ•ˆçš„æ–¹æ¡ˆæ˜¯devServerçš„proxyï¼Œè¿™æ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„æ˜¯http-proxy-middlewareè¿™ä¸ªä¸­é—´ä»¶ï¼Œæ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œå¯ä»¥çœ‹çœ‹ã€‚\nç›®æ ‡ï¼š\nä»£ç† /apiçš„è¯·æ±‚åˆ°8000ç«¯å£çš„wsgi server ä»£ç† /wsçš„è¯·æ±‚åˆ°8001çš„asgi server /api ---\u0026gt; localhost:8000/api localhost:9528 (cookie) -- /ws ---\u0026gt; localhost:8001/ws vue.conf.js\ndevServer: { ... proxy: { [process.env.VUE_APP_BASE_API]: { target: \u0026#39;http://127.0.0.1:8000\u0026#39;, changeOrigin: true, ws: false, pathRewrite: { [\u0026#39;^\u0026#39; + process.env.VUE_APP_BASE_API]: \u0026#39;\u0026#39; }, cookieDomainRewrite: { \u0026#39;*\u0026#39;: \u0026#39;localhost\u0026#39; } }, \u0026#39;/ws\u0026#39;: { target: \u0026#39;ws://127.0.0.1:8001\u0026#39;, // changeOrigin: true, secure: false, ws: true } } ... } è¯´æ˜ï¼š\nproxyé‡Œé¢çš„keyè¡¨ç¤ºè¦ä»£ç†çš„pathï¼Œæˆ‘è¿™é‡Œå†™çš„æ˜¯å˜é‡ä»£è¡¨çš„å€¼ï¼Œæ˜¯ä»å…¶ä»–åœ°æ–¹çœ‹åˆ°çš„ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ¤æ–­ï¼Œæ¯”å¦‚ /api-prod /api-devç­‰ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®å®é™…çš„å‘½åè§„åˆ™ï¼Œä¸€èˆ¬æ˜¯/apiå³å¯ targetï¼šè¡¨ç¤ºè¦ä»£ç†çš„è¯·æ±‚ç›®æ ‡ changeOriginï¼šè¡¨ç¤ºä¿®æ”¹è¯·æ±‚headerä¸­çš„origin wsï¼šè¡¨ç¤ºæ˜¯å¦ä»£ç†websockets pathRewriteï¼šæ ¹æ®æ­£åˆ™åŒ¹é…æ¥é‡å†™urlï¼Œæ ¹æ®å®é™…éœ€è¦æ¥å†™ cookieDomainRewriteï¼Œ{ '*': 'localhost' }è¡¨ç¤ºæ‰€æœ‰é‡å†™åˆ°localhostï¼Œè¿™æ ·æ‰€æœ‰çš„cookieéƒ½ä¼šåŒæ­¥è¿‡æ¥ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨äº†django sessionå’Œcrsftokenï¼Œæ‰€ä»¥è¿™é‡Œå¾—åŒæ­¥ä¸€ä¸‹ï¼Œä¸ç„¶ä¼šæœ‰å‰é¢è¯´çš„axios headerä¸­æœ‰X-CRSFTokenï¼Œè€Œç›´æ¥è¯·æ±‚çš„formè¡¨å•ä¸­æ²¡æœ‰ï¼Œå› ä¸ºcookieä¸åŒï¼Œå–ä¸åˆ°csrftokençš„å€¼ ","permalink":"https://26huitailang.github.io/posts/vue/cors/","summary":"åˆ©ç”¨proxy è§£å†³ Django Vue å¼€å‘ç¯å¢ƒä¸­çš„è·¨åŸŸé—®é¢˜ æœ€è¿‘ä½¿ç”¨ Django+Vueçš„ç»„åˆå¿«é€Ÿçš„åšä¸€ä¸ªé¡¹ç›®ï¼Œå‰æ®µä¹‹å‰æœ‰çœ‹è¿‡ï¼Œä½†æ˜¯åªæ˜¯ğŸ‘€ä¼šäº†ï¼Œè¿™æ¬¡å®é™…æ“ä½œï¼Œåœ¨å‰åç«¯åˆ†ç¦»åçš„å¼€å‘ç¯å¢ƒä¸­è¸©äº†å‘ã€‚\nç¯å¢ƒ Django + DRF Django Channelsï¼Œä¸»è¦æ˜¯websocket vue-admin-templateï¼Œä¸€ä¸ªå¼€æºçš„é¡¹ç›®ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æœ‰å®ç°ï¼Œæ–°æ‰‹å¯ä»¥ç”¨æ¥æ”¹æ”¹å°±ç”¨ï¼Œè¿˜èƒ½å­¦ä¹  å¼€å‘ç¯å¢ƒï¼š\nwsgi, 8000 asgi, 8001 vue, 9528 é—®é¢˜ æƒ³åƒåœ¨ä½¿ç”¨nginxä¸€æ ·çš„é€æ˜çš„ä½¿ç”¨å¼€å‘ç¯å¢ƒ djangoå·²ç»é…ç½®äº†corsheaders middlewareäº† å°è¯• axiosæ˜¾ç¤ºæŒ‡å®šåœ°å€å’Œç«¯å£åˆ°8000çš„æœåŠ¡ä¸Šï¼Œè§£å†³äº†axioså®ä¾‹çš„è®¿é—®ï¼Œä½†æ˜¯ä½¿ç”¨ el-uploadçš„è¡¨å•æ—¶ï¼Œå‘ç°å°±ä¸å¥½ä½¿äº†ï¼Œlocalhostå’Œå…¶ä»–ä¸åŒåŸŸï¼Œæ‹¿ä¸åˆ° cookieä¸­çš„csrftokenï¼Œå¯¼è‡´è¢« djangoæ‹’ç» è§£å†³ åœ¨æŸ¥çœ‹äº†å„ç§æ–‡æ¡£åï¼Œæœ€æœ‰æ•ˆçš„æ–¹æ¡ˆæ˜¯devServerçš„proxyï¼Œè¿™æ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„æ˜¯http-proxy-middlewareè¿™ä¸ªä¸­é—´ä»¶ï¼Œæ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œå¯ä»¥çœ‹çœ‹ã€‚\nç›®æ ‡ï¼š\nä»£ç† /apiçš„è¯·æ±‚åˆ°8000ç«¯å£çš„wsgi server ä»£ç† /wsçš„è¯·æ±‚åˆ°8001çš„asgi server /api ---\u0026gt; localhost:8000/api localhost:9528 (cookie) -- /ws ---\u0026gt; localhost:8001/ws vue.conf.js\ndevServer: { ... proxy: { [process.env.VUE_APP_BASE_API]: { target: \u0026#39;http://127.0.0.1:8000\u0026#39;, changeOrigin: true, ws: false, pathRewrite: { [\u0026#39;^\u0026#39; + process.env.VUE_APP_BASE_API]: \u0026#39;\u0026#39; }, cookieDomainRewrite: { \u0026#39;*\u0026#39;: \u0026#39;localhost\u0026#39; } }, \u0026#39;/ws\u0026#39;: { target: \u0026#39;ws://127.","title":"vue cors"},{"content":"docker env file åœ¨docker-compose ä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å¯¼å…¥.envfileã€‚\nweb: build: . restart: always working_dir: /deploy/mysite command: ./service_web.sh env_file: - .env # environments .env\nDOCKER=1 HOME=/deploy æƒ³ç”¨shell scriptåŠ¨æ€è·å–ç¯å¢ƒçš„CPU count å¦‚æœç›´æ¥åœ¨.env ä¸­å†™å¦‚ä¸‹çš„å†…å®¹ï¼Œä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š\nCPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l) æ‰€ä»¥ï¼Œåœ¨webæœåŠ¡çš„command: ./service_web.shè„šæœ¬ä¸­exportä¸€ä¸ªå˜é‡ï¼Œå¹¶åœ¨gunicornä¸­ä½¿ç”¨ï¼š\n#!/bin/bash sleep 5 export CPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l) python manage.py collectstatic -v0 --noinput python manage.py migrate --noinput /usr/local/bin/gunicorn -w $((2*$CPU_NUM+1)) -b unix:/deploy/running/handle/django-tutorial-server.sock mysite.wsgi:application --log-level info ","permalink":"https://26huitailang.github.io/posts/docker/env/","summary":"docker env file åœ¨docker-compose ä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å¯¼å…¥.envfileã€‚\nweb: build: . restart: always working_dir: /deploy/mysite command: ./service_web.sh env_file: - .env # environments .env\nDOCKER=1 HOME=/deploy æƒ³ç”¨shell scriptåŠ¨æ€è·å–ç¯å¢ƒçš„CPU count å¦‚æœç›´æ¥åœ¨.env ä¸­å†™å¦‚ä¸‹çš„å†…å®¹ï¼Œä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š\nCPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l) æ‰€ä»¥ï¼Œåœ¨webæœåŠ¡çš„command: ./service_web.shè„šæœ¬ä¸­exportä¸€ä¸ªå˜é‡ï¼Œå¹¶åœ¨gunicornä¸­ä½¿ç”¨ï¼š\n#!/bin/bash sleep 5 export CPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l) python manage.py collectstatic -v0 --noinput python manage.py migrate --noinput /usr/local/bin/gunicorn -w $((2*$CPU_NUM+1)) -b unix:/deploy/running/handle/django-tutorial-server.sock mysite.wsgi:application --log-level info ","title":"docker env file"},{"content":"docker åŠ é€Ÿ mac ~/.docker/daemon.json æ·»åŠ å¦‚ä¸‹é…ç½® { \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://registry.docker-cn.com\u0026#34;] } ","permalink":"https://26huitailang.github.io/posts/docker/%E5%8A%A0%E9%80%9F/","summary":"docker åŠ é€Ÿ mac ~/.docker/daemon.json æ·»åŠ å¦‚ä¸‹é…ç½® { \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://registry.docker-cn.com\u0026#34;] } ","title":"docker åŠ é€Ÿ"},{"content":"docker ç®¡ç†å·¥å…· Portainer webæœåŠ¡\ndocker volume create portainer_data docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer ","permalink":"https://26huitailang.github.io/posts/docker/%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/","summary":"docker ç®¡ç†å·¥å…· Portainer webæœåŠ¡\ndocker volume create portainer_data docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer ","title":"docker ç®¡ç†å·¥å…·"},{"content":"docker é˜¿é‡Œäº‘ä»“åº“ ç™»å½•é˜¿é‡Œäº‘Docker Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com ç”¨äºç™»å½•çš„ç”¨æˆ·åä¸ºé˜¿é‡Œäº‘è´¦å·å…¨åï¼Œå¯†ç ä¸ºå¼€é€šæœåŠ¡æ—¶è®¾ç½®çš„å¯†ç ã€‚\næ‚¨å¯ä»¥åœ¨äº§å“æ§åˆ¶å°é¦–é¡µä¿®æ”¹ç™»å½•å¯†ç ã€‚\né‡åˆ°æ— æ³•ç™»å½•é—®é¢˜ï¼š\nError saving credentials: error storing credentials - err: exit status 1, out: `The name org.freedesktop.secrets was not provided by any .service files sudo apt install gnupg2 pass ä»Registryä¸­æ‹‰å–é•œåƒ $ sudo docker pull registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·]\nå°†é•œåƒæ¨é€åˆ°Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com $ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·] $ sudo docker push registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·] è¯·æ ¹æ®å®é™…é•œåƒä¿¡æ¯æ›¿æ¢ç¤ºä¾‹ä¸­çš„[ImageId]å’Œ[é•œåƒç‰ˆæœ¬å·]å‚æ•°ã€‚\né€‰æ‹©åˆé€‚çš„é•œåƒä»“åº“åœ°å€ ä»ECSæ¨é€é•œåƒæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é•œåƒä»“åº“å†…ç½‘åœ°å€ã€‚æ¨é€é€Ÿåº¦å°†å¾—åˆ°æå‡å¹¶ä¸”å°†ä¸ä¼šæŸè€—æ‚¨çš„å…¬ç½‘æµé‡ã€‚\nå¦‚æœæ‚¨ä½¿ç”¨çš„æœºå™¨ä½äºVPCç½‘ç»œï¼Œè¯·ä½¿ç”¨ registry-vpc.cn-hangzhou.aliyuncs.com ä½œä¸ºRegistryçš„åŸŸåç™»å½•ï¼Œå¹¶ä½œä¸ºé•œåƒå‘½åç©ºé—´å‰ç¼€ã€‚\nç¤ºä¾‹ ä½¿ç”¨\u0026quot;docker tag\u0026quot;å‘½ä»¤é‡å‘½åé•œåƒï¼Œå¹¶å°†å®ƒé€šè¿‡ä¸“æœ‰ç½‘ç»œåœ°å€æ¨é€è‡³Registryã€‚\n$ sudo docker images REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE registry.aliyuncs.com/acs/agent 0.7-dfb6816 37bb9c63c8b2 7 days ago 37.89 MB $ sudo docker tag 37bb9c63c8b2 registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816 ä½¿ç”¨\u0026quot;docker images\u0026quot;å‘½ä»¤æ‰¾åˆ°é•œåƒï¼Œå°†è¯¥é•œåƒåç§°ä¸­çš„åŸŸåéƒ¨åˆ†å˜æ›´ä¸ºRegistryä¸“æœ‰ç½‘ç»œåœ°å€ã€‚\n$ sudo docker push registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816 ","permalink":"https://26huitailang.github.io/posts/docker/%E9%98%BF%E9%87%8C%E4%BA%91%E4%BB%93%E5%BA%93/","summary":"docker é˜¿é‡Œäº‘ä»“åº“ ç™»å½•é˜¿é‡Œäº‘Docker Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com ç”¨äºç™»å½•çš„ç”¨æˆ·åä¸ºé˜¿é‡Œäº‘è´¦å·å…¨åï¼Œå¯†ç ä¸ºå¼€é€šæœåŠ¡æ—¶è®¾ç½®çš„å¯†ç ã€‚\næ‚¨å¯ä»¥åœ¨äº§å“æ§åˆ¶å°é¦–é¡µä¿®æ”¹ç™»å½•å¯†ç ã€‚\né‡åˆ°æ— æ³•ç™»å½•é—®é¢˜ï¼š\nError saving credentials: error storing credentials - err: exit status 1, out: `The name org.freedesktop.secrets was not provided by any .service files sudo apt install gnupg2 pass ä»Registryä¸­æ‹‰å–é•œåƒ $ sudo docker pull registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·]\nå°†é•œåƒæ¨é€åˆ°Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com $ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·] $ sudo docker push registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·] è¯·æ ¹æ®å®é™…é•œåƒä¿¡æ¯æ›¿æ¢ç¤ºä¾‹ä¸­çš„[ImageId]å’Œ[é•œåƒç‰ˆæœ¬å·]å‚æ•°ã€‚\né€‰æ‹©åˆé€‚çš„é•œåƒä»“åº“åœ°å€ ä»ECSæ¨é€é•œåƒæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é•œåƒä»“åº“å†…ç½‘åœ°å€ã€‚æ¨é€é€Ÿåº¦å°†å¾—åˆ°æå‡å¹¶ä¸”å°†ä¸ä¼šæŸè€—æ‚¨çš„å…¬ç½‘æµé‡ã€‚\nå¦‚æœæ‚¨ä½¿ç”¨çš„æœºå™¨ä½äºVPCç½‘ç»œï¼Œè¯·ä½¿ç”¨ registry-vpc.cn-hangzhou.aliyuncs.com ä½œä¸ºRegistryçš„åŸŸåç™»å½•ï¼Œå¹¶ä½œä¸ºé•œåƒå‘½åç©ºé—´å‰ç¼€ã€‚","title":"docker é˜¿é‡Œäº‘ä»“åº“"},{"content":"ansible ref quick-start æµç¨‹ ç¯å¢ƒå‡†å¤‡ åˆ›å»ºä¸‰ä¸ªè™šæ‹Ÿæœº, ansible(å®‰è£… ansible çš„æœºå™¨), vm1, vm2\nä½¿ç”¨ ssh-keygen ç”Ÿæˆå…¬ç§é’¥\nssh-copy-id name@host é…ç½®å…å¯†ç™»é™†\nå®‰è£… ansible\n$ apt install -y ansible\né…ç½® âœ ~ pwd /root âœ ~ cat ansible.cfg [defaults] inventory = $HOME/hosts âœ ~ cat hosts [webservers] vm1 [dbservers] vm2 âœ ~ cat /etc/hosts 127.0.0.1\tlocalhost 127.0.1.1\tansible.ansible\tansible # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters # ansible 10.200.233.81 vm1 vm1.ansible.host 10.200.233.82 vm2 vm2.ansible.host æŸ¥çœ‹ hosts\n$ ansible all \u0026ndash;list-hosts\nping hosts\n$ ansible all -m ping\nmodules å„ä¸ª module æ–‡æ¡£\næŸ¥çœ‹ modules\n$ ansible-doc -l | wc -l 2078\ncopy module ä½¿ç”¨\n$ ansible all -m copy -a \u0026lsquo;src=test.txt dest=/opt/test.txt owner=root group=root mode=0644\u0026rsquo; -b\næŸ¥çœ‹æ–‡æ¡£\n$ ansible-doc copy\nplaybooks å¯é‡å¤å¯¹å¤šä¸ª hosts ä½¿ç”¨çš„æ“ä½œ.\næ‰§è¡Œä¸€ä¸ª playbook\n$ ansible-playbook myplaybook.yml\nè¯­æ³•æ£€æŸ¥\n$ ansible-playbook \u0026ndash;syntax-check myplaybook.yml\næµ‹è¯•ä½†ä¸å®é™…è¿è¡Œ(dryrun)\n$ ansible-playbook \u0026ndash;check myplaybook.yml\né€æ­¥æ‰§è¡Œ,äº¤äº’å¼çš„ç¡®è®¤\n$ ansible-playbook \u0026ndash;step myplaybook.yml\ngalaxy ansible-galaxy collection install community.docker # offline ansible-galaxy collection download community.docker ansible-galaxy collection install \u0026lt;ä¸‹è½½çš„æ–‡ä»¶\u0026gt; python3 æ”¯æŒ docs å’Œ vagrant ä¸€èµ·ä½¿ç”¨ éœ€è¦ vagrant çš„ host å®‰è£…äº† ansible ","permalink":"https://26huitailang.github.io/posts/ansible/ansible/","summary":"ansible ref quick-start æµç¨‹ ç¯å¢ƒå‡†å¤‡ åˆ›å»ºä¸‰ä¸ªè™šæ‹Ÿæœº, ansible(å®‰è£… ansible çš„æœºå™¨), vm1, vm2\nä½¿ç”¨ ssh-keygen ç”Ÿæˆå…¬ç§é’¥\nssh-copy-id name@host é…ç½®å…å¯†ç™»é™†\nå®‰è£… ansible\n$ apt install -y ansible\né…ç½® âœ ~ pwd /root âœ ~ cat ansible.cfg [defaults] inventory = $HOME/hosts âœ ~ cat hosts [webservers] vm1 [dbservers] vm2 âœ ~ cat /etc/hosts 127.0.0.1\tlocalhost 127.0.1.1\tansible.ansible\tansible # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters # ansible 10.","title":""},{"content":"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\n","permalink":"https://26huitailang.github.io/posts/docker/dockerfile-best-practice/","summary":"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/","title":""},{"content":"Cheatsheet for package manager go mod pip apt ubuntu 20.04 pip pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package\nå‡çº§ pip åˆ°æœ€æ–°çš„ç‰ˆæœ¬ (\u0026gt;=10.0.0) åè¿›è¡Œé…ç½®ï¼š\npip install pip -U pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple\nå¦‚æœæ‚¨åˆ° pip é»˜è®¤æºçš„ç½‘ç»œè¿æ¥è¾ƒå·®ï¼Œä¸´æ—¶ä½¿ç”¨æœ¬é•œåƒç«™æ¥å‡çº§ pipï¼š\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U\napt ubuntu 20.04\n# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨ # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse go mod GOPROXY=https://goproxy.io,direct\ngo mod init github.com/26huitailang/\u0026lt;PROJECTNAME\u0026gt; go mod vendor ","permalink":"https://26huitailang.github.io/posts/cheatsheet/pkg-manager/","summary":"Cheatsheet for package manager go mod pip apt ubuntu 20.04 pip pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package\nå‡çº§ pip åˆ°æœ€æ–°çš„ç‰ˆæœ¬ (\u0026gt;=10.0.0) åè¿›è¡Œé…ç½®ï¼š\npip install pip -U pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple\nå¦‚æœæ‚¨åˆ° pip é»˜è®¤æºçš„ç½‘ç»œè¿æ¥è¾ƒå·®ï¼Œä¸´æ—¶ä½¿ç”¨æœ¬é•œåƒç«™æ¥å‡çº§ pipï¼š\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U\napt ubuntu 20.04\n# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse # deb-src https://mirrors.","title":"Cheatsheet for pkg manager"},{"content":"Cobra å‘½ä»¤è¡Œ å› ä¸ºä¹‹å‰å†™ Djangoï¼Œpython manage.pyè¿™ä¸ªå‘½ä»¤éå¸¸å¥½ç”¨ï¼Œæƒ³çœ‹çœ‹èƒ½ä¸èƒ½å®ç°ç±»ä¼¼çš„æ•ˆæœã€‚æœç´¢ä¹‹åå‘ç°äº†æ›´å¼ºçš„cobraï¼Œçœ‹ç®€ä»‹ä¸­ä½¿ç”¨çš„é¡¹ç›®å°±çŸ¥é“éå¸¸ä¸é”™ã€‚ä»£ç ç»„ç»‡å‚è€ƒçš„frpçš„ã€‚\nPATH/frp/cmdï¼Œfrpcå’Œfprsåˆ†åˆ«æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯\nâ”œâ”€â”€â”€frpc â”‚ â”‚ main.go â”‚ â”‚ â”‚ â””â”€â”€â”€sub â”‚ http.go â”‚ https.go â”‚ reload.go â”‚ root.go â”‚ status.go â”‚ stcp.go â”‚ sudp.go â”‚ tcp.go â”‚ tcpmux.go â”‚ udp.go â”‚ xtcp.go â”‚ â””â”€â”€â”€frps main.go root.go æ·»åŠ  go get -u github.com/spf13/cobra/cobra åœ¨é¡¹ç›®ç›®å½•ä¸­æ‰§è¡Œï¼Œappname mycliï¼Œå…¶ä¸­cmdä¸­ rootCmd çš„åç§°æ˜¯mycliï¼Œè¿™é‡Œå»ºè®®å’Œappnameä¸€æ ·ï¼Œåé¢å¯ä»¥ç›´æ¥go installä¹‹åä½¿ç”¨mycliå³å¯ã€‚\nmkdir cmd \u0026amp;\u0026amp; cd cmd cobra init mycli --pkg-name mycli cmd â””â”€â”€â”€mycli â”‚ LICENSE â”‚ main.go â”‚ â””â”€â”€â”€cmd root.go æ¨¡æ¿ä»£ç  importé”™è¯¯ï¼Œé‡æ–°æŒ‰ç…§è‡ªå·±é¡¹ç›®çš„ç»„ç»‡æ–¹å¼é‡å†™ importå³å¯ã€‚\npackage main import \u0026#34;mycli/cmd\u0026#34; func main() { cmd.Execute() } æµ‹è¯•ä½¿ç”¨ï¼š\ngo run main.go æµ‹è¯•å®Œåï¼Œå¯ä»¥go installåˆ°ç³»ç»Ÿçš„è·¯å¾„é‡Œï¼Œç„¶åä½¿ç”¨å³å¯ï¼Œå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å‘å¸ƒä¹Ÿéå¸¸æ–¹ä¾¿ã€‚\nåµŒå¥—å‘½ä»¤è¡Œ mycli CMD SUBCMD å¢åŠ ç¬¬ä¸€çº§å‘½ä»¤\n\u0026gt; cobra add user \u0026gt; go run . user user called å¢åŠ userä¸‹çš„å…¶ä»–æŒ‡ä»¤\n\u0026gt; cobra add userAdd --parent userCmd \u0026gt; go run . user userAdd userAdd called ç°åœ¨ä»£ç çš„ç»“æ„\nmycli â”‚ LICENSE â”‚ main.go â”‚ â””â”€â”€â”€cmd root.go user.go userAdd.go æ¯ä¸€æ¬¡cobra addéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œ--parentæŒ‡å®šå‘½ä»¤å±äºå“ªä¸€ä¸ªï¼Œé»˜è®¤æ˜¯æ·»åŠ åˆ°rootCmdï¼š\nå¯ä»¥å°†cobraç”Ÿæˆçš„æ–‡ä»¶è‡ªå·±é‡æ„ï¼Œç§»åŠ¨åˆ°å¯¹åº”æ–‡ä»¶ä¸­ userAddè¿™ä¸ªæ˜¯æ–‡ä»¶åï¼Œä¹Ÿæ˜¯å‘½ä»¤åï¼Œåœ¨cmdçš„Useå±æ€§ä¸­å¯ä»¥ä¿®æ”¹ä¸ºaddï¼Œè¿™æ ·ä½¿ç”¨æ—¶mycli user add [flags] ç»“åˆåˆ°å·²æœ‰ç³»ç»Ÿä¸­ ä»¥web serverä¸ºä¾‹ï¼Œéƒ½ä¼šè®¾è®¡ä¸€ä¸ªNewServeræ–¹æ³•ï¼Œç„¶åå°è£…ä¸€ä¸ªæ‰§è¡Œæ–¹æ³•ï¼Œä»¥å‘½ä»¤ä¸ºå…¥å£æ‰§è¡Œå³å¯ï¼š\nmycli server // serverCmd represents the server command var serverCmd = \u0026amp;cobra.Command{ Use: \u0026#34;server\u0026#34;, Short: \u0026#34;A brief description of your command\u0026#34;, Long: `A longer description that spans multiple lines and likely contains examples and usage of using your command. For example: Cobra is a CLI library for Go that empowers applications. This application is a tool to generate the needed files to quickly create a Cobra application.`, Run: func(cmd *cobra.Command, args []string) { runServer() fmt.Println(\u0026#34;server called\u0026#34;) }, } func init() { rootCmd.AddCommand(serverCmd) // Here you will define your flags and configuration settings. // Cobra supports Persistent Flags which will work for this command // and all subcommands, e.g.: // serverCmd.PersistentFlags().String(\u0026#34;foo\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;A help for foo\u0026#34;) // Cobra supports local flags which will only run when this command // is called directly, e.g.: // serverCmd.Flags().BoolP(\u0026#34;toggle\u0026#34;, \u0026#34;t\u0026#34;, false, \u0026#34;Help message for toggle\u0026#34;) } func runServer() { e := server.NewServer() e.Logger.Fatal(e.Start(config.Config.Port)) } ","permalink":"https://26huitailang.github.io/posts/golang/cobra/","summary":"Cobra å‘½ä»¤è¡Œ å› ä¸ºä¹‹å‰å†™ Djangoï¼Œpython manage.pyè¿™ä¸ªå‘½ä»¤éå¸¸å¥½ç”¨ï¼Œæƒ³çœ‹çœ‹èƒ½ä¸èƒ½å®ç°ç±»ä¼¼çš„æ•ˆæœã€‚æœç´¢ä¹‹åå‘ç°äº†æ›´å¼ºçš„cobraï¼Œçœ‹ç®€ä»‹ä¸­ä½¿ç”¨çš„é¡¹ç›®å°±çŸ¥é“éå¸¸ä¸é”™ã€‚ä»£ç ç»„ç»‡å‚è€ƒçš„frpçš„ã€‚\nPATH/frp/cmdï¼Œfrpcå’Œfprsåˆ†åˆ«æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯\nâ”œâ”€â”€â”€frpc â”‚ â”‚ main.go â”‚ â”‚ â”‚ â””â”€â”€â”€sub â”‚ http.go â”‚ https.go â”‚ reload.go â”‚ root.go â”‚ status.go â”‚ stcp.go â”‚ sudp.go â”‚ tcp.go â”‚ tcpmux.go â”‚ udp.go â”‚ xtcp.go â”‚ â””â”€â”€â”€frps main.go root.go æ·»åŠ  go get -u github.com/spf13/cobra/cobra åœ¨é¡¹ç›®ç›®å½•ä¸­æ‰§è¡Œï¼Œappname mycliï¼Œå…¶ä¸­cmdä¸­ rootCmd çš„åç§°æ˜¯mycliï¼Œè¿™é‡Œå»ºè®®å’Œappnameä¸€æ ·ï¼Œåé¢å¯ä»¥ç›´æ¥go installä¹‹åä½¿ç”¨mycliå³å¯ã€‚\nmkdir cmd \u0026amp;\u0026amp; cd cmd cobra init mycli --pkg-name mycli cmd â””â”€â”€â”€mycli â”‚ LICENSE â”‚ main.go â”‚ â””â”€â”€â”€cmd root.go æ¨¡æ¿ä»£ç  importé”™è¯¯ï¼Œé‡æ–°æŒ‰ç…§è‡ªå·±é¡¹ç›®çš„ç»„ç»‡æ–¹å¼é‡å†™ importå³å¯ã€‚","title":"Cobra å‘½ä»¤è¡Œ"},{"content":"docker install install docker on Debian/Ubuntu\nlink\nUninstall old versions $ sudo apt-get remove docker docker-engine docker.io containerd runc Set up the repository $ sudo apt-get update $ sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common $ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - or $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add - $ sudo apt-key fingerprint 0EBFCD88 $ sudo add-apt-repository \\ \u0026#34;deb [arch=amd64] https://download.docker.com/linux/debian \\ $(lsb_release -cs) \\ stable\u0026#34; or sudo add-apt-repository \\ \u0026#34;deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ focal \\ stable\u0026#34; or $ sudo add-apt-repository \\ \u0026#34;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ \\ $(lsb_release -cs) \\ stable\u0026#34; Install Docker Engine $ sudo apt-get update $ sudo apt-get install docker-ce docker-ce-cli containerd.io $ sudo docker run --rm hello-world $ sudo apt install docker-compose -y Without sudo to use docker $ sudo usermod -aG docker $USER $ sudo systemctl restart docker $ sudo systemctl enable docker Speed up https://YOURS.mirror.aliyuncs.com\nsudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json \u0026lt;\u0026lt;-\u0026#39;EOF\u0026#39; { \u0026#34;registry-mirrors\u0026#34;: [ \u0026#34;https://registry.docker-cn.com\u0026#34;, \u0026#34;http://hub-mirror.c.163.com\u0026#34;, \u0026#34;https://docker.mirrors.ustc.edu.cn\u0026#34; ] } EOF sudo systemctl daemon-reload sudo systemctl restart docker ","permalink":"https://26huitailang.github.io/posts/docker/debian-docker-install/","summary":"docker install install docker on Debian/Ubuntu\nlink\nUninstall old versions $ sudo apt-get remove docker docker-engine docker.io containerd runc Set up the repository $ sudo apt-get update $ sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common $ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - or $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add - $ sudo apt-key fingerprint 0EBFCD88 $ sudo add-apt-repository \\ \u0026#34;deb [arch=amd64] https://download.","title":"docker install"},{"content":"Docker Private Registry ç®€å•ä½¿ç”¨ï¼Œå®˜æ–¹ å®˜æ–¹æä¾›çš„ https://hub.docker.com/_/registry\nRun a local registry: Quick Version\n$ docker run -d -p 5000:5000 --restart always --name registry registry:2 Now, use it from within Docker:\n$ docker pull ubuntu $ docker tag ubuntu localhost:5000/ubuntu $ docker push localhost:5000/ubuntu æ›´å¤æ‚çš„éœ€æ±‚ï¼Œharbor https://goharbor.io/\nOur mission is to be the trusted cloud native repository for Kubernetes\n","permalink":"https://26huitailang.github.io/posts/docker/%E7%A7%81%E6%9C%89registry/","summary":"Docker Private Registry ç®€å•ä½¿ç”¨ï¼Œå®˜æ–¹ å®˜æ–¹æä¾›çš„ https://hub.docker.com/_/registry\nRun a local registry: Quick Version\n$ docker run -d -p 5000:5000 --restart always --name registry registry:2 Now, use it from within Docker:\n$ docker pull ubuntu $ docker tag ubuntu localhost:5000/ubuntu $ docker push localhost:5000/ubuntu æ›´å¤æ‚çš„éœ€æ±‚ï¼Œharbor https://goharbor.io/\nOur mission is to be the trusted cloud native repository for Kubernetes","title":"Docker Private Registry"},{"content":"etcd å°è¯• vagrant # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :etcd1 =\u0026gt; \u0026#39;192.168.1.21\u0026#39;, :etcd2 =\u0026gt; \u0026#39;192.168.1.22\u0026#39;, :etcd3 =\u0026gt; \u0026#39;192.168.1.23\u0026#39; } Vagrant.configure(\u0026#34;2\u0026#34;) do |config| config.vm.box = \u0026#34;ubuntu/focal64\u0026#34; servers.each do |server_name, server_ip| config.vm.define server_name do |server_config| server_config.vm.hostname = \u0026#34;#{server_name.to_s}\u0026#34; server_config.vm.network :private_network, ip: server_ip server_config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.name = server_name.to_s if vb.name == \u0026#34;etcd1\u0026#34; vb.memory = 1024 vb.cpus = 1 else vb.memory = 1024 vb.cpus = 1 end end end end end install install.sh\nETCD_VER=v3.4.9 # choose either URL GOOGLE_URL=https://storage.googleapis.com/etcd GITHUB_URL=https://github.com/etcd-io/etcd/releases/download DOWNLOAD_URL=${GOOGLE_URL} rm -f /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz rm -rf /tmp/etcd-download-test \u0026amp;\u0026amp; mkdir -p /tmp/etcd-download-test curl -L ${DOWNLOAD_URL}/${ETCD_VER}/etcd-${ETCD_VER}-linux-amd64.tar.gz -o /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz tar xzvf /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz -C /tmp/etcd-download-test --strip-components=1 rm -f /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz /tmp/etcd-download-test/etcd --version /tmp/etcd-download-test/etcdctl version cluster.sh\ninfra0/1/2 192.168.1.21-23 /tmp/etcd-download-test/etcd --name infra1 --initial-advertise-peer-urls http://192.168.1.22:2380 \\ --listen-peer-urls http://192.168.1.22:2380 \\ --listen-client-urls http://192.168.1.22:2379,http://127.0.0.1:2379 \\ --advertise-client-urls http://192.168.1.22:2379 \\ --initial-cluster-token etcd-cluster-1 \\ --initial-cluster infra0=http://192.168.1.21:2380,infra1=http://192.168.1.22:2380,infra2=http://192.168.1.23:2380 \\ --initial-cluster-state new /tmp/etcd-download-test/etcdctl put mykey \u0026ldquo;this is awesome\u0026rdquo; /tmp/etcd-download-test/etcdctl get mykey\n","permalink":"https://26huitailang.github.io/posts/etcd/readme/","summary":"etcd å°è¯• vagrant # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :etcd1 =\u0026gt; \u0026#39;192.168.1.21\u0026#39;, :etcd2 =\u0026gt; \u0026#39;192.168.1.22\u0026#39;, :etcd3 =\u0026gt; \u0026#39;192.168.1.23\u0026#39; } Vagrant.configure(\u0026#34;2\u0026#34;) do |config| config.vm.box = \u0026#34;ubuntu/focal64\u0026#34; servers.each do |server_name, server_ip| config.vm.define server_name do |server_config| server_config.vm.hostname = \u0026#34;#{server_name.to_s}\u0026#34; server_config.vm.network :private_network, ip: server_ip server_config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.name = server_name.to_s if vb.name == \u0026#34;etcd1\u0026#34; vb.memory = 1024 vb.cpus = 1 else vb.memory = 1024 vb.cpus = 1 end end end end end install install.","title":"etcd å°è¯•"},{"content":"github, A modern Python package manager with PEP 582 support.\nä»…åœ¨__pypackages__/\u0026lt;major.minor\u0026gt;åŒ…å«å¿…è¦çš„ä¾èµ–å’Œbinæ–‡ä»¶ï¼Œæ²¡æœ‰è§£é‡Šå™¨ç›¸å…³æ–‡ä»¶ å°±ç®—pythonè§£é‡Šå™¨è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯åªè¦æœ‰å…¶ä»–ç¬¦åˆpyproject.yomlè§„å®šç‰ˆæœ¬çš„è§£é‡Šå™¨å³å¯ï¼Œé¡¹ç›®ç›®å½•ä¸‹çš„__pypackages__ä¸åŒ…å«è§£é‡Šå™¨ç›¸å…³çš„å†…å®¹ï¼Œvenvåˆ™å¿…é¡»é‡æ–°å…³è”æˆ–è€…é‡æ–°åˆ›å»º $ tree -L 3 __pypackages__ __pypackages__ â””â”€â”€ 3.10 â”œâ”€â”€ bin â”‚ â”œâ”€â”€ django-admin â”‚ â””â”€â”€ sqlformat â”œâ”€â”€ include â””â”€â”€ lib â”œâ”€â”€ Django-4.0.1.dist-info â”œâ”€â”€ anyio â”œâ”€â”€ anyio-3.5.0.dist-info â”œâ”€â”€ asgiref â”œâ”€â”€ asgiref-3.4.1.dist-info â”œâ”€â”€ django ... install brew install pdm demo mkdir pdm-demo cd pdm-demo pdm init Creating a pyproject.toml for PDM... Please enter the Python interpreter to use ... 12. /usr/local/Cellar/pdm/1.12.2/libexec/bin/python3.10 (3.10) Please select: [0]: 12 Using Python interpreter: /usr/local/Cellar/pdm/1.12.2/libexec/bin/python3.10 (3.10) Is the project a library that will be uploaded to PyPI? [y/N]: N License(SPDX name) [MIT]: Author name [26huitailang]: Author email [26huitailang@gmail.com]: Python requires(\u0026#39;*\u0026#39; to allow any) [\u0026gt;=3.10]: Changes are written to pyproject.toml. PDM 1.12.2 is installed, while 1.12.6 is available. Please run $ brew upgrade pdm to upgrade. Run $ pdm config check_update false to disable the check. init files\n~/git-checkout/pdm-demo âŒš 10:38:57 $ la total 16 -rw-r--r-- 1 26huitailang staff 70B Jan 12 10:37 .pdm.toml -rw-r--r-- 1 26huitailang staff 321B Jan 12 10:38 pyproject.toml .pdm.toml python è·¯å¾„ä¿¡æ¯ pyproject.toml project info tool info build-system æ·»åŠ åŒ…ï¼Œä¼šæ›´æ–°pyproject.tomlä¸‹é¢çš„dependencies\n$ pdm add django Adding packages to default dependencies: django âœ” ğŸ”’ Lock successful Changes are written to pdm.lock. Changes are written to pyproject.toml. Synchronizing working set with lock file: 3 to add, 0 to update, 0 to remove âœ” Install asgiref 3.4.1 successful âœ” Install django 4.0.1 successful âœ” Install sqlparse 0.4.2 successful ğŸ‰ All complete! PDM 1.12.2 is installed, while 1.12.6 is available. Please run $ brew upgrade pdm to upgrade. Run $ pdm config check_update false to disable the check. ä½¿ç”¨pdmå®šä¹‰çš„ç¯å¢ƒè¿è¡Œ\npdm run django-admin -h é…ç½®ä¿®æ”¹ï¼Œä¿®æ”¹pypiæº\npdm config pypi.url https://pypi.tuna.tsinghua.edu.cn/simple use with ide https://pdm.fming.dev/#use-with-ide\npycharm æ”¯æŒä¸å®Œå–„ï¼Œæ¯”å¦‚Djangoï¼Œæ·»åŠ äº†PATHå run/debug configurationä¸èƒ½æ­£ç¡®è¯†åˆ«ï¼Œéœ€è¦ç‚¹å‡»continue anywayæ‰èƒ½è¿è¡Œdjango serverï¼Œä½†æ˜¯æœ€æ–°ç‰ˆæœ¬é»˜è®¤æ”¯æŒpoetryå’Œpipenvï¼Œç­‰å¾…åç»­æ”¯æŒpep582/pdm ","permalink":"https://26huitailang.github.io/posts/python/pdm/","summary":"github, A modern Python package manager with PEP 582 support.\nä»…åœ¨__pypackages__/\u0026lt;major.minor\u0026gt;åŒ…å«å¿…è¦çš„ä¾èµ–å’Œbinæ–‡ä»¶ï¼Œæ²¡æœ‰è§£é‡Šå™¨ç›¸å…³æ–‡ä»¶ å°±ç®—pythonè§£é‡Šå™¨è¢«åˆ é™¤äº†ï¼Œä½†æ˜¯åªè¦æœ‰å…¶ä»–ç¬¦åˆpyproject.yomlè§„å®šç‰ˆæœ¬çš„è§£é‡Šå™¨å³å¯ï¼Œé¡¹ç›®ç›®å½•ä¸‹çš„__pypackages__ä¸åŒ…å«è§£é‡Šå™¨ç›¸å…³çš„å†…å®¹ï¼Œvenvåˆ™å¿…é¡»é‡æ–°å…³è”æˆ–è€…é‡æ–°åˆ›å»º $ tree -L 3 __pypackages__ __pypackages__ â””â”€â”€ 3.10 â”œâ”€â”€ bin â”‚ â”œâ”€â”€ django-admin â”‚ â””â”€â”€ sqlformat â”œâ”€â”€ include â””â”€â”€ lib â”œâ”€â”€ Django-4.0.1.dist-info â”œâ”€â”€ anyio â”œâ”€â”€ anyio-3.5.0.dist-info â”œâ”€â”€ asgiref â”œâ”€â”€ asgiref-3.4.1.dist-info â”œâ”€â”€ django ... install brew install pdm demo mkdir pdm-demo cd pdm-demo pdm init Creating a pyproject.toml for PDM... Please enter the Python interpreter to use ... 12. /usr/local/Cellar/pdm/1.","title":"pdm"},{"content":"pip ç¦»çº¿å®‰è£… æ‰“åŒ… æ³¨æ„ï¼Œè¦åœ¨åŒå¹³å°æ‰“åŒ…ï¼Œå¦åˆ™æœ‰äº›åŒ…ä¸èƒ½æ­£ç¡®å®‰è£…ã€‚\nåœ¨å·²æœ‰çš„ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š\npip freeze \u0026gt; pip-requirements.txt pip download -d pip-packages -r pip-requirements.txtï¼Œå°†æå–çš„åŒ…ä¸‹è½½åˆ°pip-packagesæ–‡ä»¶å¤¹ä¸­ å®‰è£… å°†pip-requirements.txtå’Œpip-packagesæ–‡ä»¶å¤¹ï¼Œæ‹·è´åˆ°ç›®æ ‡ç¯å¢ƒçš„åŒç›®å½•ä¸‹ pip install \u0026ndash;no-index \u0026ndash;find-links=pip-packages -r pip-requirements.txt å‚è€ƒ æ–­ç½‘ç¯å¢ƒä¸‹ä¸€é”®å®‰è£… python3 ç¦»çº¿å®‰è£…åŒ…åŠå…¶ä¾èµ– ä¸‹è½½ä¾èµ– pip-download\nexample\npip install pip-download pip-download -p win_amd64 -p none-any fabric ","permalink":"https://26huitailang.github.io/posts/python/pip/%E6%89%93%E5%8C%85%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85/","summary":"pip ç¦»çº¿å®‰è£… æ‰“åŒ… æ³¨æ„ï¼Œè¦åœ¨åŒå¹³å°æ‰“åŒ…ï¼Œå¦åˆ™æœ‰äº›åŒ…ä¸èƒ½æ­£ç¡®å®‰è£…ã€‚\nåœ¨å·²æœ‰çš„ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š\npip freeze \u0026gt; pip-requirements.txt pip download -d pip-packages -r pip-requirements.txtï¼Œå°†æå–çš„åŒ…ä¸‹è½½åˆ°pip-packagesæ–‡ä»¶å¤¹ä¸­ å®‰è£… å°†pip-requirements.txtå’Œpip-packagesæ–‡ä»¶å¤¹ï¼Œæ‹·è´åˆ°ç›®æ ‡ç¯å¢ƒçš„åŒç›®å½•ä¸‹ pip install \u0026ndash;no-index \u0026ndash;find-links=pip-packages -r pip-requirements.txt å‚è€ƒ æ–­ç½‘ç¯å¢ƒä¸‹ä¸€é”®å®‰è£… python3 ç¦»çº¿å®‰è£…åŒ…åŠå…¶ä¾èµ– ä¸‹è½½ä¾èµ– pip-download\nexample\npip install pip-download pip-download -p win_amd64 -p none-any fabric ","title":"pip ç¦»çº¿å®‰è£…"},{"content":"pipenv pipå’Œvirtualenvçš„ç»„åˆï¼Œä½¿ç”¨Pipfileæ¥æ›¿æ¢æ—§çš„requirements.txtæ–¹å¼ã€‚\ndocumentation zhihu å‚è€ƒ segmentfault å‚è€ƒ å®‰è£… å®‰è£…åˆ°ç³»ç»Ÿå¸¸ç”¨çš„pythonç‰ˆæœ¬ä¸‹ï¼Œmacå¯ä»¥ä½¿ç”¨brewå®‰è£…\n$ pip install pipenv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ $ pipenv install --three django åˆ›å»ºä¸€ä¸ªpython3çš„è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…djangoï¼Œéšæœºç”Ÿæˆä¸€ä¸ªå’Œå½“å‰æ–‡ä»¶å¤¹åæœ‰å…³çš„è™šæ‹Ÿç¯å¢ƒã€‚ä¹Ÿå¯ä»¥ç”¨è¿‡--python 3.7æŒ‡å®špythonç‰ˆæœ¬ã€‚\nTODOï¼Œ ä¸èƒ½æŒ‡å®šåç§°å—ï¼Ÿ è¿›å…¥è™šæ‹Ÿç¯å¢ƒ $ pipenv shell ä¸è¿‡å°±ç®—ä¸è¿›å…¥ç¯å¢ƒï¼Œpipenv installä¾ç„¶å¯ä»¥æ­£ç¡®å®‰è£…åŒ…åˆ°å¯¹åº”çš„ç¯å¢ƒã€‚\næ–°ç¯å¢ƒä¾èµ– è‡ªåŠ¨è¯†åˆ«Pipfileï¼Œç„¶åå®‰è£…ã€‚\n$ pipenv install ä¸€å¹¶å®‰è£…å¼€å‘ç¯å¢ƒçš„åŒ…ï¼š\n$ pipenv install --dev åŒºåˆ«å¼€å‘ç¯å¢ƒ åœ¨å®‰è£…åŒ…çš„æ—¶å€™æ·»åŠ ä¸€ä¸ª--devé€‰é¡¹ï¼Œä¼šåˆ†ç±»åˆ°å¼€å‘ä¾èµ–ã€‚\næ›´æ¢æº æ›´æ¢Pipfileä¸­çš„source-url\n[[source]] url = \u0026quot;https://mirrors.aliyun.com/pypi/simple\u0026quot; verify_ssl = true name = \u0026quot;pypi\u0026quot; è®¾ç½®ç¯å¢ƒå˜é‡ PIPENV_PYPI_MIRROR æ•ˆæœç›¸åŒã€‚ç±»ä¼¼æŒ‡å®š\u0026ndash;pypi-mirroré€‰é¡¹ï¼š\n$ pipenv install --pypi-mirror https://mirrors.aliyun.com/pypi/simple æŸ¥çœ‹å®‰è£…çš„åŒ… $ pipenv graph ä¸ä»…å¯ä»¥çœ‹åˆ°å®‰è£…åŒ…ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ä¾èµ–å…³ç³»ã€‚\nDjango==2.1.7 - pytz [required: Any, installed: 2018.9] psutil==5.5.1 Pipfile æ›¿æ¢äº†æº æœ‰å¼€å‘ç¯å¢ƒçš„åŒ… dev-packages python ç‰ˆæœ¬3.6 [[source]] name = \u0026#34;pypi\u0026#34; url = \u0026#34;https://mirrors.aliyun.com/pypi/simple\u0026#34; verify_ssl = true [dev-packages] pytest = \u0026#34;*\u0026#34; [packages] psutil = \u0026#34;*\u0026#34; django = \u0026#34;*\u0026#34; [requires] python_version = \u0026#34;3.6\u0026#34; ","permalink":"https://26huitailang.github.io/posts/python/pip/pipenv/","summary":"pipenv pipå’Œvirtualenvçš„ç»„åˆï¼Œä½¿ç”¨Pipfileæ¥æ›¿æ¢æ—§çš„requirements.txtæ–¹å¼ã€‚\ndocumentation zhihu å‚è€ƒ segmentfault å‚è€ƒ å®‰è£… å®‰è£…åˆ°ç³»ç»Ÿå¸¸ç”¨çš„pythonç‰ˆæœ¬ä¸‹ï¼Œmacå¯ä»¥ä½¿ç”¨brewå®‰è£…\n$ pip install pipenv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ $ pipenv install --three django åˆ›å»ºä¸€ä¸ªpython3çš„è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…djangoï¼Œéšæœºç”Ÿæˆä¸€ä¸ªå’Œå½“å‰æ–‡ä»¶å¤¹åæœ‰å…³çš„è™šæ‹Ÿç¯å¢ƒã€‚ä¹Ÿå¯ä»¥ç”¨è¿‡--python 3.7æŒ‡å®špythonç‰ˆæœ¬ã€‚\nTODOï¼Œ ä¸èƒ½æŒ‡å®šåç§°å—ï¼Ÿ è¿›å…¥è™šæ‹Ÿç¯å¢ƒ $ pipenv shell ä¸è¿‡å°±ç®—ä¸è¿›å…¥ç¯å¢ƒï¼Œpipenv installä¾ç„¶å¯ä»¥æ­£ç¡®å®‰è£…åŒ…åˆ°å¯¹åº”çš„ç¯å¢ƒã€‚\næ–°ç¯å¢ƒä¾èµ– è‡ªåŠ¨è¯†åˆ«Pipfileï¼Œç„¶åå®‰è£…ã€‚\n$ pipenv install ä¸€å¹¶å®‰è£…å¼€å‘ç¯å¢ƒçš„åŒ…ï¼š\n$ pipenv install --dev åŒºåˆ«å¼€å‘ç¯å¢ƒ åœ¨å®‰è£…åŒ…çš„æ—¶å€™æ·»åŠ ä¸€ä¸ª--devé€‰é¡¹ï¼Œä¼šåˆ†ç±»åˆ°å¼€å‘ä¾èµ–ã€‚\næ›´æ¢æº æ›´æ¢Pipfileä¸­çš„source-url\n[[source]] url = \u0026quot;https://mirrors.aliyun.com/pypi/simple\u0026quot; verify_ssl = true name = \u0026quot;pypi\u0026quot; è®¾ç½®ç¯å¢ƒå˜é‡ PIPENV_PYPI_MIRROR æ•ˆæœç›¸åŒã€‚ç±»ä¼¼æŒ‡å®š\u0026ndash;pypi-mirroré€‰é¡¹ï¼š\n$ pipenv install --pypi-mirror https://mirrors.aliyun.com/pypi/simple æŸ¥çœ‹å®‰è£…çš„åŒ… $ pipenv graph ä¸ä»…å¯ä»¥çœ‹åˆ°å®‰è£…åŒ…ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ä¾èµ–å…³ç³»ã€‚\nDjango==2.1.7 - pytz [required: Any, installed: 2018.","title":"pipenv"},{"content":"PostgreSQL åˆ†è¡¨ ç»§æ‰¿å®ç°æ›´çµæ´»ï¼Œå¯ä»¥ç›´æ¥åœ¨å·²æœ‰æ•°æ®çš„è¡¨ä¸Šå®ç°ï¼Œä¸ç”¨é‡æ–°è¿ç§»ã€‚\n-- https://www.postgresql.org/docs/current/ddl-partitioning.html -- zh -- http://postgres.cn/docs/11/ddl-partitioning.html -- keyword: further redirect -- å·²æœ‰æ•°æ®åˆ†è¡¨ï¼Œå› ä¸ºä¸»è¡¨ä¸èƒ½æœ‰æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å…ˆå¤‡ä»½ï¼Œåˆ›å»ºåˆ†è¡¨å’Œè§„åˆ™å®Œæ¯•åé‡æ–°æ’å…¥ -- æˆ–è€…ç”¨æ–°çš„è¡¨åï¼Œä¹‹åå†åˆ†æ‰¹è¯»å–æ’å…¥ -- åˆ›å»ºä¸»è¡¨ CREATE TABLE measurement ( city_id int not null, logdate date not null, peaktemp int, unitsales int ) PARTITION BY RANGE (logdate); -- åˆ›å»ºåˆ†è¡¨åŠè§„åˆ™ -- è¿˜å¯ä»¥é€šè¿‡partition by å†æ¬¡åˆ›å»ºsub-partitioningï¼Œå¯¹æ’å…¥measurement_y2006m02çš„æ•°æ®å†æ¬¡é‡å®šå‘ -- CREATE TABLE measurement_y2006m02 PARTITION OF measurement -- FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;) -- PARTITION BY RANGE (peaktemp); CREATE TABLE measurement_y2006m02 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;); CREATE TABLE measurement_y2006m03 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-03-01\u0026#39;) TO (\u0026#39;2006-04-01\u0026#39;); -- åˆ›å»ºç´¢å¼•ï¼Œè‡ªåŠ¨å†æ¯ä¸ªåˆ†åŒºä¸Šåˆ›å»ºç´¢å¼• CREATE INDEX ON measurement (logdate); -- Ensure that the enable_partition_pruning configuration parameter is not disabled in postgresql.conf. If it is, queries will not be optimized as desired. -- test INSERT INTO measurement (city_id, logdate, peaktemp, unitsales) VALUES (1, \u0026#39;2008-2-1\u0026#39;, 1, 1); INSERT INTO measurement (city_id, logdate, peaktemp, unitsales) VALUES (1, \u0026#39;2006-2-1\u0026#39;, 1, 1); ---- ç»´æŠ¤ ---- -- åˆ é™¤åˆ†è¡¨ï¼Œå¯ä»¥å¿«é€Ÿåˆ é™¤ç™¾ä¸‡æ•°æ®ï¼Œä½†æ˜¯éœ€è¦çˆ¶è¡¨çš„ ACCESS EXCLUSIVE é” DROP TABLE measurement_y2006m02; -- æ›´å¥½çš„å¤„ç†æ–¹å¼ï¼Œå°†åˆ†è¡¨ä»ä¸»è¡¨ä¸­åˆ†ç¦»ï¼Œä»¥å•ç‹¬çš„å½¢å¼å­˜åœ¨ -- This allows further operations to be performed on the data before it is dropped. For example, this is often a useful time to back up the data using COPY, pg_dump, or similar tools. It might also be a useful time to aggregate data into smaller formats, perform other data manipulations, or run reports. ALTER TABLE measurement DETACH PARTITION measurement_y2006m02; -- åœ¨æ–°çš„è‡ªç›˜ç©ºé—´ç”³æ˜ï¼Œä¸€èˆ¬æ˜¯ç”¨äºæŠŠé‡è¦æ•°æ®æ”¾åœ¨å¯é å¿«é€Ÿç£ç›˜ï¼Œå°†æ—¥å¿—å‹ç­‰æ•°æ®æ”¾äºæ™®é€šç£ç›˜ -- CREATE TABLE measurement_y2008m02 PARTITION OF measurement -- FOR VALUES FROM (\u0026#39;2008-02-01\u0026#39;) TO (\u0026#39;2008-03-01\u0026#39;) -- TABLESPACE fasttablespace; -- åˆ†åŒºè¡¨æœ‰ä¸‹åˆ—é™åˆ¶ï¼š -- -- æ²¡æœ‰åŠæ³•åˆ›å»ºè·¨è¶Šæ‰€æœ‰åˆ†åŒºçš„æ’é™¤çº¦æŸï¼Œåªå¯èƒ½å•ä¸ªçº¦æŸæ¯ä¸ªå¶å­åˆ†åŒºã€‚ -- -- è™½ç„¶åœ¨åˆ†åŒºè¡¨ä¸Šæ”¯æŒä¸»é”®ï¼Œä½†å¼•ç”¨åˆ†åŒºè¡¨çš„å¤–é”®ä¸å—æ”¯æŒï¼ˆä½†æ”¯æŒä»åˆ†åŒºè¡¨åˆ°æŸä¸ªå…¶ä»–è¡¨çš„å¤–é”®å¼•ç”¨ï¼‰ã€‚ -- -- å½“ä¸€ä¸ªUPDATEå¯¼è‡´ä¸€è¡Œä»ä¸€ä¸ªåˆ†åŒºç§»åŠ¨åˆ°å¦ä¸€ä¸ªåˆ†åŒºæ—¶ï¼Œå¦ä¸€ä¸ªå¹¶å‘çš„UPDATEæˆ–DELETEå¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªä¸²è¡ŒåŒ–é”™è¯¯ã€‚å‡è®¾ä¼šè¯1æ­£åœ¨æ‰§è¡Œä¸€ä¸ªåˆ†åŒºé”®ä¸Šçš„UPDATEï¼ŒåŒæ—¶ä¸€ä¸ªå¹¶å‘çš„èƒ½çœ‹è§è¿™ä¸ªè¡Œçš„ä¼šè¯2æ‰§è¡Œäº†å¯¹è¯¥è¡Œçš„UPDATEæˆ–è€…DELETEæ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šè¯2çš„UPDATEæˆ–è€…DELETEä¼šæ£€æµ‹åˆ°è¡Œçš„ç§»åŠ¨ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªä¸²è¡ŒåŒ–çš„é”™è¯¯(å°†æ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ªSQLSTATE \u0026#39;40001\u0026#39;)ã€‚ å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å¸Œæœ›é‡è¯•è¯¥äº‹åŠ¡ã€‚ åœ¨æ²¡æœ‰åˆ†åŒºè¡¨æˆ–æ²¡æœ‰è¡Œç§»åŠ¨çš„é€šå¸¸æƒ…å†µä¸‹ï¼Œ ä¼šè¯2å°†è¯†åˆ«æ–°æ›´æ–°çš„è¡Œå¹¶åœ¨æ–°è¡Œä¸Šæ‰§è¡ŒUPDATE/DELETEã€‚ -- -- å¦‚æœå¿…è¦ï¼Œå¿…é¡»åœ¨ä¸ªä½“åˆ†åŒºä¸Šå®šä¹‰BEFORE ROWè§¦å‘å™¨ï¼Œåˆ†åŒºè¡¨ä¸Šä¸éœ€è¦ã€‚ -- -- ä¸å…è®¸åœ¨åŒä¸€ä¸ªåˆ†åŒºæ ‘ä¸­æ··æ‚ä¸´æ—¶å…³ç³»å’ŒæŒä¹…å…³ç³»ã€‚å› æ­¤ï¼Œå¦‚æœåˆ†åŒºè¡¨æ˜¯æŒä¹…çš„ï¼Œåˆ™å…¶åˆ†åŒºä¹Ÿå¿…é¡»æ˜¯æŒä¹…çš„ï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨ä½¿ç”¨ä¸´æ—¶å…³ç³»æ—¶ï¼Œåˆ†åŒºæ•°çš„æ‰€æœ‰æˆå‘˜éƒ½å¿…é¡»æ¥è‡ªäºåŒä¸€ä¸ªä¼šè¯ã€‚ -- ä½¿ç”¨ç»§æ‰¿å®ç° -- è™½ç„¶å†…å»ºçš„å£°æ˜å¼åˆ†åŒºé€‚åˆäºå¤§éƒ¨åˆ†å¸¸è§çš„ç”¨ä¾‹ï¼Œä½†è¿˜æ˜¯æœ‰ä¸€äº›åœºæ™¯éœ€è¦æ›´åŠ çµæ´»çš„æ–¹æ³•ã€‚åˆ†åŒºå¯ä»¥ä½¿ç”¨è¡¨ç»§æ‰¿æ¥å®ç°ï¼Œè¿™èƒ½å¤Ÿå¸¦æ¥ä¸€äº›å£°æ˜å¼åˆ†åŒºä¸æ”¯æŒçš„ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼š -- -- å¯¹å£°æ˜å¼åˆ†åŒºæ¥è¯´ï¼Œåˆ†åŒºå¿…é¡»å…·æœ‰å’Œåˆ†åŒºè¡¨æ­£å¥½ç›¸åŒçš„åˆ—é›†åˆï¼Œè€Œåœ¨è¡¨ç»§æ‰¿ä¸­ï¼Œå­è¡¨å¯ä»¥æœ‰çˆ¶è¡¨ä¸­æ²¡æœ‰å‡ºç°è¿‡çš„é¢å¤–åˆ—ã€‚ -- -- è¡¨ç»§æ‰¿å…è®¸å¤šç»§æ‰¿ã€‚ -- -- å£°æ˜å¼åˆ†åŒºä»…æ”¯æŒèŒƒå›´ã€åˆ—è¡¨ä»¥åŠå“ˆå¸Œåˆ†åŒºï¼Œè€Œè¡¨ç»§æ‰¿å…è®¸æ•°æ®æŒ‰ç…§ç”¨æˆ·çš„é€‰æ‹©æ¥åˆ’åˆ†ï¼ˆä¸è¿‡æ³¨æ„ï¼Œå¦‚æœçº¦æŸæ’é™¤ä¸èƒ½æœ‰æ•ˆåœ°å‰ªæå­è¡¨ï¼ŒæŸ¥è¯¢æ€§èƒ½å¯èƒ½ä¼šå¾ˆå·®ï¼‰ã€‚ -- -- åœ¨ä½¿ç”¨å£°æ˜å¼åˆ†åŒºæ—¶ï¼Œä¸€äº›æ“ä½œæ¯”ä½¿ç”¨è¡¨ç»§æ‰¿æ—¶è¦æ±‚æ›´é•¿çš„æŒé”æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œå‘åˆ†åŒºè¡¨ä¸­å¢åŠ åˆ†åŒºæˆ–è€…ä»åˆ†åŒºè¡¨ç§»é™¤åˆ†åŒºè¦æ±‚åœ¨çˆ¶è¡¨ä¸Šå–å¾—ä¸€ä¸ªACCESS EXCLUSIVEé”ï¼Œè€Œåœ¨å¸¸è§„ç»§æ‰¿çš„æƒ…å†µä¸‹ä¸€ä¸ªSHARE UPDATE EXCLUSIVEé”å°±è¶³å¤Ÿäº†ã€‚ --ç»§æ‰¿å®ç°å¯ä»¥åœ¨å·²æœ‰æ•°æ®ä¸­å®ç°å—ï¼Ÿ create table measurement3 ( id int not null, name char not null ); insert into measurement3 (id, name) values (1, \u0026#39;a\u0026#39;); insert into measurement3 (id, name) values (2, \u0026#39;b\u0026#39;); insert into measurement3 (id, name) values (3, \u0026#39;c\u0026#39;); insert into measurement3 (id, name) values (4, \u0026#39;d\u0026#39;); create table measurement3_y1 (check ( id \u0026gt;= 10 and id \u0026lt; 20 )) inherits (measurement3); create table measurement3_y2 (check ( id \u0026gt;= 20 and id \u0026lt; 30 )) inherits (measurement3); create function measurement_insert_trigger() returns trigger language plpgsql as $$ BEGIN IF (NEW.id \u0026gt;= 10 and NEW.id \u0026lt; 20) then INSERT INTO measurement3_y1 VALUES (NEW.*); ELSIF (NEW.id \u0026gt;= 20 and NEW.id \u0026lt; 30) then INSERT INTO measurement3_y2 VALUES (NEW.*); ELSE RAISE EXCEPTION \u0026#39;id out of range. Fix the measurement_insert_trigger function!\u0026#39;; END IF; RETURN NULL; END; $$; alter function measurement_insert_trigger() owner to develop; CREATE TRIGGER insert_measurement_trigger BEFORE INSERT ON measurement3 FOR EACH ROW EXECUTE FUNCTION measurement_insert_trigger(); insert into measurement3 (id, name) values (100, \u0026#39;d\u0026#39;); ","permalink":"https://26huitailang.github.io/posts/postgresql/partition/","summary":"PostgreSQL åˆ†è¡¨ ç»§æ‰¿å®ç°æ›´çµæ´»ï¼Œå¯ä»¥ç›´æ¥åœ¨å·²æœ‰æ•°æ®çš„è¡¨ä¸Šå®ç°ï¼Œä¸ç”¨é‡æ–°è¿ç§»ã€‚\n-- https://www.postgresql.org/docs/current/ddl-partitioning.html -- zh -- http://postgres.cn/docs/11/ddl-partitioning.html -- keyword: further redirect -- å·²æœ‰æ•°æ®åˆ†è¡¨ï¼Œå› ä¸ºä¸»è¡¨ä¸èƒ½æœ‰æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å…ˆå¤‡ä»½ï¼Œåˆ›å»ºåˆ†è¡¨å’Œè§„åˆ™å®Œæ¯•åé‡æ–°æ’å…¥ -- æˆ–è€…ç”¨æ–°çš„è¡¨åï¼Œä¹‹åå†åˆ†æ‰¹è¯»å–æ’å…¥ -- åˆ›å»ºä¸»è¡¨ CREATE TABLE measurement ( city_id int not null, logdate date not null, peaktemp int, unitsales int ) PARTITION BY RANGE (logdate); -- åˆ›å»ºåˆ†è¡¨åŠè§„åˆ™ -- è¿˜å¯ä»¥é€šè¿‡partition by å†æ¬¡åˆ›å»ºsub-partitioningï¼Œå¯¹æ’å…¥measurement_y2006m02çš„æ•°æ®å†æ¬¡é‡å®šå‘ -- CREATE TABLE measurement_y2006m02 PARTITION OF measurement -- FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;) -- PARTITION BY RANGE (peaktemp); CREATE TABLE measurement_y2006m02 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;); CREATE TABLE measurement_y2006m03 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-03-01\u0026#39;) TO (\u0026#39;2006-04-01\u0026#39;); -- åˆ›å»ºç´¢å¼•ï¼Œè‡ªåŠ¨å†æ¯ä¸ªåˆ†åŒºä¸Šåˆ›å»ºç´¢å¼• CREATE INDEX ON measurement (logdate); -- Ensure that the enable_partition_pruning configuration parameter is not disabled in postgresql.","title":"PostgreSQL åˆ†è¡¨"},{"content":"Teamcity æ­å»ºCI/CD install server\nmkdir teamcity_server docker run -it --name teamcity-server-instance \\ -v /home/ubuntu/teamcity_server/datadir:/data/teamcity_server/datadir \\ -v /home/ubuntu/teamcity_server/logs:/opt/teamcity/logs \\ -p 8111:8111 \\ jetbrains/teamcity-server agent, conf æœ‰æƒé™é—®é¢˜ï¼Œæœ€å¥½åœ¨rootè¿è¡Œ å¦‚æœè¦ä½¿ç”¨docker-in-dockerç‰¹æ€§ï¼ˆsudo command not foundï¼‰ï¼Œè¯·ä½¿ç”¨linux-sudo tagçš„image sudo docker run -it -e SERVER_URL=\u0026#34;http://10.200.160.4:8111\u0026#34; \\ -u 0 \\ -v docker_volumes:/var/lib/docker \\ -v /var/run/docker.sock:/var/run/docker.sock \\ -v /opt/buildagent/work:/opt/buildagent/work \\ -v /opt/buildagent/temp:/opt/buildagent/temp \\ -v /opt/buildagent/tools:/opt/buildagent/tools \\ -v /opt/buildagent/plugins:/opt/buildagent/plugins \\ -v /opt/buildagent/system:/opt/buildagent/system \\ --privileged -e DOCKER_IN_DOCKER=start \\ -v /home/ubuntu/teamcity_agent/conf:/data/teamcity_agent/conf \\ jetbrains/teamcity-agent register agent agent å®‰è£…å¥½åï¼Œåœ¨server UI/Agents ä¸­è¿›è¡Œè®¤è¯æˆæƒã€‚å¾…agentå°±ç»ªåï¼Œå¯ä»¥æ·»åŠ éœ€è¦çš„é¡¹ç›®å’Œæ“ä½œç­‰ã€‚\né¡¹ç›® æˆ‘ä½¿ç”¨çš„æ˜¯gitlabï¼Œteamcityé»˜è®¤æ˜¯æ”¯æŒçš„\nå³ä¸Šè§’ Administration åœ¨root project/connections ä¸­æ·»åŠ  gitlab ce/eeï¼ŒæŒ‰ç…§æŒ‡ç¤ºå³å¯ï¼Œä¼šæœ‰ä¸ªoauthè®¤è¯çš„è¿‡ç¨‹ ä¹‹åå°±å¯ä»¥åœ¨root project ä¸‹åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥å¯¼å…¥gitlabçš„é¡¹ç›®äº† Build åˆ›å»ºäº†é¡¹ç›®åï¼Œåœ¨Build Configurationsä¸­åˆ›å»ºæ–°çš„configurationï¼Œè¿™ä¸ªé…ç½®å¯ä»¥åŒ…å«å¤šä¸ªsteps æ¯ä¸ªé…ç½®å¯ä»¥é…ç½®triggerå’Œbranchï¼Œè¿˜æœ‰å‚æ•° è¿™é‡Œå¯ä»¥ç”¨é…ç½®éš”ç¦»ä¸åŒç¯å¢ƒçš„æµ‹è¯•ï¼Œæˆ‘è¿™é‡Œåªæœ‰ä¸€ä¸ªå•å…ƒæµ‹è¯•çš„ç¯å¢ƒï¼Œbranchæ˜¯æˆ‘è‡ªå·±ä»“åº“çš„devï¼Œåœ¨Version Control Settingsä¸­è®¾ç½®ï¼Œå¯ä»¥å¤šä¸ª Build Stepï¼Œæˆ‘é€‰ç”¨çš„Command Lineï¼Œåœ¨dockerä¸­è¿è¡Œ é…ç½® docker settings python:3.7 echo \u0026#39;Webserver CI start ...\u0026#39; pip install --default-timeout=60 --no-cache-dir -r requirements/ci.txt -i https://mirrors.aliyun.com/pypi/simple/ \u0026amp;\u0026amp; \\ cp generalapps/settings/ci.py generalapps/settings/settings.py \u0026amp;\u0026amp; \\ python manage.py test --keepdb notification rules å¯ä»¥é…ç½® Email/Browser/IDE/Jabber/Slack\næˆ‘ä½¿ç”¨Pycharmï¼Œåœ¨æ’ä»¶ä¸­å®‰è£…teamcityæ’ä»¶ï¼Œç„¶åä½¿ç”¨server url/username/passwordç™»å½•å³å¯ åœ¨ä¸ªäººé…ç½®ä¸­é€‰æ‹©å…³æ³¨çš„é¡¹ç›®å’Œäº‹ä»¶ ä¹‹ååœ¨ideä¸­å³å¯çœ‹åˆ°é¡¹ç›®CIçš„åŠ¨æ€ ","permalink":"https://26huitailang.github.io/posts/teamcity/teamcity/","summary":"Teamcity æ­å»ºCI/CD install server\nmkdir teamcity_server docker run -it --name teamcity-server-instance \\ -v /home/ubuntu/teamcity_server/datadir:/data/teamcity_server/datadir \\ -v /home/ubuntu/teamcity_server/logs:/opt/teamcity/logs \\ -p 8111:8111 \\ jetbrains/teamcity-server agent, conf æœ‰æƒé™é—®é¢˜ï¼Œæœ€å¥½åœ¨rootè¿è¡Œ å¦‚æœè¦ä½¿ç”¨docker-in-dockerç‰¹æ€§ï¼ˆsudo command not foundï¼‰ï¼Œè¯·ä½¿ç”¨linux-sudo tagçš„image sudo docker run -it -e SERVER_URL=\u0026#34;http://10.200.160.4:8111\u0026#34; \\ -u 0 \\ -v docker_volumes:/var/lib/docker \\ -v /var/run/docker.sock:/var/run/docker.sock \\ -v /opt/buildagent/work:/opt/buildagent/work \\ -v /opt/buildagent/temp:/opt/buildagent/temp \\ -v /opt/buildagent/tools:/opt/buildagent/tools \\ -v /opt/buildagent/plugins:/opt/buildagent/plugins \\ -v /opt/buildagent/system:/opt/buildagent/system \\ --privileged -e DOCKER_IN_DOCKER=start \\ -v /home/ubuntu/teamcity_agent/conf:/data/teamcity_agent/conf \\ jetbrains/teamcity-agent register agent agent å®‰è£…å¥½åï¼Œåœ¨server UI/Agents ä¸­è¿›è¡Œè®¤è¯æˆæƒã€‚å¾…agentå°±ç»ªåï¼Œå¯ä»¥æ·»åŠ éœ€è¦çš„é¡¹ç›®å’Œæ“ä½œç­‰ã€‚","title":"TeamCity æ­å»ºCI/CD"},{"content":"å¦‚ä½•ä½¿ç”¨ Vagrant å¿«é€Ÿæ­å»ºç¯å¢ƒ åŠ é€Ÿ å¯ä»¥ç›´æ¥ä»å›½å†…é•œåƒä¸‹è½½ boxæ ¼å¼çš„æ–‡ä»¶ï¼Œç„¶åç”¨ vagrant box add NAME URLæ·»åŠ \n# è‡ªå·±ä¸‹è½½ https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cloud-images/focal/current/ åˆ¶ä½œè‡ªå·±çš„box å®˜æ–¹æ–‡æ¡£\næ­£å¸¸å®‰è£…é•œåƒï¼Œç„¶åå®‰è£…åŸºç¡€ç¯å¢ƒ\nå¯¼å‡º\nvagrant package --base ubuntu20.04 --output ./ubuntu2004.box æ·»åŠ box\nvagrant box add ubuntu2004 .\\ubuntu2004.box å¦‚æœæ²¡æœ‰Vagrantfileï¼Œåˆ™åˆå§‹åŒ–\nvagrant box add ubuntu2004 .\\ubuntu2004.box å¯åŠ¨\nvagrant up VagrantFile # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :k3s1 =\u0026gt; \u0026#39;192.168.1.21\u0026#39;, :k3s2 =\u0026gt; \u0026#39;192.168.1.22\u0026#39;, :k3s3 =\u0026gt; \u0026#39;192.168.1.23\u0026#39; } Vagrant.configure(\u0026#34;2\u0026#34;) do |config| # å¯ä»¥æŒ‡å®šè‡ªå·±å¯¼å‡ºçš„box config.vm.box = \u0026#34;ubuntu/focal64\u0026#34; servers.each do |server_name, server_ip| config.vm.define server_name do |server_config| server_config.vm.hostname = \u0026#34;#{server_name.to_s}\u0026#34; server_config.vm.network :private_network, ip: server_ip server_config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.name = server_name.to_s vb.memory = 1024 vb.cpus = 1 end end end end ","permalink":"https://26huitailang.github.io/posts/vagrant/vagrant/","summary":"å¦‚ä½•ä½¿ç”¨ Vagrant å¿«é€Ÿæ­å»ºç¯å¢ƒ åŠ é€Ÿ å¯ä»¥ç›´æ¥ä»å›½å†…é•œåƒä¸‹è½½ boxæ ¼å¼çš„æ–‡ä»¶ï¼Œç„¶åç”¨ vagrant box add NAME URLæ·»åŠ \n# è‡ªå·±ä¸‹è½½ https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cloud-images/focal/current/ åˆ¶ä½œè‡ªå·±çš„box å®˜æ–¹æ–‡æ¡£\næ­£å¸¸å®‰è£…é•œåƒï¼Œç„¶åå®‰è£…åŸºç¡€ç¯å¢ƒ\nå¯¼å‡º\nvagrant package --base ubuntu20.04 --output ./ubuntu2004.box æ·»åŠ box\nvagrant box add ubuntu2004 .\\ubuntu2004.box å¦‚æœæ²¡æœ‰Vagrantfileï¼Œåˆ™åˆå§‹åŒ–\nvagrant box add ubuntu2004 .\\ubuntu2004.box å¯åŠ¨\nvagrant up VagrantFile # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :k3s1 =\u0026gt; \u0026#39;192.168.1.21\u0026#39;, :k3s2 =\u0026gt; \u0026#39;192.168.1.22\u0026#39;, :k3s3 =\u0026gt; \u0026#39;192.168.1.23\u0026#39; } Vagrant.configure(\u0026#34;2\u0026#34;) do |config| # å¯ä»¥æŒ‡å®šè‡ªå·±å¯¼å‡ºçš„box config.vm.box = \u0026#34;ubuntu/focal64\u0026#34; servers.","title":"Vagrant"},{"content":"wheel æä¾›ç»™ç³»ç»Ÿç»„çš„wheelåŒ…æ„å»ºï¼Œè¦æ±‚none-any\nä»¥oss2åŒ…ä¸ºä¾‹\npip download oss2 --platform=any --abi=none --no-deps æŸ¥çœ‹setup.pyä¸­çš„ä¾èµ–ï¼Œåˆ†åˆ«ç”¨ä¸Šé¢çš„å‘½ä»¤ä¸‹è½½ï¼Œè·å¾—æ‰€æœ‰çš„æºç åŒ…ã€‚\næ‰“åŒ…wheelï¼Œuniversalé€‰é¡¹å¯ä»¥æ‰“åŒ…å¿½ç•¥å¹³å°å’Œæ¶æ„çš„åŒ…;å¦‚æœåŒ…é‡Œé¢å«æœ‰c extensionæ˜¯ä¸æ”¯æŒuniversalçš„ï¼Œå¿…é¡»æ˜¯çº¯pythonå®ç°\npython .\\setup.py bdist_wheel --universal å¦‚æœé‡åˆ°æ‰“åŒ…é”™è¯¯ error: invalid command 'bdist_wheel'ï¼Œå¯ä»¥ä¿®æ”¹setup.pyä½¿ç”¨setuptoolsçš„setupæ–¹æ³•ï¼š\n# from distutils.core import setup from setuptools import setup ","permalink":"https://26huitailang.github.io/posts/python/pip/wheel/","summary":"wheel æä¾›ç»™ç³»ç»Ÿç»„çš„wheelåŒ…æ„å»ºï¼Œè¦æ±‚none-any\nä»¥oss2åŒ…ä¸ºä¾‹\npip download oss2 --platform=any --abi=none --no-deps æŸ¥çœ‹setup.pyä¸­çš„ä¾èµ–ï¼Œåˆ†åˆ«ç”¨ä¸Šé¢çš„å‘½ä»¤ä¸‹è½½ï¼Œè·å¾—æ‰€æœ‰çš„æºç åŒ…ã€‚\næ‰“åŒ…wheelï¼Œuniversalé€‰é¡¹å¯ä»¥æ‰“åŒ…å¿½ç•¥å¹³å°å’Œæ¶æ„çš„åŒ…;å¦‚æœåŒ…é‡Œé¢å«æœ‰c extensionæ˜¯ä¸æ”¯æŒuniversalçš„ï¼Œå¿…é¡»æ˜¯çº¯pythonå®ç°\npython .\\setup.py bdist_wheel --universal å¦‚æœé‡åˆ°æ‰“åŒ…é”™è¯¯ error: invalid command 'bdist_wheel'ï¼Œå¯ä»¥ä¿®æ”¹setup.pyä½¿ç”¨setuptoolsçš„setupæ–¹æ³•ï¼š\n# from distutils.core import setup from setuptools import setup ","title":"wheel"}]