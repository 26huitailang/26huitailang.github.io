[{"content":"tmux ç»ˆç«¯æœç”¨è½¯ä»¶ï¼Œsessionå¯ä»¥ä¿å­˜åœ¨tmux serverä¸­ï¼Œå°±ç®—itermç­‰ç»ˆç«¯å…³é—­ä¹Ÿå¯ä»¥æ¢å¤ï¼Œè¿œç¨‹è¿æ¥çš„æ—¶å€™é¿å…æ‰çº¿ï¼ˆç±»ä¼¼çš„åŠŸèƒ½çš„è½¯ä»¶è¿˜æœ‰ï¼Œscreenï¼‰ã€‚\nå‚è€ƒ  ååˆ†é’Ÿå­¦ä¼š tmux Tmux - Linuxä»ä¸šè€…å¿…å¤‡åˆ©å™¨ * cheatsheet ä¼˜é›…åœ°ä½¿ç”¨å‘½ä»¤è¡Œï¼šTmux ç»ˆç«¯å¤ç”¨ Tmuxä½¿ç”¨æ‰‹å†Œ  æœ¬æœºï¼Œcheatsheet-tmux  å®‰è£… brew install tmux  åŸºäºå‚è€ƒç¬¬äºŒç¯‡æ–‡ç« ï¼Œé…ç½®ï¼š\n$ cd $ rm -rf .tmux $ git clone https://github.com/gpakosz/.tmux.git $ ln -s -f .tmux/.tmux.conf $ cp .tmux/.tmux.conf.local . æ¦‚å¿µ  sessionï¼Œä¸åŒçš„ä¼šè¯ windowï¼Œä¸åŒçš„çª—å£ï¼Œç‰©ç†åˆ’åˆ†ï¼Œä¸€ä¸ªsessionå¯ä»¥æœ‰å¤šä¸ªwindow paneï¼Œçª—æ ¼ï¼Œä¸€ä¸ªwindowå¯ä»¥ç”¨è¿‡ %/\u0026quot; åˆ’åˆ†ä¸ºå¤šä¸ªçª—æ ¼  tmuxæ“ä½œ  tmux lsï¼ŒæŸ¥çœ‹æ‰“å¼€çš„session tmux aï¼Œæ¢å¤ tmux a -t SESSION,æ¢å¤æŒ‡å®šsession  C-bæ“ä½œ  å‰ç¼€å¿«æ·é”®ï¼Œ^b % å·¦å³å¹³åˆ†å‡ºä¸¤ä¸ªpane \u0026quot; ä¸Šä¸‹å¹³åˆ†å‡ºä¸¤ä¸ªpane x å…³é—­å½“å‰çª—æ ¼ { å½“å‰çª—æ ¼å‰ç§» } å½“å‰çª—æ ¼åç§» ; é€‰æ‹©ä¸Šæ¬¡ä½¿ç”¨çš„çª—æ ¼ o é€‰æ‹©ä¸‹ä¸€ä¸ªçª—æ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šä¸‹å·¦å³æ–¹å‘é”®æ¥é€‰æ‹© space åˆ‡æ¢çª—æ ¼å¸ƒå±€ï¼Œtmux å†…ç½®äº†äº”ç§çª—æ ¼å¸ƒå±€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ âŒ¥1 è‡³ âŒ¥5æ¥åˆ‡æ¢ z æœ€å¤§åŒ–å½“å‰çª—æ ¼ï¼Œå†æ¬¡æ‰§è¡Œå¯æ¢å¤åŸæ¥å¤§å° q æ˜¾ç¤ºæ‰€æœ‰çª—æ ¼çš„åºå·ï¼Œåœ¨åºå·å‡ºç°æœŸé—´æŒ‰ä¸‹å¯¹åº”çš„æ•°å­—ï¼Œå³å¯è·³è½¬è‡³å¯¹åº”çš„çª—æ ¼  resize pane  C-b :resize-pane -D/U/R/L 20  ä¿®æ”¹é…ç½®  ~/.tmux.conf.local ~/.tmux.conf  source file\nC-b :source-file ~/.tmux.conf.local  ä¿®æ”¹å¤åˆ¶æ¨¡å¼ä¸ºviæ¨¡å¼ï¼Œ.tmux.conf.local\nset-option -g mode-keys vi å¤åˆ¶ ä¿®æ”¹viæ¨¡å¼å\n C-b + [ è¿›å»å¤åˆ¶æ¨¡å¼ ç©ºæ ¼å¼€å§‹é€‰æ‹© Enter ç»“æŸ C-b + ] ç²˜è´´  æ’ä»¶ æ¢å¤ä¼šè¯ Tmux Resurrect   å®‰è£…\n cd ~/.tmux mkdir plugins git clone https://github.com/tmux-plugins/tmux-resurrect.git ä¿®æ”¹ ~/.tmux.conf.local  run-shell ~/.tmux/plugins/tmux-resurrect/resurrect.tmux   prefix + r é‡è½½é…ç½®    ä¿å­˜ï¼Œprefix + Ctrl + s\n ä¿å­˜ä½ç½®ï¼Œ~/.tmux/resurrectï¼Œå¯ä»¥æ‰‹åŠ¨æ¸…ç†è¿™é‡Œçš„å†å²è®°å½•    æ¢å¤ï¼Œprefix + Ctrl + r\n  è‡ªåŠ¨æ¢å¤ Tmux Continuum å…ˆç”¨æ‰‹åŠ¨ï¼Œåç»­è¯•è¯•è¿™ä¸ªè‡ªåŠ¨\n","permalink":"http://localhost:8000/posts/devenv/tmux/","summary":"tmux ç»ˆç«¯æœç”¨è½¯ä»¶ï¼Œsessionå¯ä»¥ä¿å­˜åœ¨tmux serverä¸­ï¼Œå°±ç®—itermç­‰ç»ˆç«¯å…³é—­ä¹Ÿå¯ä»¥æ¢å¤ï¼Œè¿œç¨‹è¿æ¥çš„æ—¶å€™é¿å…æ‰çº¿ï¼ˆç±»ä¼¼çš„åŠŸèƒ½çš„è½¯ä»¶è¿˜æœ‰ï¼Œscreenï¼‰ã€‚\nå‚è€ƒ  ååˆ†é’Ÿå­¦ä¼š tmux Tmux - Linuxä»ä¸šè€…å¿…å¤‡åˆ©å™¨ * cheatsheet ä¼˜é›…åœ°ä½¿ç”¨å‘½ä»¤è¡Œï¼šTmux ç»ˆç«¯å¤ç”¨ Tmuxä½¿ç”¨æ‰‹å†Œ  æœ¬æœºï¼Œcheatsheet-tmux  å®‰è£… brew install tmux  åŸºäºå‚è€ƒç¬¬äºŒç¯‡æ–‡ç« ï¼Œé…ç½®ï¼š\n$ cd $ rm -rf .tmux $ git clone https://github.com/gpakosz/.tmux.git $ ln -s -f .tmux/.tmux.conf $ cp .tmux/.tmux.conf.local . æ¦‚å¿µ  sessionï¼Œä¸åŒçš„ä¼šè¯ windowï¼Œä¸åŒçš„çª—å£ï¼Œç‰©ç†åˆ’åˆ†ï¼Œä¸€ä¸ªsessionå¯ä»¥æœ‰å¤šä¸ªwindow paneï¼Œçª—æ ¼ï¼Œä¸€ä¸ªwindowå¯ä»¥ç”¨è¿‡ %/\u0026quot; åˆ’åˆ†ä¸ºå¤šä¸ªçª—æ ¼  tmuxæ“ä½œ  tmux lsï¼ŒæŸ¥çœ‹æ‰“å¼€çš„session tmux aï¼Œæ¢å¤ tmux a -t SESSION,æ¢å¤æŒ‡å®šsession  C-bæ“ä½œ  å‰ç¼€å¿«æ·é”®ï¼Œ^b % å·¦å³å¹³åˆ†å‡ºä¸¤ä¸ªpane \u0026quot; ä¸Šä¸‹å¹³åˆ†å‡ºä¸¤ä¸ªpane x å…³é—­å½“å‰çª—æ ¼ { å½“å‰çª—æ ¼å‰ç§» } å½“å‰çª—æ ¼åç§» ; é€‰æ‹©ä¸Šæ¬¡ä½¿ç”¨çš„çª—æ ¼ o é€‰æ‹©ä¸‹ä¸€ä¸ªçª—æ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šä¸‹å·¦å³æ–¹å‘é”®æ¥é€‰æ‹© space åˆ‡æ¢çª—æ ¼å¸ƒå±€ï¼Œtmux å†…ç½®äº†äº”ç§çª—æ ¼å¸ƒå±€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ âŒ¥1 è‡³ âŒ¥5æ¥åˆ‡æ¢ z æœ€å¤§åŒ–å½“å‰çª—æ ¼ï¼Œå†æ¬¡æ‰§è¡Œå¯æ¢å¤åŸæ¥å¤§å° q æ˜¾ç¤ºæ‰€æœ‰çª—æ ¼çš„åºå·ï¼Œåœ¨åºå·å‡ºç°æœŸé—´æŒ‰ä¸‹å¯¹åº”çš„æ•°å­—ï¼Œå³å¯è·³è½¬è‡³å¯¹åº”çš„çª—æ ¼  resize pane  C-b :resize-pane -D/U/R/L 20  ä¿®æ”¹é…ç½®  ~/.","title":"tmux"},{"content":"nginx [toc]\nå¸¸ç”¨å‘½ä»¤ nginx -s stop nginx -s reload ç®€ä»‹ åå‘ä»£ç† ä¸€å¥è¯ï¼š\n ä»€ä¹ˆæ˜¯æ­£å‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯å®¢æˆ·ç«¯ ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯æ˜¯æ— æ„ŸçŸ¥çš„  nginxåå‘ä»£ç†é…ç½®\næ­£å¸¸æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; server ä»£ç†æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; clinet proxy â€“(send request)â€”\u0026gt; server åå‘ä»£ç†ï¼š client -(send request)-\u0026gt; server proxy -(send request)-\u0026gt; other server  å¯ä»¥çœ‹åˆ°åå‘ä»£ç†å¹¶ä¸æ˜¯çœŸçš„åè¿‡æ¥ï¼Œè€Œæ˜¯ä»£ç†äººçš„èº«ä»½ç”±å®¢æˆ·ç«¯è½¬å‘äº†æœåŠ¡ç«¯ï¼Œä¹Ÿå› ä¸ºä»£ç†æ˜¯åœ¨æœåŠ¡ç«¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ˜¯å¯¹æ­¤æ— æ„ŸçŸ¥çš„ã€‚\nè´Ÿè½½å‡è¡¡ å°†åŸå…ˆé›†ä¸­è¯·æ±‚åˆ°å•ä¸ªæœåŠ¡å™¨çš„è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¯æŒæœåŠ¡æ¨ªå‘æ‰©å±•ã€‚\nåŠ¨é™åˆ†ç¦» é…ç½® å…¨å±€ é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventsä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦æ˜¯è®¾ç½®ä¸€äº›å½±å“nginxè¿è¡Œçš„é…ç½®æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼š\n ç”¨æˆ·ï¼ˆç»„ï¼‰ worker processæ•°é‡ è¿›ç¨‹pidå­˜æ”¾è·¯å¾„ æ—¥å¿—å­˜æ”¾è·¯å¾„å’Œç±»å‹ é…ç½®æ–‡ä»¶çš„å¼•å…¥  events é…ç½®nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ï¼Œæ­¤éƒ¨åˆ†å¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåº”æ ¹æ®å®é™…æƒ…å†µå¤„ç†ï¼Œæ¯”å¦‚ï¼š\n æ˜¯å¦å¼€å¯å¯¹å¤šworker processä¸‹çš„ç½‘ç»œè¿æ¥è¿›è¡Œåºåˆ—åŒ– æ˜¯å¦å…è®¸åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ é€‰å–å¤„ç†è¿æ¥çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ æ¯ä¸ªworker æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ç­‰  http  å…¨å±€é…ç½® serveré…ç½®  å…¨å±€ locationé…ç½®    server é…ç½®å’ŒåŒ¹é…è§„åˆ™ ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥æœ‰å¤šä¸ªserverï¼Œè€Œå¯¹serverçš„è·¯å¾„åŒ¹é…ï¼Œåå‘ä»£ç†éƒ½æ˜¯åœ¨è¿™é‡Œé…ç½®çš„ã€‚\nåœ¨serverä¸­æœ€é‡è¦çš„ä¸€é¡¹é…ç½®ï¼šserver_nameçš„é…ç½®ã€‚server_nameå†³å®šäº†æ¥äº†ä¸€ä¸ªurlï¼Œåˆ°åº•æ˜¯å“ªä¸ªserverå¤„ç†è¯¥è¯·æ±‚ã€‚nginxä¼šä¾æ¬¡æ‰¾å’Œurlé…ç½®çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„serverã€‚server_nameå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚è€Œä¸”ä¸€ä¸ªserverçš„server_nameå¯ä»¥å¤šä¸ªï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚æ›´è¯¦ç»†çš„å…³äºserver_nameåŒ¹é…è§„åˆ™ï¼Œå‚çœ‹è¿™é‡Œ\nUnix-domain socket(UnixåŸŸå¥—æ¥å­—) Pythonå®ä¾‹æµ…è°ˆä¹‹ä¹ä½¿ç”¨æœ¬åœ°socketæ–‡ä»¶\nUnix domain socket æˆ–è€… IPC socketæ˜¯ä¸€ç§ç»ˆç«¯ï¼Œå¯ä»¥ä½¿åŒä¸€å°æ“ä½œç³»ç»Ÿä¸Šçš„ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹è¿›è¡Œæ•°æ®é€šä¿¡ã€‚ä¸ç®¡é“ç›¸æ¯”ï¼ŒUnix domain sockets æ—¢å¯ä»¥ä½¿ç”¨å­—èŠ‚æµï¼Œåˆå¯ä»¥ä½¿ç”¨æ•°æ®é˜Ÿåˆ—ï¼Œè€Œç®¡é“é€šä¿¡åˆ™åªèƒ½ä½¿ç”¨å­—èŠ‚æµã€‚Unix domain socketsçš„æ¥å£å’ŒInternet socketå¾ˆåƒï¼Œä½†å®ƒä¸ä½¿ç”¨ç½‘ç»œåº•å±‚åè®®æ¥é€šä¿¡ã€‚Unix domain socket çš„åŠŸèƒ½æ˜¯POSIXæ“ä½œç³»ç»Ÿé‡Œçš„ä¸€ç§ç»„ä»¶ã€‚\nUnix domain sockets ä½¿ç”¨ç³»ç»Ÿæ–‡ä»¶çš„åœ°å€æ¥ä½œä¸ºè‡ªå·±çš„èº«ä»½ã€‚å®ƒå¯ä»¥è¢«ç³»ç»Ÿè¿›ç¨‹å¼•ç”¨ã€‚æ‰€ä»¥ä¸¤ä¸ªè¿›ç¨‹å¯ä»¥åŒæ—¶æ‰“å¼€ä¸€ä¸ªUnix domain socketsæ¥è¿›è¡Œé€šä¿¡ã€‚ä¸è¿‡è¿™ç§é€šä¿¡æ–¹å¼æ˜¯å‘ç”Ÿåœ¨ç³»ç»Ÿå†…æ ¸é‡Œè€Œä¸ä¼šåœ¨ç½‘ç»œé‡Œä¼ æ’­ã€‚\néƒ¨ç½²åº”ç”¨çš„æ—¶å€™ï¼Œåˆ©ç”¨unix domain socketï¼Œå¯ä»¥é˜²æ­¢ç«¯å£å†²çªï¼Œå¯åŠ¨ç¨‹åºçš„æ—¶å€™è¦å°†è¿™ä¸ªsocketæ–‡ä»¶ç»‘å®šåˆ°Gunicornã€‚\nè¿™ä¸ªæ˜¯ç”¨äºè¿›ç¨‹é—´é€šä¿¡çš„æ–¹å¼ï¼Œé‚£ä¹ˆç½‘ç»œsocketæ˜¯ä»€ä¹ˆï¼Ÿ æ–‡ç« æˆ–æ–‡æ¡£é“¾æ¥  æ­å»ºnginxåå‘ä»£ç†ç”¨åšå†…ç½‘åŸŸåè½¬å‘ WEBè¯·æ±‚å¤„ç†äºŒï¼šNginxè¯·æ±‚åå‘ä»£ç† ä½¿ç”¨ Nginx å’Œ Gunicorn éƒ¨ç½² Django åšå®¢  ","permalink":"http://localhost:8000/posts/nginx/nginx/","summary":"nginx [toc]\nå¸¸ç”¨å‘½ä»¤ nginx -s stop nginx -s reload ç®€ä»‹ åå‘ä»£ç† ä¸€å¥è¯ï¼š\n ä»€ä¹ˆæ˜¯æ­£å‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯å®¢æˆ·ç«¯ ä»€ä¹ˆæ˜¯åå‘ä»£ç†ï¼Ÿä»£ç†çš„æ˜¯æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯æ˜¯æ— æ„ŸçŸ¥çš„  nginxåå‘ä»£ç†é…ç½®\næ­£å¸¸æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; server ä»£ç†æƒ…å†µï¼š client â€”(send request)â€”\u0026gt; clinet proxy â€“(send request)â€”\u0026gt; server åå‘ä»£ç†ï¼š client -(send request)-\u0026gt; server proxy -(send request)-\u0026gt; other server  å¯ä»¥çœ‹åˆ°åå‘ä»£ç†å¹¶ä¸æ˜¯çœŸçš„åè¿‡æ¥ï¼Œè€Œæ˜¯ä»£ç†äººçš„èº«ä»½ç”±å®¢æˆ·ç«¯è½¬å‘äº†æœåŠ¡ç«¯ï¼Œä¹Ÿå› ä¸ºä»£ç†æ˜¯åœ¨æœåŠ¡ç«¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯æ˜¯å¯¹æ­¤æ— æ„ŸçŸ¥çš„ã€‚\nè´Ÿè½½å‡è¡¡ å°†åŸå…ˆé›†ä¸­è¯·æ±‚åˆ°å•ä¸ªæœåŠ¡å™¨çš„è¯·æ±‚åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œç›®çš„æ˜¯ä¸ºäº†æ”¯æŒæœåŠ¡æ¨ªå‘æ‰©å±•ã€‚\nåŠ¨é™åˆ†ç¦» é…ç½® å…¨å±€ é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventsä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦æ˜¯è®¾ç½®ä¸€äº›å½±å“nginxè¿è¡Œçš„é…ç½®æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼š\n ç”¨æˆ·ï¼ˆç»„ï¼‰ worker processæ•°é‡ è¿›ç¨‹pidå­˜æ”¾è·¯å¾„ æ—¥å¿—å­˜æ”¾è·¯å¾„å’Œç±»å‹ é…ç½®æ–‡ä»¶çš„å¼•å…¥  events é…ç½®nginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥ï¼Œæ­¤éƒ¨åˆ†å¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåº”æ ¹æ®å®é™…æƒ…å†µå¤„ç†ï¼Œæ¯”å¦‚ï¼š\n æ˜¯å¦å¼€å¯å¯¹å¤šworker processä¸‹çš„ç½‘ç»œè¿æ¥è¿›è¡Œåºåˆ—åŒ– æ˜¯å¦å…è®¸åŒæ—¶æ¥å—å¤šä¸ªç½‘ç»œè¿æ¥ é€‰å–å¤„ç†è¿æ¥çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹ æ¯ä¸ªworker æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°ç­‰  http  å…¨å±€é…ç½® serveré…ç½®  å…¨å±€ locationé…ç½®    server é…ç½®å’ŒåŒ¹é…è§„åˆ™ ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥æœ‰å¤šä¸ªserverï¼Œè€Œå¯¹serverçš„è·¯å¾„åŒ¹é…ï¼Œåå‘ä»£ç†éƒ½æ˜¯åœ¨è¿™é‡Œé…ç½®çš„ã€‚","title":"Nginx"},{"content":"Pandoc å¼€å§‹  install pandoc install miktext build  ä¸­æ–‡è¦é€‰æ‹©åˆé€‚çš„å­—ä½“å¦åˆ™æ— æ³•æˆåŠŸåˆ›å»º fc-list  mac: brew install fontconfig fc-list :lang-zh \u0026gt; fonts.txt fc-list -f \u0026ldquo;%{family}\\n\u0026rdquo; :lang=zh   å‚æ•°è§£é‡Š  -o: è¾“å‡ºæ–‡ä»¶ \u0026ndash;from: è¾“å…¥æ–‡ä»¶ç±»å‹ \u0026ndash;template: æ¨¡ç‰ˆæ–‡ä»¶ \u0026ndash;listings: åˆ—è¡¨ \u0026ndash;pdf-engine: pdfç”Ÿæˆç”¨çš„å¼•æ“ -V: å‚æ•°  CJKmainfont: ä¸­æ–‡æ–‡å­—å­—ä½“        pandoc \u0026#34;README.md\u0026#34; -o \u0026#34;document.pdf\u0026#34; --from markdown --template \u0026#34;./template.latex\u0026#34; --listings --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open document.pdf data-dir DATADIR\nmacos: ~/.local/share/pandoc\nwindows: C:\\Users\\USERNAME\\AppData\\Roaming\\pandoc\ndefaults $DATADIR/defaults/docker.yamlï¼Œå¯ä»¥ä¸ºä¸åŒçš„æ–‡æ¡£è®¾ç½®è‡ªå·±çš„defaultsï¼Œé¿å…åé¢é‡å¤æ“ä½œï¼Œä»…éœ€ä½¿ç”¨pandoc --defaults dockerå³å¯æ‰“åŒ…æ–‡æ¡£\nfrom: markdown # reader: may be used instead of from: to: pdf # writer: may be used instead of to: # leave blank for output to stdout: output-file: docker.pdf # leave blank for input from stdin, use [] for no input: input-files: - é˜¿é‡Œäº‘ä»“åº“.md - ç®¡ç†å·¥å…·.md - åŠ é€Ÿ.md - æ‰©å®¹.md - æ¸…ç†.md - å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥.md - ç§æœ‰registry.md - debian-docker-install.md - env.md - logs.md - usage.md # or you may use input-file: with a single value # pdf-engine: wkhtmltopdf pdf-engine: xelatex self-contained: false standalone: true metadata: author: - Peter titlepage: true toc-own-page: true toc: true number-sections: true # code block wrap listings: true variables: CJKmainfont: KaiTi template: eisvogel verbosity: ERROR log-file: log.json filters: - mermaid-filter.cmd from: markdown # reader: may be used instead of from: to: pdf # writer: may be used instead of to: # leave blank for output to stdout: output-file: docker.pdf # leave blank for input from stdin, use [] for no input: input-files: - é˜¿é‡Œäº‘ä»“åº“.md - ç®¡ç†å·¥å…·.md - åŠ é€Ÿ.md - æ‰©å®¹.md - æ¸…ç†.md - å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥.md - ç§æœ‰registry.md - debian-docker-install.md - env.md - logs.md - usage.md # or you may use input-file: with a single value # pdf-engine: wkhtmltopdf pdf-engine: xelatex self-contained: false standalone: true metadata: author: - Peter titlepage: true toc-own-page: true toc: true number-sections: true # code block wrap listings: true variables: CJKmainfont: KaiTi template: eisvogel verbosity: ERROR log-file: log.json filters: - mermaid-filter.cmd template è®¾ç½®ä¸ºç³»ç»Ÿé…ç½®ï¼Œeisvogel.latexï¼Œgithub\nmacos: mkdir -p ~/.local/share/pandoc/templates windows: mkdir -p C:\\Users\\USERNAME\\AppData\\Roaming\\pandoc\\templates cp ./eisvogel.latex ~/.local/share/pandoc/templates/ pandoc \u0026quot;README.md\u0026quot; -o \u0026quot;document.pdf\u0026quot; --from markdown --template eisvogel --listings --pdf-engine \u0026quot;xelatex\u0026quot; -V CJKmainfont=\u0026quot;PingFang SC\u0026quot; \u0026amp;\u0026amp; open document.pdf å¤šä¸ªmdæ–‡ä»¶è¾“å…¥  ä½¿ç”¨ç³»ç»Ÿè·¯å¾„ä¸‹çš„æ¨¡ç‰ˆ eisvogel \u0026ndash;number-sections ä¸ºå„ä¸ªæ ‡é¢˜ç¼–ç  toc æ ‡é¢˜ toc-own-page æ ‡é¢˜é¡µä¹‹åä»æ–°é¡µå¼€å§‹å†…å®¹ titlepage å°é¢   ```markdown --- title: å‰ç«¯ç»„ITæ‰‹å†Œ date: 2021-11-12 author: å‰ç«¯ç»„ titlepage: true toc: true toc-own-page: true --- \u0026gt; pandoc *.md -o \u0026#34;å‰ç«¯ITæ‰‹å†Œ.pdf\u0026#34; --from markdown --template eisvogel --listings --number-sections --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open \u0026#34;å‰ç«¯ITæ‰‹å†Œ.pdf\u0026#34; æ”¯æŒmermaid ä½¿ç”¨filterç‰¹æ€§ï¼Œé¦–å…ˆå®‰è£…å¯¹åº”çš„filter\nnpm install --global mermaid-filter è®¾ç½®å…¨å±€çš„npmå®‰è£…ä½ç½®åˆ°$PATHé‡Œé¢ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«filterã€‚\nåœ¨defaultså¯¹åº”çš„æ–‡ä»¶ä¸­æ·»åŠ filtersï¼š\nfilters: - mermaid-filter.cmd (windows) - mermaid-filter.sh åœ¨cliä¸­æ·»åŠ  \u0026ndash;filterå‚æ•°ï¼š\npandoc --defaults docker --filter mermaid-filter åˆ¶ä½œä¸€ä¸ªpandocé•œåƒ https://github.com/26huitailang/pandoc-demo\n","permalink":"http://localhost:8000/posts/markdown/pandoc/","summary":"Pandoc å¼€å§‹  install pandoc install miktext build  ä¸­æ–‡è¦é€‰æ‹©åˆé€‚çš„å­—ä½“å¦åˆ™æ— æ³•æˆåŠŸåˆ›å»º fc-list  mac: brew install fontconfig fc-list :lang-zh \u0026gt; fonts.txt fc-list -f \u0026ldquo;%{family}\\n\u0026rdquo; :lang=zh   å‚æ•°è§£é‡Š  -o: è¾“å‡ºæ–‡ä»¶ \u0026ndash;from: è¾“å…¥æ–‡ä»¶ç±»å‹ \u0026ndash;template: æ¨¡ç‰ˆæ–‡ä»¶ \u0026ndash;listings: åˆ—è¡¨ \u0026ndash;pdf-engine: pdfç”Ÿæˆç”¨çš„å¼•æ“ -V: å‚æ•°  CJKmainfont: ä¸­æ–‡æ–‡å­—å­—ä½“        pandoc \u0026#34;README.md\u0026#34; -o \u0026#34;document.pdf\u0026#34; --from markdown --template \u0026#34;./template.latex\u0026#34; --listings --pdf-engine \u0026#34;xelatex\u0026#34; -V CJKmainfont=\u0026#34;PingFang SC\u0026#34; \u0026amp;\u0026amp; open document.pdf data-dir DATADIR\nmacos: ~/.","title":"Pandoc"},{"content":"README åˆæ¬¡ä½¿ç”¨  podman rootç”¨æˆ·å’Œérootç”¨æˆ·çš„imageså’Œcontaineræ˜¯åˆ†å¼€çš„ érootç”¨æˆ·ä½¿ç”¨podman generate systemdå‘½ä»¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ‹·è´åˆ°~/.config/systemd/user/ä¸‹é¢ï¼Œä½¿ç”¨systemctl --useræ‰§è¡Œ  æµç¨‹æ¼”ç¤º\npodman pull docker.io/nginx:latest podman create --name nginx -p 8080:80 nginx:latest mkdir -p ~/.config/systemd/user cd ~/.config/systemd/user podman generate systemd --files --name nginx systemctl --user enable container-nginx systemctl --user start container-nginx curl http://127.0.0.1:8080 ","permalink":"http://localhost:8000/posts/podman/readme/","summary":"README åˆæ¬¡ä½¿ç”¨  podman rootç”¨æˆ·å’Œérootç”¨æˆ·çš„imageså’Œcontaineræ˜¯åˆ†å¼€çš„ érootç”¨æˆ·ä½¿ç”¨podman generate systemdå‘½ä»¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œæ‹·è´åˆ°~/.config/systemd/user/ä¸‹é¢ï¼Œä½¿ç”¨systemctl --useræ‰§è¡Œ  æµç¨‹æ¼”ç¤º\npodman pull docker.io/nginx:latest podman create --name nginx -p 8080:80 nginx:latest mkdir -p ~/.config/systemd/user cd ~/.config/systemd/user podman generate systemd --files --name nginx systemctl --user enable container-nginx systemctl --user start container-nginx curl http://127.0.0.1:8080 ","title":"Podman"},{"content":"Upgrade debian main version update $ apt-get update \u0026amp;\u0026amp; apt-get upgrade backup sources.list $ cp /etc/apt/sources.list /etc/apt/sources.list.bak replace `stretch` to `buster` of `/etc/apt/sources.list` $ sed -i \u0026#39;s/stretch/buster/g\u0026#39; /etc/apt/sources.list run upgrade $ apt-get update \u0026amp;\u0026amp; apt-get upgrade run dist upgrade $ apt-get dist-upgrade $ reboot $ lsb_release -a clean: $ apt-get autoremove ","permalink":"http://localhost:8000/posts/linux/debian/upgrade/","summary":"Upgrade debian main version update $ apt-get update \u0026amp;\u0026amp; apt-get upgrade backup sources.list $ cp /etc/apt/sources.list /etc/apt/sources.list.bak replace `stretch` to `buster` of `/etc/apt/sources.list` $ sed -i \u0026#39;s/stretch/buster/g\u0026#39; /etc/apt/sources.list run upgrade $ apt-get update \u0026amp;\u0026amp; apt-get upgrade run dist upgrade $ apt-get dist-upgrade $ reboot $ lsb_release -a clean: $ apt-get autoremove ","title":"Upgrade debian main version"},{"content":"Gitlab CI/CD For the development environment.\nInstall with docker Read the official documentation for how to install docker.\nI installed docker on the MacOS.\ngitlab documentation\nsudo docker run --detach \\  --hostname 192.168.8.226 \\  --publish 443:443 --publish 80:80 --publish 8022:22 \\  --name gitlab \\  --restart always \\  --volume ~/gitlab/config:/etc/gitlab \\  --volume ~/gitlab/logs:/var/log/gitlab \\  --volume ~/gitlab/data:/var/opt/gitlab \\  gitlab/gitlab-ce:latest gitlab-runner Order of initialization:\n install register custom config  documentation\nThere is no difficulty to install gitlab and gitlab-runner in docker.\nsudo docker run -d --name gitlab-runner --restart always \\  -v ~/gitlab-runner/config:/etc/gitlab-runner \\  -v /var/run/docker.sock:/var/run/docker.sock \\  gitlab/gitlab-runner:latest I was confused with the config of gitlab-runner, so I wrote these down.\nregister:\n docker run --rm -t -i -v ~/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner register, cmd for register a runner.  the register info will record in the ~/gitlab-runner/config/config.toml url is the url of the gitlab token is from your gitlab, the project runner and shared runner is different. You can registe it for shared runner and enable for the specified project. executor choose docker, I use the image python:3.7 for my python project. manual operation to edit the config.toml:  pull_policy = \u0026quot;if-not-present\u0026quot; default value is always for every time pull the image. network_mode = \u0026quot;host\u0026quot; default value is bridge that runner cannot connect other machines in the same net.      for non-interactive register:\ndocker run --rm -v /srv/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner register \\  --non-interactive \\  --executor \u0026#34;docker\u0026#34; \\  --docker-image alpine:latest \\  --url \u0026#34;https://gitlab.com/\u0026#34; \\  --registration-token \u0026#34;PROJECT_REGISTRATION_TOKEN\u0026#34; \\  --description \u0026#34;docker-runner\u0026#34; \\  --tag-list \u0026#34;docker,aws\u0026#34; \\  --run-untagged=\u0026#34;true\u0026#34; \\  --locked=\u0026#34;false\u0026#34; \\  --access-level=\u0026#34;not_protected\u0026#34; config.toml privileged å¦‚æœé‡åˆ°mkdir permission deniedï¼Œè®¾ä¸ºtrueï¼Œå¯ä»¥è§£å†³\n[[runners]] name = \u0026#34;python3.7\u0026#34; url = \u0026#34;http://192.168.8.226/\u0026#34; token = \u0026#34;xxxxxx\u0026#34; executor = \u0026#34;docker\u0026#34; [runners.custom_build_dir] [runners.docker] tls_verify = false image = \u0026#34;python:3.7\u0026#34; privileged = true disable_entrypoint_overwrite = false oom_kill_disable = false disable_cache = false volumes = [\u0026#34;/cache\u0026#34;] shm_size = 0 pull_policy = \u0026#34;if-not-present\u0026#34; network_mode = \u0026#34;host\u0026#34; [runners.cache] [runners.cache.s3] [runners.cache.gcs] [runners.custom] run_exec = \u0026#34;\u0026#34; cache with local files. Npm example:\nvolumes = [\u0026quot;/opt/gitlab-runner/cache:/cache\u0026quot;] ls /opt/gitlab-runner/cache/GROUP/PROJECT_NAME/builds/GROUP/PROJECT_NAME cache.zip cache.zip is the node_modules.zip file.\n.gitlab-ci.yml  Use the ssh connect development machine and run the shell command to update the project. cache after the CI. The runner will cache the pip and venv packages.  # This file is a template, and might need editing before it works on your project. image: python:3.7 # This folder is cached between builds # http://docs.gitlab.com/ce/ci/yaml/README.html#cache cache: paths: - .cache/pip - venv/ before_script: ## ## Install ssh-agent if not already installed, it is required by Docker. ## (change apt-get to yum if you use an RPM-based image) ## - \u0026#39;which ssh-agent || ( apt-get update -y \u0026amp;\u0026amp; apt-get install openssh-client -y )\u0026#39; ## ## Run ssh-agent (inside the build environment) ## - eval $(ssh-agent -s) ## ## Add the SSH key stored in SSH_PRIVATE_KEY variable to the agent store ## We\u0026#39;re using tr to fix line endings which makes ed25519 keys work ## without extra base64 encoding. ## https://gitlab.com/gitlab-examples/ssh-private-key/issues/1#note_48526556 ## - echo \u0026#34;$SSH_PRIVATE_KEY\u0026#34; \u0026gt; deploy.key - chmod 0600 deploy.key - ssh-add deploy.key - mkdir -p ~/.ssh - chmod 700 ~/.ssh - \u0026#39;[[ -f /.dockerenv ]] \u0026amp;\u0026amp; echo -e \u0026#34;Host *\\n\\tStrictHostKeyChecking no\\n\\n\u0026#34; \u0026gt; ~/.ssh/config\u0026#39; ## ## Optionally, if you will be using any Git commands, set the user name and ## and email. ## #- git config --global user.email \u0026#34;user@example.com\u0026#34; #- git config --global user.name \u0026#34;User name\u0026#34; - python -V  # Print out python version for debugging test: script: - python -m venv ./venv - source venv/bin/activate - pip install -U -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/ - cd lq_end # - cp -f config/ci.py config/config.py # - python manage.py devops drop_and_recreate_ci_database # - flask db upgrade # - flask init-db - python -m pytest --cov=. - ssh root@192.168.8.109 \u0026#34;cd /root/test-project \u0026amp;\u0026amp; ./script.sh\u0026#34; #pep8: # script: # - python -m venv ./venv # - source venv/bin/activate # - pip install -U flake8 # - cd projectpath # - flake8 ","permalink":"http://localhost:8000/posts/devops/gitlab/gitlab-ci-cd/","summary":"Gitlab CI/CD For the development environment.\nInstall with docker Read the official documentation for how to install docker.\nI installed docker on the MacOS.\ngitlab documentation\nsudo docker run --detach \\  --hostname 192.168.8.226 \\  --publish 443:443 --publish 80:80 --publish 8022:22 \\  --name gitlab \\  --restart always \\  --volume ~/gitlab/config:/etc/gitlab \\  --volume ~/gitlab/logs:/var/log/gitlab \\  --volume ~/gitlab/data:/var/opt/gitlab \\  gitlab/gitlab-ce:latest gitlab-runner Order of initialization:\n install register custom config  documentation","title":"Gitlab CI/CD"},{"content":"Apache Bench Test   GET\nab -c 10 -n 40 http://127.0.0.1:8000/api/v1/mzitu/tags/\n  POST, https://blog.csdn.net/chenggong2dm/article/details/51850923\nab -n 1 -c 1 -p f:/postdata.txt -T application/x-www-form-urlencoded \u0026ldquo;http://127.0.0.1/abpost\u0026rdquo; ab -n 100 -c 10 -p data.json -T application/json http://127.0.0.1/api\n  // postdata.txt ","permalink":"http://localhost:8000/posts/test/ab-test/","summary":"Apache Bench Test   GET\nab -c 10 -n 40 http://127.0.0.1:8000/api/v1/mzitu/tags/\n  POST, https://blog.csdn.net/chenggong2dm/article/details/51850923\nab -n 1 -c 1 -p f:/postdata.txt -T application/x-www-form-urlencoded \u0026ldquo;http://127.0.0.1/abpost\u0026rdquo; ab -n 100 -c 10 -p data.json -T application/json http://127.0.0.1/api\n  // postdata.txt ","title":"Apache Bench Test"},{"content":"Prometheus ç®€ä»‹ æ¦‚å¿µ  prometheus server exporterï¼Œç”¨äºserveré‡‡é›†æ•°æ®ï¼Œæœ‰å®˜æ–¹æä¾›çš„node-exporterï¼Œä¹Ÿå¯ä»¥é€šè¿‡å„ç§SDKè‡ªå®šä¹‰å¯¼å‡ºå†…å®¹ï¼Œæš´éœ²ä¸€ä¸ªç±»ä¼¼/metricsçš„è·¯å¾„ç”¨äºé‡‡é›†  æ³¨æ„ï¼Œexporteråœ¨å¤šè¿›ç¨‹ï¼ˆgunicorn å¤šè¿›ç¨‹ï¼‰æ¨¡å¼ä¸‹ä½¿ç”¨ä¼šæœ‰é™åˆ¶ï¼Œå‚è€ƒæ–‡æ¡£   æ•°æ®æ¨¡å‹ï¼Œå’Œinfluxdbç±»ä¼¼ï¼Œæ˜¯æ—¶åºæ•°æ®åº“ï¼Œä»¥metricä¸ºåç§°ï¼Œå¤šä¸ªlabelï¼ˆkey-valueå½¢å¼ï¼‰ç»„æˆï¼š\u0026lt;metric name\u0026gt;{\u0026lt;label name\u0026gt;=\u0026lt;label value\u0026gt;, ...}  é‡è½½é…ç½® Yes, sending SIGHUP to the Prometheus process or an HTTP POST request to the /-/reload endpoint will reload and apply the configuration file. The various components attempt to handle failing changes gracefully.\n","permalink":"http://localhost:8000/posts/k3s/prometheus/","summary":"Prometheus ç®€ä»‹ æ¦‚å¿µ  prometheus server exporterï¼Œç”¨äºserveré‡‡é›†æ•°æ®ï¼Œæœ‰å®˜æ–¹æä¾›çš„node-exporterï¼Œä¹Ÿå¯ä»¥é€šè¿‡å„ç§SDKè‡ªå®šä¹‰å¯¼å‡ºå†…å®¹ï¼Œæš´éœ²ä¸€ä¸ªç±»ä¼¼/metricsçš„è·¯å¾„ç”¨äºé‡‡é›†  æ³¨æ„ï¼Œexporteråœ¨å¤šè¿›ç¨‹ï¼ˆgunicorn å¤šè¿›ç¨‹ï¼‰æ¨¡å¼ä¸‹ä½¿ç”¨ä¼šæœ‰é™åˆ¶ï¼Œå‚è€ƒæ–‡æ¡£   æ•°æ®æ¨¡å‹ï¼Œå’Œinfluxdbç±»ä¼¼ï¼Œæ˜¯æ—¶åºæ•°æ®åº“ï¼Œä»¥metricä¸ºåç§°ï¼Œå¤šä¸ªlabelï¼ˆkey-valueå½¢å¼ï¼‰ç»„æˆï¼š\u0026lt;metric name\u0026gt;{\u0026lt;label name\u0026gt;=\u0026lt;label value\u0026gt;, ...}  é‡è½½é…ç½® Yes, sending SIGHUP to the Prometheus process or an HTTP POST request to the /-/reload endpoint will reload and apply the configuration file. The various components attempt to handle failing changes gracefully.","title":"Prometheus"},{"content":"PyCharm ä½¿ç”¨ Docker pycharm use docker for development and stage\nDevelopment  ä½¿ç”¨windowså’Œvirtualboxï¼Œæ²¡æœ‰æ‰“å¼€hyper-væ‰€ä»¥æ— æ³•ä½¿ç”¨dockerï¼Œåœ¨è™šæ‹Ÿæœºä¸­ä½¿ç”¨dockerå¹¶æ‰“å¼€tcpï¼Œä½†æ˜¯ç”±äºvolumeåªèƒ½æŒ‚è½½å®¿ä¸»æœºï¼Œæ‰€ä»¥è¦å…ˆç”¨pycharmmå°†æ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹çš„æ˜ å°„ç›®å½•ï¼Œå†ä½¿ç”¨ã€‚  æ­¤æ–¹æ³•é€‚åˆè¿˜æ²¡æœ‰å‡†å¤‡å¼€å‘ç¯å¢ƒå’Œéœ€è¦ä½¿ç”¨dockerä½œä¸ºå¼€å‘ç¯å¢ƒï¼Œä½†æ˜¯windowsæœ¬æœºæ²¡æœ‰dockerçš„æƒ…å†µ æˆ‘å·²ä½¿ç”¨è™šæ‹Ÿæœºå’Œpycharmè¿œç¨‹åŒæ­¥åŠŸèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœ   åœ¨å®¿ä¸»æœºä¸­å¼€å‘æ—¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†dockeré…ç½®é›†æˆåˆ°configurationä¸­  Stage PyCharmçš„dockerä¹Ÿæ”¯æŒä¿®æ”¹registryï¼Œå¦‚æœæœ‰è¿œç¨‹ä»“åº“éœ€è¦çš„ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿åˆ†å‘é•œåƒ\n","permalink":"http://localhost:8000/posts/pycharm/docker/","summary":"PyCharm ä½¿ç”¨ Docker pycharm use docker for development and stage\nDevelopment  ä½¿ç”¨windowså’Œvirtualboxï¼Œæ²¡æœ‰æ‰“å¼€hyper-væ‰€ä»¥æ— æ³•ä½¿ç”¨dockerï¼Œåœ¨è™šæ‹Ÿæœºä¸­ä½¿ç”¨dockerå¹¶æ‰“å¼€tcpï¼Œä½†æ˜¯ç”±äºvolumeåªèƒ½æŒ‚è½½å®¿ä¸»æœºï¼Œæ‰€ä»¥è¦å…ˆç”¨pycharmmå°†æ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹çš„æ˜ å°„ç›®å½•ï¼Œå†ä½¿ç”¨ã€‚  æ­¤æ–¹æ³•é€‚åˆè¿˜æ²¡æœ‰å‡†å¤‡å¼€å‘ç¯å¢ƒå’Œéœ€è¦ä½¿ç”¨dockerä½œä¸ºå¼€å‘ç¯å¢ƒï¼Œä½†æ˜¯windowsæœ¬æœºæ²¡æœ‰dockerçš„æƒ…å†µ æˆ‘å·²ä½¿ç”¨è™šæ‹Ÿæœºå’Œpycharmè¿œç¨‹åŒæ­¥åŠŸèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœ   åœ¨å®¿ä¸»æœºä¸­å¼€å‘æ—¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†dockeré…ç½®é›†æˆåˆ°configurationä¸­  Stage PyCharmçš„dockerä¹Ÿæ”¯æŒä¿®æ”¹registryï¼Œå¦‚æœæœ‰è¿œç¨‹ä»“åº“éœ€è¦çš„ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿åˆ†å‘é•œåƒ","title":"PyCharm Docker"},{"content":"Djangoæ‰“å¼€gzipå¯¼è‡´æ–‡ä»¶æµcontent-lengthä¸¢å¤± code GZipMiddleware\nuse gzip middleware will del response['Content-Length'] if response.streaming. nginx gzip is the same problem.\nIf file feature is important. You\u0026rsquo;d better be independent from the api or system.\n","permalink":"http://localhost:8000/posts/django/gzip/","summary":"Djangoæ‰“å¼€gzipå¯¼è‡´æ–‡ä»¶æµcontent-lengthä¸¢å¤± code GZipMiddleware\nuse gzip middleware will del response['Content-Length'] if response.streaming. nginx gzip is the same problem.\nIf file feature is important. You\u0026rsquo;d better be independent from the api or system.","title":"Djangoæ‰“å¼€gzipå¯¼è‡´æ–‡ä»¶æµcontent-lengthä¸¢å¤±"},{"content":"k3s åˆæ¬¡ä½¿ç”¨ multipass ç¯å¢ƒå‡†å¤‡  quick-start å‚è€ƒ1 å‚è€ƒ2  # k3s1 node for master 192.168.64.5 multipass launch -v --name k3s1 20.04 multipass shell k3s1 curl -sfL https://get.k3s.io | sh - # default config sudo cat /etc/rancher/k3s/k3s.yaml # node-token sudo cat /var/lib/rancher/k3s/server/node-token # Check for Ready node, takes maybe 30 seconds sudo kubectl get nodes # k3s2 node 192.168.64.6 multipass launch -v --name k3s2 20.04 multipass shell k3s2 # add node to cluster # token in master cat /var/lib/rancher/k3s/server/node-token # K3S_NODE_NAME for unique hostname export K3S_TOKEN=x export K3S_URL=https://192.168.1.21:6443 curl -sfL https://get.k3s.io | K3S_URL=${K3S_URL} K3S_TOKEN=${K3S_TOKEN} sh - # if not register successfully, æŸ¥çœ‹æ—¥å¿—å¯èƒ½æ˜¯å› ä¸ºä¹‹å‰æœ‰é‡å¤node hostname # åŸå› ï¼šhttps://github.com/rancher/k3s/issues/802 ç§»é™¤nodeæ²¡æœ‰ä¸€åŒç§»é™¤å¯†ç  sudo vim /var/lib/rancher/k3s/server/cred/node-passwd æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼š\nsudo kubectl get nodes  dashboard kube-dashboard\ninstall\nGITHUB_URL=https://github.com/kubernetes/dashboard/releases VERSION_KUBE_DASHBOARD=$(curl -w \u0026#39;%{url_effective}\u0026#39; -I -L -s -S ${GITHUB_URL}/latest -o /dev/null | sed -e \u0026#39;s|.*/||\u0026#39;) sudo k3s kubectl create -f https://raw.githubusercontent.com/kubernetes/dashboard/${VERSION_KUBE_DASHBOARD}/aio/deploy/recommended.yaml Dashboard RBAC Configuration\ndashboard.admin-user.yml\napiVersion: v1 kind: ServiceAccount metadata: name: admin-user namespace: kubernetes-dashboard dashboard.admin-user-role.yml\napiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: admin-user roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: admin-user namespace: kubernetes-dashboard sudo k3s kubectl create -f dashboard.admin-user.yml -f dashboard.admin-user-role.yml Obtain the Bearer Token, ç”¨äºtokenç™»å½•dashboard\nsudo k3s kubectl -n kubernetes-dashboard describe secret admin-user-token | grep ^token access\nhttp://192.168.64.5:6443/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/  ingress k3s é»˜è®¤ä½¿ç”¨çš„æ˜¯traefikï¼Œk8sæ¨èçš„æ˜¯GCEå’Œingress-nginxã€‚\nä½†æ˜¯traefiké»˜è®¤é…ç½®: /var/lib/rancher/k3s/server/manifests/traefik.yaml æ²¡æœ‰å¼€å¯dashboardã€‚å°è¯•æ‰“å¼€ï¼š\næŸ¥çœ‹å½“å‰é…ç½®ï¼š\nkubectl describe deploy traefik -n kube-system  å¾—çŸ¥é…ç½®æ˜¯ä½¿ç”¨çš„ /config çš„volumeï¼š\nkubectl describe configmap traefik -n kube-system  æ·»åŠ setéƒ¨åˆ†å†…å®¹ï¼š\nset: dashboard.enabled: \u0026quot;true\u0026quot;  traefik.yml\nroot@k3s1:/var/lib/rancher/k3s/server/manifests# cat traefik.yaml  apiVersion: helm.cattle.io/v1 kind: HelmChart metadata: name: traefik namespace: kube-system spec: chart: https://%{KUBERNETES_API}%/static/charts/traefik-1.81.0.tgz set: dashboard.enabled: \u0026#34;true\u0026#34; valuesContent: |-rbac: enabled: true ssl: enabled: true metrics: prometheus: enabled: true kubernetes: ingressEndpoint: useDefaultPublishedService: true image: \u0026#34;rancher/library-traefik\u0026#34; tolerations: - key: \u0026#34;CriticalAddonsOnly\u0026#34; operator: \u0026#34;Exists\u0026#34; - key: \u0026#34;node-role.kubernetes.io/master\u0026#34; operator: \u0026#34;Exists\u0026#34; effect: \u0026#34;NoSchedule\u0026#34; å¦‚ä½•é…ç½®ingressï¼Œé…åˆä¸€ä¸ªdjangoçš„sample\napiVersion: extensions/v1beta1 kind: Ingress metadata: name: my-server spec: rules: - host: my-server.192.168.1.22.xip.io http: paths: - path: /jobs backend: serviceName: web servicePort: 8080 - path: /static backend: serviceName: web servicePort: 8080 cheat sheet cheatsheet\nnginx demo in k3s2 machine\nmkdir ~/controllers cat \u0026gt; nginx-deployment.yaml \u0026lt;\u0026lt;EOL apiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment labels: app: nginx spec: replicas: 3 selector: matchLabels: app: nginx template: metadata: labels: app: nginx spec: containers: - name: nginx image: nginx:1.14.2 ports: - containerPort: 80 EOL é—®é¢˜  vagrant nat 10.0.2.15ç½‘ç»œé—®é¢˜ï¼Œserver/agent é€‰æ‹©å¯¹åº”çš„ç½‘ç»œå¯åŠ¨ï¼Œä¸ç„¶é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª  sudo vim /etc/systemd/system/k3s-agent.service sudo vim /etc/systemd/system/k3s.service ExecStart=/usr/local/bin/k3s \\ server --flannel-iface=enp0s8 \\  é•œåƒ docker.io åŠ é€Ÿï¼Œåœ¨containerdçš„configä¸­åŠ å…¥åœ°å€ï¼Œhttp://www.zzfly.net/k3s-installation-and-containerd-registry/  [plugins.cri.registry.mirrors] [plugins.cri.registry.mirrors.\u0026#34;docker.io\u0026#34;] endpoint = [\u0026#34;https://docker.mirrors.ustc.edu.cn\u0026#34;] root@k3s1:/vagrant/samples-master/django# cd /var/lib/rancher/k3s/agent/etc/containerd/ root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# ls config.toml root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# cp config.toml config.toml.tmpl root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# vim config.toml.tmpl root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# systemctl restart k3s root@k3s1:/var/lib/rancher/k3s/agent/etc/containerd# crictl info | grep registry -C 10 } }, \u0026quot;noPivot\u0026quot;: false }, \u0026quot;cni\u0026quot;: { \u0026quot;binDir\u0026quot;: \u0026quot;/var/lib/rancher/k3s/data/572dcee7aa63e8f11e61142e4b0fc4f7ce33a0a6fed6a72924c6f6be85781b10/bin\u0026quot;, \u0026quot;confDir\u0026quot;: \u0026quot;/var/lib/rancher/k3s/agent/etc/cni/net.d\u0026quot;, \u0026quot;maxConfNum\u0026quot;: 1, \u0026quot;confTemplate\u0026quot;: \u0026quot;\u0026quot; }, \u0026quot;registry\u0026quot;: { \u0026quot;mirrors\u0026quot;: { \u0026quot;docker.io\u0026quot;: { \u0026quot;endpoint\u0026quot;: [ \u0026quot;https://docker.mirrors.ustc.edu.cn\u0026quot; ] } }, \u0026quot;configs\u0026quot;: null, \u0026quot;auths\u0026quot;: null }, ","permalink":"http://localhost:8000/posts/k3s/k3s/","summary":"k3s åˆæ¬¡ä½¿ç”¨ multipass ç¯å¢ƒå‡†å¤‡  quick-start å‚è€ƒ1 å‚è€ƒ2  # k3s1 node for master 192.168.64.5 multipass launch -v --name k3s1 20.04 multipass shell k3s1 curl -sfL https://get.k3s.io | sh - # default config sudo cat /etc/rancher/k3s/k3s.yaml # node-token sudo cat /var/lib/rancher/k3s/server/node-token # Check for Ready node, takes maybe 30 seconds sudo kubectl get nodes # k3s2 node 192.168.64.6 multipass launch -v --name k3s2 20.04 multipass shell k3s2 # add node to cluster # token in master cat /var/lib/rancher/k3s/server/node-token # K3S_NODE_NAME for unique hostname export K3S_TOKEN=x export K3S_URL=https://192.","title":"k3s"},{"content":"Golang æ­å»ºç¯å¢ƒ Golang å¼€å‘ç¯å¢ƒå‡†å¤‡å’Œå·¥å…·é€‰æ‹©\nå‚è€ƒAlikhll/golang-developer-roadmapã€‚\næ›´å¤šå…³äºgolangçš„åˆ†äº«ï¼Œå‚è€ƒAwesome-go\nç¯å¢ƒå‡†å¤‡  åŠ é€Ÿ/ç§æœ‰æ¨¡å—  å¼€å‘ç¼–è¾‘å™¨/IDE  vim vscode goland  è½¯ä»¶é€‰æ‹©  CLIå·¥å…·å¼€å‘  cobra   Web  GinğŸº EchoğŸº Beego go-swagger Iris   ORM  GormğŸº Xorm   DB  PGğŸº RedisğŸº MongoDB   Log  Zap Logrus   Websocket  gorilla/websocket   Task schedule  Gron    CI/CD  gitlab CI/CD githu actions teamcity  éƒ¨ç½²é€‰æ‹©  docker supervisor  ","permalink":"http://localhost:8000/posts/golang/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/","summary":"Golang æ­å»ºç¯å¢ƒ Golang å¼€å‘ç¯å¢ƒå‡†å¤‡å’Œå·¥å…·é€‰æ‹©\nå‚è€ƒAlikhll/golang-developer-roadmapã€‚\næ›´å¤šå…³äºgolangçš„åˆ†äº«ï¼Œå‚è€ƒAwesome-go\nç¯å¢ƒå‡†å¤‡  åŠ é€Ÿ/ç§æœ‰æ¨¡å—  å¼€å‘ç¼–è¾‘å™¨/IDE  vim vscode goland  è½¯ä»¶é€‰æ‹©  CLIå·¥å…·å¼€å‘  cobra   Web  GinğŸº EchoğŸº Beego go-swagger Iris   ORM  GormğŸº Xorm   DB  PGğŸº RedisğŸº MongoDB   Log  Zap Logrus   Websocket  gorilla/websocket   Task schedule  Gron    CI/CD  gitlab CI/CD githu actions teamcity  éƒ¨ç½²é€‰æ‹©  docker supervisor  ","title":"golang å¤§å¥–ç¯å¢ƒ"},{"content":"multipass to set development environment å®˜ç½‘\næŒ‡å®šé…ç½® $ multipass launch --name XXX -c 2 -d 20G -m 2G  åˆ é™¤ $ multipass delete --purge XXXXX  é—®é¢˜  macosä¸‹é¢ä½¿ç”¨virtualboxæš‚æ—¶æ‹¿ä¸åˆ°ipï¼Œåªèƒ½ä½¿ç”¨NATï¼Œæœ€å¥½ä½¿ç”¨hyperkit windowsä¸‹é¢ä¹Ÿä¸è¡Œï¼Œå°è¯•æ·»åŠ ç¬¬äºŒä¸ªç½‘ç»œ(guiæ“ä½œ or vboxmanager)ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†æ¡¥æ¥ï¼Œä¹‹åä¿®æ”¹/etc/network/interfaceså¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œé‡å¯ä¹‹åæŸ¥çœ‹ç½‘å¡èƒ½è·å¾—ip  # ubuntu 18.04 allow-hotplug enp0s8 iface enp0s8 inet static address 10.200.242.200 netmask 255.0.0.0 gateway 10.0.0.3  ubuntu20.04æ“ä½œ:  ä¿®æ”¹ /etc/netplan/50-cloud-init.yaml åº”ç”¨ sudo netplan apply é‡å¯ sudo reboot    # ubuntu 20.04 /etc/netplan/50-cloud-init.yaml network: ethernets: enp0s3: dhcp4: true match: macaddress: 08:00:27:bc:97:36 set-name: enp0s3 version: 2 # change like following part network: ethernets: enp0s3: dhcp4: false addresses: [10.200.242.200/8] gateway4: 10.0.0.3 nameservers: addresses: [8.8.8.8, 8.8.4.4] match: macaddress: 08:00:27:bc:97:36 set-name: enp0s3 version: 2 ","permalink":"http://localhost:8000/posts/linux/ubuntu/multipass/","summary":"multipass to set development environment å®˜ç½‘\næŒ‡å®šé…ç½® $ multipass launch --name XXX -c 2 -d 20G -m 2G  åˆ é™¤ $ multipass delete --purge XXXXX  é—®é¢˜  macosä¸‹é¢ä½¿ç”¨virtualboxæš‚æ—¶æ‹¿ä¸åˆ°ipï¼Œåªèƒ½ä½¿ç”¨NATï¼Œæœ€å¥½ä½¿ç”¨hyperkit windowsä¸‹é¢ä¹Ÿä¸è¡Œï¼Œå°è¯•æ·»åŠ ç¬¬äºŒä¸ªç½‘ç»œ(guiæ“ä½œ or vboxmanager)ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†æ¡¥æ¥ï¼Œä¹‹åä¿®æ”¹/etc/network/interfaceså¡«å†™ç›¸å…³ä¿¡æ¯ï¼Œé‡å¯ä¹‹åæŸ¥çœ‹ç½‘å¡èƒ½è·å¾—ip  # ubuntu 18.04 allow-hotplug enp0s8 iface enp0s8 inet static address 10.200.242.200 netmask 255.0.0.0 gateway 10.0.0.3  ubuntu20.04æ“ä½œ:  ä¿®æ”¹ /etc/netplan/50-cloud-init.yaml åº”ç”¨ sudo netplan apply é‡å¯ sudo reboot    # ubuntu 20.04 /etc/netplan/50-cloud-init.yaml network: ethernets: enp0s3: dhcp4: true match: macaddress: 08:00:27:bc:97:36 set-name: enp0s3 version: 2 # change like following part network: ethernets: enp0s3: dhcp4: false addresses: [10.","title":"Multipass"},{"content":"åˆ©ç”¨proxy è§£å†³ Django Vue å¼€å‘ç¯å¢ƒä¸­çš„è·¨åŸŸé—®é¢˜ æœ€è¿‘ä½¿ç”¨ Django+Vueçš„ç»„åˆå¿«é€Ÿçš„åšä¸€ä¸ªé¡¹ç›®ï¼Œå‰æ®µä¹‹å‰æœ‰çœ‹è¿‡ï¼Œä½†æ˜¯åªæ˜¯ğŸ‘€ä¼šäº†ï¼Œè¿™æ¬¡å®é™…æ“ä½œï¼Œåœ¨å‰åç«¯åˆ†ç¦»åçš„å¼€å‘ç¯å¢ƒä¸­è¸©äº†å‘ã€‚\nç¯å¢ƒ  Django + DRF Django Channelsï¼Œä¸»è¦æ˜¯websocket vue-admin-templateï¼Œä¸€ä¸ªå¼€æºçš„é¡¹ç›®ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æœ‰å®ç°ï¼Œæ–°æ‰‹å¯ä»¥ç”¨æ¥æ”¹æ”¹å°±ç”¨ï¼Œè¿˜èƒ½å­¦ä¹   å¼€å‘ç¯å¢ƒï¼š\n wsgi, 8000 asgi, 8001 vue, 9528  é—®é¢˜  æƒ³åƒåœ¨ä½¿ç”¨nginxä¸€æ ·çš„é€æ˜çš„ä½¿ç”¨å¼€å‘ç¯å¢ƒ djangoå·²ç»é…ç½®äº†corsheaders middlewareäº† å°è¯• axiosæ˜¾ç¤ºæŒ‡å®šåœ°å€å’Œç«¯å£åˆ°8000çš„æœåŠ¡ä¸Šï¼Œè§£å†³äº†axioså®ä¾‹çš„è®¿é—®ï¼Œä½†æ˜¯ä½¿ç”¨ el-uploadçš„è¡¨å•æ—¶ï¼Œå‘ç°å°±ä¸å¥½ä½¿äº†ï¼Œlocalhostå’Œå…¶ä»–ä¸åŒåŸŸï¼Œæ‹¿ä¸åˆ° cookieä¸­çš„csrftokenï¼Œå¯¼è‡´è¢« djangoæ‹’ç»  è§£å†³ åœ¨æŸ¥çœ‹äº†å„ç§æ–‡æ¡£åï¼Œæœ€æœ‰æ•ˆçš„æ–¹æ¡ˆæ˜¯devServerçš„proxyï¼Œè¿™æ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„æ˜¯http-proxy-middlewareè¿™ä¸ªä¸­é—´ä»¶ï¼Œæ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œå¯ä»¥çœ‹çœ‹ã€‚\nç›®æ ‡ï¼š\n ä»£ç† /apiçš„è¯·æ±‚åˆ°8000ç«¯å£çš„wsgi server ä»£ç† /wsçš„è¯·æ±‚åˆ°8001çš„asgi server   /api ---\u0026gt; localhost:8000/api localhost:9528 (cookie) -- /ws ---\u0026gt; localhost:8001/ws vue.conf.js\ndevServer: { ... proxy: { [process.env.VUE_APP_BASE_API]: { target: \u0026#39;http://127.0.0.1:8000\u0026#39;, changeOrigin: true, ws: false, pathRewrite: { [\u0026#39;^\u0026#39; + process.env.VUE_APP_BASE_API]: \u0026#39;\u0026#39; }, cookieDomainRewrite: { \u0026#39;*\u0026#39;: \u0026#39;localhost\u0026#39; } }, \u0026#39;/ws\u0026#39;: { target: \u0026#39;ws://127.0.0.1:8001\u0026#39;, // changeOrigin: true,  secure: false, ws: true } } ... } è¯´æ˜ï¼š\n proxyé‡Œé¢çš„keyè¡¨ç¤ºè¦ä»£ç†çš„pathï¼Œæˆ‘è¿™é‡Œå†™çš„æ˜¯å˜é‡ä»£è¡¨çš„å€¼ï¼Œæ˜¯ä»å…¶ä»–åœ°æ–¹çœ‹åˆ°çš„ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ¤æ–­ï¼Œæ¯”å¦‚ /api-prod /api-devç­‰ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®å®é™…çš„å‘½åè§„åˆ™ï¼Œä¸€èˆ¬æ˜¯/apiå³å¯ targetï¼šè¡¨ç¤ºè¦ä»£ç†çš„è¯·æ±‚ç›®æ ‡ changeOriginï¼šè¡¨ç¤ºä¿®æ”¹è¯·æ±‚headerä¸­çš„origin wsï¼šè¡¨ç¤ºæ˜¯å¦ä»£ç†websockets pathRewriteï¼šæ ¹æ®æ­£åˆ™åŒ¹é…æ¥é‡å†™urlï¼Œæ ¹æ®å®é™…éœ€è¦æ¥å†™ cookieDomainRewriteï¼Œ{ '*': 'localhost' }è¡¨ç¤ºæ‰€æœ‰é‡å†™åˆ°localhostï¼Œè¿™æ ·æ‰€æœ‰çš„cookieéƒ½ä¼šåŒæ­¥è¿‡æ¥ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨äº†django sessionå’Œcrsftokenï¼Œæ‰€ä»¥è¿™é‡Œå¾—åŒæ­¥ä¸€ä¸‹ï¼Œä¸ç„¶ä¼šæœ‰å‰é¢è¯´çš„axios headerä¸­æœ‰X-CRSFTokenï¼Œè€Œç›´æ¥è¯·æ±‚çš„formè¡¨å•ä¸­æ²¡æœ‰ï¼Œå› ä¸ºcookieä¸åŒï¼Œå–ä¸åˆ°csrftokençš„å€¼  ","permalink":"http://localhost:8000/posts/vue/cors/","summary":"åˆ©ç”¨proxy è§£å†³ Django Vue å¼€å‘ç¯å¢ƒä¸­çš„è·¨åŸŸé—®é¢˜ æœ€è¿‘ä½¿ç”¨ Django+Vueçš„ç»„åˆå¿«é€Ÿçš„åšä¸€ä¸ªé¡¹ç›®ï¼Œå‰æ®µä¹‹å‰æœ‰çœ‹è¿‡ï¼Œä½†æ˜¯åªæ˜¯ğŸ‘€ä¼šäº†ï¼Œè¿™æ¬¡å®é™…æ“ä½œï¼Œåœ¨å‰åç«¯åˆ†ç¦»åçš„å¼€å‘ç¯å¢ƒä¸­è¸©äº†å‘ã€‚\nç¯å¢ƒ  Django + DRF Django Channelsï¼Œä¸»è¦æ˜¯websocket vue-admin-templateï¼Œä¸€ä¸ªå¼€æºçš„é¡¹ç›®ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æœ‰å®ç°ï¼Œæ–°æ‰‹å¯ä»¥ç”¨æ¥æ”¹æ”¹å°±ç”¨ï¼Œè¿˜èƒ½å­¦ä¹   å¼€å‘ç¯å¢ƒï¼š\n wsgi, 8000 asgi, 8001 vue, 9528  é—®é¢˜  æƒ³åƒåœ¨ä½¿ç”¨nginxä¸€æ ·çš„é€æ˜çš„ä½¿ç”¨å¼€å‘ç¯å¢ƒ djangoå·²ç»é…ç½®äº†corsheaders middlewareäº† å°è¯• axiosæ˜¾ç¤ºæŒ‡å®šåœ°å€å’Œç«¯å£åˆ°8000çš„æœåŠ¡ä¸Šï¼Œè§£å†³äº†axioså®ä¾‹çš„è®¿é—®ï¼Œä½†æ˜¯ä½¿ç”¨ el-uploadçš„è¡¨å•æ—¶ï¼Œå‘ç°å°±ä¸å¥½ä½¿äº†ï¼Œlocalhostå’Œå…¶ä»–ä¸åŒåŸŸï¼Œæ‹¿ä¸åˆ° cookieä¸­çš„csrftokenï¼Œå¯¼è‡´è¢« djangoæ‹’ç»  è§£å†³ åœ¨æŸ¥çœ‹äº†å„ç§æ–‡æ¡£åï¼Œæœ€æœ‰æ•ˆçš„æ–¹æ¡ˆæ˜¯devServerçš„proxyï¼Œè¿™æ˜¯webpackæä¾›çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„æ˜¯http-proxy-middlewareè¿™ä¸ªä¸­é—´ä»¶ï¼Œæ–‡æ¡£å¾ˆè¯¦ç»†ï¼Œå¯ä»¥çœ‹çœ‹ã€‚\nç›®æ ‡ï¼š\n ä»£ç† /apiçš„è¯·æ±‚åˆ°8000ç«¯å£çš„wsgi server ä»£ç† /wsçš„è¯·æ±‚åˆ°8001çš„asgi server   /api ---\u0026gt; localhost:8000/api localhost:9528 (cookie) -- /ws ---\u0026gt; localhost:8001/ws vue.conf.js\ndevServer: { ... proxy: { [process.env.VUE_APP_BASE_API]: { target: \u0026#39;http://127.0.0.1:8000\u0026#39;, changeOrigin: true, ws: false, pathRewrite: { [\u0026#39;^\u0026#39; + process.","title":"vue cors"},{"content":"docker env file åœ¨docker-compose ä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å¯¼å…¥.envfileã€‚\nweb: build: . restart: always working_dir: /deploy/mysite command: ./service_web.sh env_file: - .env # environments .env\nDOCKER=1 HOME=/deploy æƒ³ç”¨shell scriptåŠ¨æ€è·å–ç¯å¢ƒçš„CPU count å¦‚æœç›´æ¥åœ¨.env ä¸­å†™å¦‚ä¸‹çš„å†…å®¹ï¼Œä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š\nCPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l)  æ‰€ä»¥ï¼Œåœ¨webæœåŠ¡çš„command: ./service_web.shè„šæœ¬ä¸­exportä¸€ä¸ªå˜é‡ï¼Œå¹¶åœ¨gunicornä¸­ä½¿ç”¨ï¼š\n#!/bin/bash sleep 5 export CPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l) python manage.py collectstatic -v0 --noinput python manage.py migrate --noinput /usr/local/bin/gunicorn -w $((2*$CPU_NUM+1)) -b unix:/deploy/running/handle/django-tutorial-server.sock mysite.wsgi:application --log-level info ","permalink":"http://localhost:8000/posts/docker/env/","summary":"docker env file åœ¨docker-compose ä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å¯¼å…¥.envfileã€‚\nweb: build: . restart: always working_dir: /deploy/mysite command: ./service_web.sh env_file: - .env # environments .env\nDOCKER=1 HOME=/deploy æƒ³ç”¨shell scriptåŠ¨æ€è·å–ç¯å¢ƒçš„CPU count å¦‚æœç›´æ¥åœ¨.env ä¸­å†™å¦‚ä¸‹çš„å†…å®¹ï¼Œä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š\nCPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l)  æ‰€ä»¥ï¼Œåœ¨webæœåŠ¡çš„command: ./service_web.shè„šæœ¬ä¸­exportä¸€ä¸ªå˜é‡ï¼Œå¹¶åœ¨gunicornä¸­ä½¿ç”¨ï¼š\n#!/bin/bash sleep 5 export CPU_NUM=$(cat /proc/cpuinfo |grep processor|wc -l) python manage.py collectstatic -v0 --noinput python manage.py migrate --noinput /usr/local/bin/gunicorn -w $((2*$CPU_NUM+1)) -b unix:/deploy/running/handle/django-tutorial-server.sock mysite.wsgi:application --log-level info ","title":"docker env file"},{"content":"docker ä½¿ç”¨ zshæ’ä»¶æ”¯æŒdockerå’Œdocker-composeï¼Œguiå·¥å…·åœ¨macå’Œwinä¸‹æœ‰kitemacticã€‚\nDockfile ç”¨äºæ„å»ºimageçš„æ–‡ä»¶ã€‚\ndocker-compose.yml ç®¡ç†å’Œä½¿ç”¨dockeræœåŠ¡çš„å·¥å…·ï¼Œå¯ä»¥ç±»ä¼¼vagrantçš„é…ç½®ï¼Œå¯ä»¥å¾ˆå¿«çš„ç¼–æ’éœ€è¦çš„servicesä»¥åŠnetworkså¹¶å¯åŠ¨ã€‚\n docker-compose -f YML-CONF-FILE upï¼Œå¯ä»¥æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œè¿™æ ·å¯ä»¥åŒºåˆ«æ­£å¼ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒçš„docker  upå¯ä»¥æ˜¯åˆ«æ²¡æœ‰çš„æœåŠ¡å¹¶é‡æ–°buildï¼Œä¹Ÿå¯ä»¥ç”¨\u0026ndash;buildå¼ºåˆ¶    é‡æ–°buildé•œåƒ ä¸ä½¿ç”¨ç¼“å­˜é‡æ–°buildã€‚ä¿®æ”¹é…ç½®åã€‚\ndocker build . --no-cache  ","permalink":"http://localhost:8000/posts/docker/usage/","summary":"docker ä½¿ç”¨ zshæ’ä»¶æ”¯æŒdockerå’Œdocker-composeï¼Œguiå·¥å…·åœ¨macå’Œwinä¸‹æœ‰kitemacticã€‚\nDockfile ç”¨äºæ„å»ºimageçš„æ–‡ä»¶ã€‚\ndocker-compose.yml ç®¡ç†å’Œä½¿ç”¨dockeræœåŠ¡çš„å·¥å…·ï¼Œå¯ä»¥ç±»ä¼¼vagrantçš„é…ç½®ï¼Œå¯ä»¥å¾ˆå¿«çš„ç¼–æ’éœ€è¦çš„servicesä»¥åŠnetworkså¹¶å¯åŠ¨ã€‚\n docker-compose -f YML-CONF-FILE upï¼Œå¯ä»¥æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨ï¼Œè¿™æ ·å¯ä»¥åŒºåˆ«æ­£å¼ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒçš„docker  upå¯ä»¥æ˜¯åˆ«æ²¡æœ‰çš„æœåŠ¡å¹¶é‡æ–°buildï¼Œä¹Ÿå¯ä»¥ç”¨\u0026ndash;buildå¼ºåˆ¶    é‡æ–°buildé•œåƒ ä¸ä½¿ç”¨ç¼“å­˜é‡æ–°buildã€‚ä¿®æ”¹é…ç½®åã€‚\ndocker build . --no-cache  ","title":"docker ä½¿ç”¨"},{"content":"docker åŠ é€Ÿ mac  ~/.docker/daemon.json æ·»åŠ å¦‚ä¸‹é…ç½®  { \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://registry.docker-cn.com\u0026#34;] } ","permalink":"http://localhost:8000/posts/docker/%E5%8A%A0%E9%80%9F/","summary":"docker åŠ é€Ÿ mac  ~/.docker/daemon.json æ·»åŠ å¦‚ä¸‹é…ç½®  { \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://registry.docker-cn.com\u0026#34;] } ","title":"docker åŠ é€Ÿ"},{"content":"docker å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥ åœ¨ä¸€ä¸ªåœ°æ–¹buildåå¯¼å…¥åˆ°å…¶ä»–åœ°æ–¹ä½¿ç”¨\nhttps://yeasy.gitbooks.io/docker_practice/container/import_export.html\nå¯¼å‡º $ docker container ls -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7691a814370e ubuntu:18.04 \u0026quot;/bin/bash\u0026quot; 36 hours ago Exited (0) 21 hours ago test $ docker export 7691a814370e \u0026gt; ubuntu.tar  å¯¼å…¥ $ cat ubuntu.tar | docker import - test/ubuntu:v1.0 $ docker image ls REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE test/ubuntu v1.0 9d37a6082e97 About a minute ago 171.3 MB  æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®š URL æˆ–è€…æŸä¸ªç›®å½•æ¥å¯¼å…¥ï¼Œä¾‹å¦‚\n$ docker import http://example.com/exampleimage.tgz example/imagerepo  æ³¨ï¼šç”¨æˆ·æ—¢å¯ä»¥ä½¿ç”¨ docker load æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ docker import æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ã€‚è¿™ä¸¤è€…çš„åŒºåˆ«åœ¨äºå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰çš„å†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä»…ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ã€‚æ­¤å¤–ï¼Œä»å®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°æŒ‡å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ã€‚\n","permalink":"http://localhost:8000/posts/docker/%E5%AE%B9%E5%99%A8%E5%AF%BC%E5%87%BA%E5%92%8C%E5%AF%BC%E5%85%A5/","summary":"docker å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥ åœ¨ä¸€ä¸ªåœ°æ–¹buildåå¯¼å…¥åˆ°å…¶ä»–åœ°æ–¹ä½¿ç”¨\nhttps://yeasy.gitbooks.io/docker_practice/container/import_export.html\nå¯¼å‡º $ docker container ls -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7691a814370e ubuntu:18.04 \u0026quot;/bin/bash\u0026quot; 36 hours ago Exited (0) 21 hours ago test $ docker export 7691a814370e \u0026gt; ubuntu.tar  å¯¼å…¥ $ cat ubuntu.tar | docker import - test/ubuntu:v1.0 $ docker image ls REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE test/ubuntu v1.0 9d37a6082e97 About a minute ago 171.3 MB  æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®š URL æˆ–è€…æŸä¸ªç›®å½•æ¥å¯¼å…¥ï¼Œä¾‹å¦‚","title":"docker å®¹å™¨å¯¼å‡ºå’Œå¯¼å…¥"},{"content":"docker å¿«é€Ÿæ‰©å®¹ ä»¥celery workerä¸ºä¾‹ã€‚å½“å¯åŠ¨docker-compose upåï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªcelery-workerå®¹å™¨åœ¨è¿è¡Œã€‚\nå¦‚æœè¦ä¸´æ—¶å¢åŠ ï¼Œå¯ä»¥ä½¿ç”¨--scaleå‚æ•°é…åˆupæŒ‡ä»¤ï¼Œæ¥å—å¤šä¸ªå®¹å™¨ä¼ é€’ï¼š\ndocker-compose up --scale web=2 celery-worker=3  ç»æµ‹è¯•ï¼Œå¤šä¸ªworkeréƒ½è·å¾—äº†å‘é€è¿‡æ¥çš„ä»»åŠ¡ã€‚\n","permalink":"http://localhost:8000/posts/docker/%E6%89%A9%E5%AE%B9/","summary":"docker å¿«é€Ÿæ‰©å®¹ ä»¥celery workerä¸ºä¾‹ã€‚å½“å¯åŠ¨docker-compose upåï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªcelery-workerå®¹å™¨åœ¨è¿è¡Œã€‚\nå¦‚æœè¦ä¸´æ—¶å¢åŠ ï¼Œå¯ä»¥ä½¿ç”¨--scaleå‚æ•°é…åˆupæŒ‡ä»¤ï¼Œæ¥å—å¤šä¸ªå®¹å™¨ä¼ é€’ï¼š\ndocker-compose up --scale web=2 celery-worker=3  ç»æµ‹è¯•ï¼Œå¤šä¸ªworkeréƒ½è·å¾—äº†å‘é€è¿‡æ¥çš„ä»»åŠ¡ã€‚","title":"docker å¿«é€Ÿæ‰©å®¹"},{"content":"docker æ—¥å¿— åå°è¿è¡Œdockerçš„æ—¶å€™ï¼Œæ€ä¹ˆæŸ¥çœ‹æ—¥å¿—ï¼Ÿ\ndocker logs SERVICE_NAME  ","permalink":"http://localhost:8000/posts/docker/logs/","summary":"docker æ—¥å¿— åå°è¿è¡Œdockerçš„æ—¶å€™ï¼Œæ€ä¹ˆæŸ¥çœ‹æ—¥å¿—ï¼Ÿ\ndocker logs SERVICE_NAME  ","title":"docker æ—¥å¿—"},{"content":"docker æ¸…ç†   æ€ä¹ˆæ¸…ç†ä¸ç”¨çš„å®¹å™¨å’Œé•œåƒï¼Ÿ\n  dockerå ç”¨è¿‡å¤šçš„ç£ç›˜ç©ºé—´ï¼Ÿ\n  å¦‚ä½•æ¸…ç†Dockerå ç”¨çš„ç£ç›˜ç©ºé—´?\n  æŸ¥çœ‹ ä½¿ç”¨docker systemå‘½ä»¤ã€‚æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µï¼š\n$ docker system df  æ¸…ç† docker rmi $(docker images --filter \u0026quot;dangling=true\u0026quot; -q)  æ¸…ç†ç£ç›˜ï¼Œåˆ é™¤å…³é—­çš„å®¹å™¨ã€æ— ç”¨çš„æ•°æ®å·ã€ç½‘ç»œï¼Œä»¥åŠdanglingé•œåƒï¼ˆæ— tagçš„é•œåƒï¼‰ã€‚\n$ docker system prune  æ›´å½»åº•çš„åˆ é™¤ï¼Œå°†æ²¡æœ‰å®¹å™¨ä½¿ç”¨çš„é•œåƒåˆ é™¤ï¼š\n$ docker system prune -a  åˆ é™¤noneé•œåƒ $ docker rmi $(docker images | grep \u0026quot;none\u0026quot; | awk '{print $3}') //åˆ é™¤é•œåƒ  é™åˆ¶å®¹å™¨å¤§å° å¦‚nginxï¼Œé™åˆ¶è¯¥å®¹å™¨çš„æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥åœ¨docker-composeä¸­å†™å…¥é€‰é¡¹max-size:\nnginx: image: nginx:1.12.1 restart: always logging: driver: \u0026#34;json-file\u0026#34; options: max-size: \u0026#34;5g\u0026#34; ","permalink":"http://localhost:8000/posts/docker/%E6%B8%85%E7%90%86/","summary":"docker æ¸…ç†   æ€ä¹ˆæ¸…ç†ä¸ç”¨çš„å®¹å™¨å’Œé•œåƒï¼Ÿ\n  dockerå ç”¨è¿‡å¤šçš„ç£ç›˜ç©ºé—´ï¼Ÿ\n  å¦‚ä½•æ¸…ç†Dockerå ç”¨çš„ç£ç›˜ç©ºé—´?\n  æŸ¥çœ‹ ä½¿ç”¨docker systemå‘½ä»¤ã€‚æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µï¼š\n$ docker system df  æ¸…ç† docker rmi $(docker images --filter \u0026quot;dangling=true\u0026quot; -q)  æ¸…ç†ç£ç›˜ï¼Œåˆ é™¤å…³é—­çš„å®¹å™¨ã€æ— ç”¨çš„æ•°æ®å·ã€ç½‘ç»œï¼Œä»¥åŠdanglingé•œåƒï¼ˆæ— tagçš„é•œåƒï¼‰ã€‚\n$ docker system prune  æ›´å½»åº•çš„åˆ é™¤ï¼Œå°†æ²¡æœ‰å®¹å™¨ä½¿ç”¨çš„é•œåƒåˆ é™¤ï¼š\n$ docker system prune -a  åˆ é™¤noneé•œåƒ $ docker rmi $(docker images | grep \u0026quot;none\u0026quot; | awk '{print $3}') //åˆ é™¤é•œåƒ  é™åˆ¶å®¹å™¨å¤§å° å¦‚nginxï¼Œé™åˆ¶è¯¥å®¹å™¨çš„æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥åœ¨docker-composeä¸­å†™å…¥é€‰é¡¹max-size:\nnginx: image: nginx:1.12.1 restart: always logging: driver: \u0026#34;json-file\u0026#34; options: max-size: \u0026#34;5g\u0026#34; ","title":"docker æ¸…ç†"},{"content":"docker ç®¡ç†å·¥å…· kitematic å¯ä»¥ä¸Šdockerhubï¼Œä½†æ˜¯UIä¸æ˜¯å¾ˆå¥½ï¼Œå®¹å™¨åå­—çœ‹ä¸å…¨ï¼Œä¸èƒ½æ‹–åŠ¨ç•Œé¢\nPortainer webæœåŠ¡\ndocker volume create portainer_data docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer  ","permalink":"http://localhost:8000/posts/docker/%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/","summary":"docker ç®¡ç†å·¥å…· kitematic å¯ä»¥ä¸Šdockerhubï¼Œä½†æ˜¯UIä¸æ˜¯å¾ˆå¥½ï¼Œå®¹å™¨åå­—çœ‹ä¸å…¨ï¼Œä¸èƒ½æ‹–åŠ¨ç•Œé¢\nPortainer webæœåŠ¡\ndocker volume create portainer_data docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer  ","title":"docker ç®¡ç†å·¥å…·"},{"content":"docker é˜¿é‡Œäº‘ä»“åº“ ç™»å½•é˜¿é‡Œäº‘Docker Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com  ç”¨äºç™»å½•çš„ç”¨æˆ·åä¸ºé˜¿é‡Œäº‘è´¦å·å…¨åï¼Œå¯†ç ä¸ºå¼€é€šæœåŠ¡æ—¶è®¾ç½®çš„å¯†ç ã€‚\næ‚¨å¯ä»¥åœ¨äº§å“æ§åˆ¶å°é¦–é¡µä¿®æ”¹ç™»å½•å¯†ç ã€‚\né‡åˆ°æ— æ³•ç™»å½•é—®é¢˜ï¼š\nError saving credentials: error storing credentials - err: exit status 1, out: `The name org.freedesktop.secrets was not provided by any .service files sudo apt install gnupg2 pass ä»Registryä¸­æ‹‰å–é•œåƒ $ sudo docker pull registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·]\nå°†é•œåƒæ¨é€åˆ°Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com $ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·] $ sudo docker push registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·]  è¯·æ ¹æ®å®é™…é•œåƒä¿¡æ¯æ›¿æ¢ç¤ºä¾‹ä¸­çš„[ImageId]å’Œ[é•œåƒç‰ˆæœ¬å·]å‚æ•°ã€‚\né€‰æ‹©åˆé€‚çš„é•œåƒä»“åº“åœ°å€ ä»ECSæ¨é€é•œåƒæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é•œåƒä»“åº“å†…ç½‘åœ°å€ã€‚æ¨é€é€Ÿåº¦å°†å¾—åˆ°æå‡å¹¶ä¸”å°†ä¸ä¼šæŸè€—æ‚¨çš„å…¬ç½‘æµé‡ã€‚\nå¦‚æœæ‚¨ä½¿ç”¨çš„æœºå™¨ä½äºVPCç½‘ç»œï¼Œè¯·ä½¿ç”¨ registry-vpc.cn-hangzhou.aliyuncs.com ä½œä¸ºRegistryçš„åŸŸåç™»å½•ï¼Œå¹¶ä½œä¸ºé•œåƒå‘½åç©ºé—´å‰ç¼€ã€‚\nç¤ºä¾‹ ä½¿ç”¨\u0026quot;docker tag\u0026quot;å‘½ä»¤é‡å‘½åé•œåƒï¼Œå¹¶å°†å®ƒé€šè¿‡ä¸“æœ‰ç½‘ç»œåœ°å€æ¨é€è‡³Registryã€‚\n$ sudo docker images REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE registry.aliyuncs.com/acs/agent 0.7-dfb6816 37bb9c63c8b2 7 days ago 37.89 MB $ sudo docker tag 37bb9c63c8b2 registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816  ä½¿ç”¨\u0026quot;docker images\u0026quot;å‘½ä»¤æ‰¾åˆ°é•œåƒï¼Œå°†è¯¥é•œåƒåç§°ä¸­çš„åŸŸåéƒ¨åˆ†å˜æ›´ä¸ºRegistryä¸“æœ‰ç½‘ç»œåœ°å€ã€‚\n$ sudo docker push registry-vpc.cn-hangzhou.aliyuncs.com/acs/agent:0.7-dfb6816 ","permalink":"http://localhost:8000/posts/docker/%E9%98%BF%E9%87%8C%E4%BA%91%E4%BB%93%E5%BA%93/","summary":"docker é˜¿é‡Œäº‘ä»“åº“ ç™»å½•é˜¿é‡Œäº‘Docker Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com  ç”¨äºç™»å½•çš„ç”¨æˆ·åä¸ºé˜¿é‡Œäº‘è´¦å·å…¨åï¼Œå¯†ç ä¸ºå¼€é€šæœåŠ¡æ—¶è®¾ç½®çš„å¯†ç ã€‚\næ‚¨å¯ä»¥åœ¨äº§å“æ§åˆ¶å°é¦–é¡µä¿®æ”¹ç™»å½•å¯†ç ã€‚\né‡åˆ°æ— æ³•ç™»å½•é—®é¢˜ï¼š\nError saving credentials: error storing credentials - err: exit status 1, out: `The name org.freedesktop.secrets was not provided by any .service files sudo apt install gnupg2 pass ä»Registryä¸­æ‹‰å–é•œåƒ $ sudo docker pull registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·]\nå°†é•œåƒæ¨é€åˆ°Registry $ sudo docker login --username=26huitailang@gmail.com registry.cn-hangzhou.aliyuncs.com $ sudo docker tag [ImageId] registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·] $ sudo docker push registry.cn-hangzhou.aliyuncs.com/26huitailang/golang-web:[é•œåƒç‰ˆæœ¬å·]  è¯·æ ¹æ®å®é™…é•œåƒä¿¡æ¯æ›¿æ¢ç¤ºä¾‹ä¸­çš„[ImageId]å’Œ[é•œåƒç‰ˆæœ¬å·]å‚æ•°ã€‚\né€‰æ‹©åˆé€‚çš„é•œåƒä»“åº“åœ°å€ ä»ECSæ¨é€é•œåƒæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨é•œåƒä»“åº“å†…ç½‘åœ°å€ã€‚æ¨é€é€Ÿåº¦å°†å¾—åˆ°æå‡å¹¶ä¸”å°†ä¸ä¼šæŸè€—æ‚¨çš„å…¬ç½‘æµé‡ã€‚\nå¦‚æœæ‚¨ä½¿ç”¨çš„æœºå™¨ä½äºVPCç½‘ç»œï¼Œè¯·ä½¿ç”¨ registry-vpc.","title":"docker é˜¿é‡Œäº‘ä»“åº“"},{"content":"Cheatsheet for package manager  go mod pip apt ubuntu 20.04  pip pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package\nå‡çº§ pip åˆ°æœ€æ–°çš„ç‰ˆæœ¬ (\u0026gt;=10.0.0) åè¿›è¡Œé…ç½®ï¼š\npip install pip -U pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple\nå¦‚æœæ‚¨åˆ° pip é»˜è®¤æºçš„ç½‘ç»œè¿æ¥è¾ƒå·®ï¼Œä¸´æ—¶ä½¿ç”¨æœ¬é•œåƒç«™æ¥å‡çº§ pipï¼š\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U\napt ubuntu 20.04\n# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨ # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse go mod GOPROXY=https://goproxy.io,direct\ngo mod init github.com/26huitailang/\u0026lt;PROJECTNAME\u0026gt; go mod vendor ","permalink":"http://localhost:8000/posts/cheatsheet/pkg-manager/","summary":"Cheatsheet for package manager  go mod pip apt ubuntu 20.04  pip pip install -i https://pypi.tuna.tsinghua.edu.cn/simple some-package\nå‡çº§ pip åˆ°æœ€æ–°çš„ç‰ˆæœ¬ (\u0026gt;=10.0.0) åè¿›è¡Œé…ç½®ï¼š\npip install pip -U pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple\nå¦‚æœæ‚¨åˆ° pip é»˜è®¤æºçš„ç½‘ç»œè¿æ¥è¾ƒå·®ï¼Œä¸´æ—¶ä½¿ç”¨æœ¬é•œåƒç«™æ¥å‡çº§ pipï¼š\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple pip -U\napt ubuntu 20.04\n# é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse # deb-src https://mirrors.","title":"Cheatsheet for pkg manager"},{"content":"Cobra å‘½ä»¤è¡Œ å› ä¸ºä¹‹å‰å†™ Djangoï¼Œpython manage.pyè¿™ä¸ªå‘½ä»¤éå¸¸å¥½ç”¨ï¼Œæƒ³çœ‹çœ‹èƒ½ä¸èƒ½å®ç°ç±»ä¼¼çš„æ•ˆæœã€‚æœç´¢ä¹‹åå‘ç°äº†æ›´å¼ºçš„cobraï¼Œçœ‹ç®€ä»‹ä¸­ä½¿ç”¨çš„é¡¹ç›®å°±çŸ¥é“éå¸¸ä¸é”™ã€‚ä»£ç ç»„ç»‡å‚è€ƒçš„frpçš„ã€‚\nPATH/frp/cmdï¼Œfrpcå’Œfprsåˆ†åˆ«æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯\nâ”œâ”€â”€â”€frpc â”‚ â”‚ main.go â”‚ â”‚ â”‚ â””â”€â”€â”€sub â”‚ http.go â”‚ https.go â”‚ reload.go â”‚ root.go â”‚ status.go â”‚ stcp.go â”‚ sudp.go â”‚ tcp.go â”‚ tcpmux.go â”‚ udp.go â”‚ xtcp.go â”‚ â””â”€â”€â”€frps main.go root.go æ·»åŠ  go get -u github.com/spf13/cobra/cobra åœ¨é¡¹ç›®ç›®å½•ä¸­æ‰§è¡Œï¼Œappname mycliï¼Œå…¶ä¸­cmdä¸­ rootCmd çš„åç§°æ˜¯mycliï¼Œè¿™é‡Œå»ºè®®å’Œappnameä¸€æ ·ï¼Œåé¢å¯ä»¥ç›´æ¥go installä¹‹åä½¿ç”¨mycliå³å¯ã€‚\nmkdir cmd \u0026amp;\u0026amp; cd cmd cobra init mycli --pkg-name mycli cmd â””â”€â”€â”€mycli â”‚ LICENSE â”‚ main.go â”‚ â””â”€â”€â”€cmd root.go æ¨¡æ¿ä»£ç  importé”™è¯¯ï¼Œé‡æ–°æŒ‰ç…§è‡ªå·±é¡¹ç›®çš„ç»„ç»‡æ–¹å¼é‡å†™ importå³å¯ã€‚\npackage main import \u0026#34;mycli/cmd\u0026#34; func main() { cmd.Execute() } æµ‹è¯•ä½¿ç”¨ï¼š\ngo run main.go æµ‹è¯•å®Œåï¼Œå¯ä»¥go installåˆ°ç³»ç»Ÿçš„è·¯å¾„é‡Œï¼Œç„¶åä½¿ç”¨å³å¯ï¼Œå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å‘å¸ƒä¹Ÿéå¸¸æ–¹ä¾¿ã€‚\nåµŒå¥—å‘½ä»¤è¡Œ mycli CMD SUBCMD å¢åŠ ç¬¬ä¸€çº§å‘½ä»¤\n\u0026gt; cobra add user \u0026gt; go run . user user called å¢åŠ userä¸‹çš„å…¶ä»–æŒ‡ä»¤\n\u0026gt; cobra add userAdd --parent userCmd \u0026gt; go run . user userAdd userAdd called ç°åœ¨ä»£ç çš„ç»“æ„\nmycli â”‚ LICENSE â”‚ main.go â”‚ â””â”€â”€â”€cmd root.go user.go userAdd.go æ¯ä¸€æ¬¡cobra addéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œ--parentæŒ‡å®šå‘½ä»¤å±äºå“ªä¸€ä¸ªï¼Œé»˜è®¤æ˜¯æ·»åŠ åˆ°rootCmdï¼š\n å¯ä»¥å°†cobraç”Ÿæˆçš„æ–‡ä»¶è‡ªå·±é‡æ„ï¼Œç§»åŠ¨åˆ°å¯¹åº”æ–‡ä»¶ä¸­ userAddè¿™ä¸ªæ˜¯æ–‡ä»¶åï¼Œä¹Ÿæ˜¯å‘½ä»¤åï¼Œåœ¨cmdçš„Useå±æ€§ä¸­å¯ä»¥ä¿®æ”¹ä¸ºaddï¼Œè¿™æ ·ä½¿ç”¨æ—¶mycli user add [flags]  ç»“åˆåˆ°å·²æœ‰ç³»ç»Ÿä¸­ ä»¥web serverä¸ºä¾‹ï¼Œéƒ½ä¼šè®¾è®¡ä¸€ä¸ªNewServeræ–¹æ³•ï¼Œç„¶åå°è£…ä¸€ä¸ªæ‰§è¡Œæ–¹æ³•ï¼Œä»¥å‘½ä»¤ä¸ºå…¥å£æ‰§è¡Œå³å¯ï¼š\nmycli server  // serverCmd represents the server command var serverCmd = \u0026amp;cobra.Command{ Use: \u0026#34;server\u0026#34;, Short: \u0026#34;A brief description of your command\u0026#34;, Long: `A longer description that spans multiple lines and likely contains examples and usage of using your command. For example: Cobra is a CLI library for Go that empowers applications. This application is a tool to generate the needed files to quickly create a Cobra application.`, Run: func(cmd *cobra.Command, args []string) { runServer() fmt.Println(\u0026#34;server called\u0026#34;) }, } func init() { rootCmd.AddCommand(serverCmd) // Here you will define your flags and configuration settings.  // Cobra supports Persistent Flags which will work for this command \t// and all subcommands, e.g.: \t// serverCmd.PersistentFlags().String(\u0026#34;foo\u0026#34;, \u0026#34;\u0026#34;, \u0026#34;A help for foo\u0026#34;)  // Cobra supports local flags which will only run when this command \t// is called directly, e.g.: \t// serverCmd.Flags().BoolP(\u0026#34;toggle\u0026#34;, \u0026#34;t\u0026#34;, false, \u0026#34;Help message for toggle\u0026#34;) } func runServer() { e := server.NewServer() e.Logger.Fatal(e.Start(config.Config.Port)) } ","permalink":"http://localhost:8000/posts/golang/cobra/","summary":"Cobra å‘½ä»¤è¡Œ å› ä¸ºä¹‹å‰å†™ Djangoï¼Œpython manage.pyè¿™ä¸ªå‘½ä»¤éå¸¸å¥½ç”¨ï¼Œæƒ³çœ‹çœ‹èƒ½ä¸èƒ½å®ç°ç±»ä¼¼çš„æ•ˆæœã€‚æœç´¢ä¹‹åå‘ç°äº†æ›´å¼ºçš„cobraï¼Œçœ‹ç®€ä»‹ä¸­ä½¿ç”¨çš„é¡¹ç›®å°±çŸ¥é“éå¸¸ä¸é”™ã€‚ä»£ç ç»„ç»‡å‚è€ƒçš„frpçš„ã€‚\nPATH/frp/cmdï¼Œfrpcå’Œfprsåˆ†åˆ«æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯\nâ”œâ”€â”€â”€frpc â”‚ â”‚ main.go â”‚ â”‚ â”‚ â””â”€â”€â”€sub â”‚ http.go â”‚ https.go â”‚ reload.go â”‚ root.go â”‚ status.go â”‚ stcp.go â”‚ sudp.go â”‚ tcp.go â”‚ tcpmux.go â”‚ udp.go â”‚ xtcp.go â”‚ â””â”€â”€â”€frps main.go root.go æ·»åŠ  go get -u github.com/spf13/cobra/cobra åœ¨é¡¹ç›®ç›®å½•ä¸­æ‰§è¡Œï¼Œappname mycliï¼Œå…¶ä¸­cmdä¸­ rootCmd çš„åç§°æ˜¯mycliï¼Œè¿™é‡Œå»ºè®®å’Œappnameä¸€æ ·ï¼Œåé¢å¯ä»¥ç›´æ¥go installä¹‹åä½¿ç”¨mycliå³å¯ã€‚\nmkdir cmd \u0026amp;\u0026amp; cd cmd cobra init mycli --pkg-name mycli cmd â””â”€â”€â”€mycli â”‚ LICENSE â”‚ main.go â”‚ â””â”€â”€â”€cmd root.go æ¨¡æ¿ä»£ç  importé”™è¯¯ï¼Œé‡æ–°æŒ‰ç…§è‡ªå·±é¡¹ç›®çš„ç»„ç»‡æ–¹å¼é‡å†™ importå³å¯ã€‚","title":"Cobra å‘½ä»¤è¡Œ"},{"content":"docker install install docker on Debian/Ubuntu\nlink\nUninstall old versions $ sudo apt-get remove docker docker-engine docker.io containerd runc Set up the repository $ sudo apt-get update $ sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common $ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - or $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add - $ sudo apt-key fingerprint 0EBFCD88 $ sudo add-apt-repository \\ \u0026quot;deb [arch=amd64] https://download.docker.com/linux/debian \\ $(lsb_release -cs) \\ stable\u0026quot; or sudo add-apt-repository \\ \u0026quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \\ focal \\ stable\u0026quot; or $ sudo add-apt-repository \\ \u0026quot;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ \\ $(lsb_release -cs) \\ stable\u0026quot; Install Docker Engine $ sudo apt-get update $ sudo apt-get install docker-ce docker-ce-cli containerd.io $ sudo docker run --rm hello-world $ sudo apt install docker-compose -y Without sudo to use docker $ sudo usermod -aG docker $USER $ sudo systemctl restart docker $ sudo systemctl enable docker Speed up https://YOURS.mirror.aliyuncs.com\nsudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json \u0026lt;\u0026lt;-'EOF' { \u0026quot;registry-mirrors\u0026quot;: [ \u0026quot;https://registry.docker-cn.com\u0026quot;, \u0026quot;http://hub-mirror.c.163.com\u0026quot;, \u0026quot;https://docker.mirrors.ustc.edu.cn\u0026quot; ] } EOF sudo systemctl daemon-reload sudo systemctl restart docker ","permalink":"http://localhost:8000/posts/docker/debian-docker-install/","summary":"docker install install docker on Debian/Ubuntu\nlink\nUninstall old versions $ sudo apt-get remove docker docker-engine docker.io containerd runc Set up the repository $ sudo apt-get update $ sudo apt-get install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common $ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - or $ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add - $ sudo apt-key fingerprint 0EBFCD88 $ sudo add-apt-repository \\ \u0026quot;deb [arch=amd64] https://download.","title":"docker install"},{"content":"Docker Private Registry ç®€å•ä½¿ç”¨ï¼Œå®˜æ–¹ å®˜æ–¹æä¾›çš„ https://hub.docker.com/_/registry\nRun a local registry: Quick Version\n$ docker run -d -p 5000:5000 --restart always --name registry registry:2  Now, use it from within Docker:\n$ docker pull ubuntu $ docker tag ubuntu localhost:5000/ubuntu $ docker push localhost:5000/ubuntu  æ›´å¤æ‚çš„éœ€æ±‚ï¼Œharbor https://goharbor.io/\nOur mission is to be the trusted cloud native repository for Kubernetes\n","permalink":"http://localhost:8000/posts/docker/%E7%A7%81%E6%9C%89registry/","summary":"Docker Private Registry ç®€å•ä½¿ç”¨ï¼Œå®˜æ–¹ å®˜æ–¹æä¾›çš„ https://hub.docker.com/_/registry\nRun a local registry: Quick Version\n$ docker run -d -p 5000:5000 --restart always --name registry registry:2  Now, use it from within Docker:\n$ docker pull ubuntu $ docker tag ubuntu localhost:5000/ubuntu $ docker push localhost:5000/ubuntu  æ›´å¤æ‚çš„éœ€æ±‚ï¼Œharbor https://goharbor.io/\nOur mission is to be the trusted cloud native repository for Kubernetes","title":"Docker Private Registry"},{"content":"etcd å°è¯• vagrant # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :etcd1 =\u0026gt; '192.168.1.21', :etcd2 =\u0026gt; '192.168.1.22', :etcd3 =\u0026gt; '192.168.1.23' } Vagrant.configure(\u0026quot;2\u0026quot;) do |config| config.vm.box = \u0026quot;ubuntu/focal64\u0026quot; servers.each do |server_name, server_ip| config.vm.define server_name do |server_config| server_config.vm.hostname = \u0026quot;#{server_name.to_s}\u0026quot; server_config.vm.network :private_network, ip: server_ip server_config.vm.provider \u0026quot;virtualbox\u0026quot; do |vb| vb.name = server_name.to_s if vb.name == \u0026quot;etcd1\u0026quot; vb.memory = 1024 vb.cpus = 1 else vb.memory = 1024 vb.cpus = 1 end end end end end install install.sh\nETCD_VER=v3.4.9 # choose either URL GOOGLE_URL=https://storage.googleapis.com/etcd GITHUB_URL=https://github.com/etcd-io/etcd/releases/download DOWNLOAD_URL=${GOOGLE_URL} rm -f /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz rm -rf /tmp/etcd-download-test \u0026amp;\u0026amp; mkdir -p /tmp/etcd-download-test curl -L ${DOWNLOAD_URL}/${ETCD_VER}/etcd-${ETCD_VER}-linux-amd64.tar.gz -o /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz tar xzvf /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz -C /tmp/etcd-download-test --strip-components=1 rm -f /tmp/etcd-${ETCD_VER}-linux-amd64.tar.gz /tmp/etcd-download-test/etcd --version /tmp/etcd-download-test/etcdctl version cluster.sh\n infra0/1/2 192.168.1.21-23  /tmp/etcd-download-test/etcd --name infra1 --initial-advertise-peer-urls http://192.168.1.22:2380 \\  --listen-peer-urls http://192.168.1.22:2380 \\  --listen-client-urls http://192.168.1.22:2379,http://127.0.0.1:2379 \\  --advertise-client-urls http://192.168.1.22:2379 \\  --initial-cluster-token etcd-cluster-1 \\  --initial-cluster infra0=http://192.168.1.21:2380,infra1=http://192.168.1.22:2380,infra2=http://192.168.1.23:2380 \\  --initial-cluster-state new /tmp/etcd-download-test/etcdctl put mykey \u0026ldquo;this is awesome\u0026rdquo; /tmp/etcd-download-test/etcdctl get mykey\n","permalink":"http://localhost:8000/posts/etcd/readme/","summary":"etcd å°è¯• vagrant # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :etcd1 =\u0026gt; '192.168.1.21', :etcd2 =\u0026gt; '192.168.1.22', :etcd3 =\u0026gt; '192.168.1.23' } Vagrant.configure(\u0026quot;2\u0026quot;) do |config| config.vm.box = \u0026quot;ubuntu/focal64\u0026quot; servers.each do |server_name, server_ip| config.vm.define server_name do |server_config| server_config.vm.hostname = \u0026quot;#{server_name.to_s}\u0026quot; server_config.vm.network :private_network, ip: server_ip server_config.vm.provider \u0026quot;virtualbox\u0026quot; do |vb| vb.name = server_name.to_s if vb.name == \u0026quot;etcd1\u0026quot; vb.memory = 1024 vb.cpus = 1 else vb.memory = 1024 vb.cpus = 1 end end end end end install install.","title":"etcd å°è¯•"},{"content":"pip ç¦»çº¿å®‰è£… æ‰“åŒ… æ³¨æ„ï¼Œè¦åœ¨åŒå¹³å°æ‰“åŒ…ï¼Œå¦åˆ™æœ‰äº›åŒ…ä¸èƒ½æ­£ç¡®å®‰è£…ã€‚\nåœ¨å·²æœ‰çš„ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š\n pip freeze \u0026gt; pip-requirements.txt pip download -d pip-packages -r pip-requirements.txtï¼Œå°†æå–çš„åŒ…ä¸‹è½½åˆ°pip-packagesæ–‡ä»¶å¤¹ä¸­  å®‰è£…  å°†pip-requirements.txtå’Œpip-packagesæ–‡ä»¶å¤¹ï¼Œæ‹·è´åˆ°ç›®æ ‡ç¯å¢ƒçš„åŒç›®å½•ä¸‹ pip install \u0026ndash;no-index \u0026ndash;find-links=pip-packages -r pip-requirements.txt  å‚è€ƒ  æ–­ç½‘ç¯å¢ƒä¸‹ä¸€é”®å®‰è£… python3 ç¦»çº¿å®‰è£…åŒ…åŠå…¶ä¾èµ–  ","permalink":"http://localhost:8000/posts/python/pip/%E6%89%93%E5%8C%85%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85/","summary":"pip ç¦»çº¿å®‰è£… æ‰“åŒ… æ³¨æ„ï¼Œè¦åœ¨åŒå¹³å°æ‰“åŒ…ï¼Œå¦åˆ™æœ‰äº›åŒ…ä¸èƒ½æ­£ç¡®å®‰è£…ã€‚\nåœ¨å·²æœ‰çš„ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š\n pip freeze \u0026gt; pip-requirements.txt pip download -d pip-packages -r pip-requirements.txtï¼Œå°†æå–çš„åŒ…ä¸‹è½½åˆ°pip-packagesæ–‡ä»¶å¤¹ä¸­  å®‰è£…  å°†pip-requirements.txtå’Œpip-packagesæ–‡ä»¶å¤¹ï¼Œæ‹·è´åˆ°ç›®æ ‡ç¯å¢ƒçš„åŒç›®å½•ä¸‹ pip install \u0026ndash;no-index \u0026ndash;find-links=pip-packages -r pip-requirements.txt  å‚è€ƒ  æ–­ç½‘ç¯å¢ƒä¸‹ä¸€é”®å®‰è£… python3 ç¦»çº¿å®‰è£…åŒ…åŠå…¶ä¾èµ–  ","title":"pip ç¦»çº¿å®‰è£…"},{"content":"pipenv pipå’Œvirtualenvçš„ç»„åˆï¼Œä½¿ç”¨Pipfileæ¥æ›¿æ¢æ—§çš„requirements.txtæ–¹å¼ã€‚\n documentation zhihu å‚è€ƒ segmentfault å‚è€ƒ  å®‰è£… å®‰è£…åˆ°ç³»ç»Ÿå¸¸ç”¨çš„pythonç‰ˆæœ¬ä¸‹ï¼Œmacå¯ä»¥ä½¿ç”¨brewå®‰è£…\n$ pip install pipenv  åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ $ pipenv install --three django  åˆ›å»ºä¸€ä¸ªpython3çš„è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…djangoï¼Œéšæœºç”Ÿæˆä¸€ä¸ªå’Œå½“å‰æ–‡ä»¶å¤¹åæœ‰å…³çš„è™šæ‹Ÿç¯å¢ƒã€‚ä¹Ÿå¯ä»¥ç”¨è¿‡--python 3.7æŒ‡å®špythonç‰ˆæœ¬ã€‚\n TODOï¼Œ ä¸èƒ½æŒ‡å®šåç§°å—ï¼Ÿ  è¿›å…¥è™šæ‹Ÿç¯å¢ƒ $ pipenv shell  ä¸è¿‡å°±ç®—ä¸è¿›å…¥ç¯å¢ƒï¼Œpipenv installä¾ç„¶å¯ä»¥æ­£ç¡®å®‰è£…åŒ…åˆ°å¯¹åº”çš„ç¯å¢ƒã€‚\næ–°ç¯å¢ƒä¾èµ– è‡ªåŠ¨è¯†åˆ«Pipfileï¼Œç„¶åå®‰è£…ã€‚\n$ pipenv install  ä¸€å¹¶å®‰è£…å¼€å‘ç¯å¢ƒçš„åŒ…ï¼š\n$ pipenv install --dev  åŒºåˆ«å¼€å‘ç¯å¢ƒ åœ¨å®‰è£…åŒ…çš„æ—¶å€™æ·»åŠ ä¸€ä¸ª--devé€‰é¡¹ï¼Œä¼šåˆ†ç±»åˆ°å¼€å‘ä¾èµ–ã€‚\næ›´æ¢æº æ›´æ¢Pipfileä¸­çš„source-url\n[[source]] url = \u0026quot;https://mirrors.aliyun.com/pypi/simple\u0026quot; verify_ssl = true name = \u0026quot;pypi\u0026quot;  è®¾ç½®ç¯å¢ƒå˜é‡ PIPENV_PYPI_MIRROR æ•ˆæœç›¸åŒã€‚ç±»ä¼¼æŒ‡å®š\u0026ndash;pypi-mirroré€‰é¡¹ï¼š\n$ pipenv install --pypi-mirror https://mirrors.aliyun.com/pypi/simple  æŸ¥çœ‹å®‰è£…çš„åŒ… $ pipenv graph  ä¸ä»…å¯ä»¥çœ‹åˆ°å®‰è£…åŒ…ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ä¾èµ–å…³ç³»ã€‚\nDjango==2.1.7 - pytz [required: Any, installed: 2018.9] psutil==5.5.1  Pipfile  æ›¿æ¢äº†æº æœ‰å¼€å‘ç¯å¢ƒçš„åŒ… dev-packages python ç‰ˆæœ¬3.6  [[source]] name = \u0026quot;pypi\u0026quot; url = \u0026quot;https://mirrors.aliyun.com/pypi/simple\u0026quot; verify_ssl = true [dev-packages] pytest = \u0026quot;*\u0026quot; [packages] psutil = \u0026quot;*\u0026quot; django = \u0026quot;*\u0026quot; [requires] python_version = \u0026quot;3.6\u0026quot; ","permalink":"http://localhost:8000/posts/python/pip/pipenv/","summary":"pipenv pipå’Œvirtualenvçš„ç»„åˆï¼Œä½¿ç”¨Pipfileæ¥æ›¿æ¢æ—§çš„requirements.txtæ–¹å¼ã€‚\n documentation zhihu å‚è€ƒ segmentfault å‚è€ƒ  å®‰è£… å®‰è£…åˆ°ç³»ç»Ÿå¸¸ç”¨çš„pythonç‰ˆæœ¬ä¸‹ï¼Œmacå¯ä»¥ä½¿ç”¨brewå®‰è£…\n$ pip install pipenv  åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ $ pipenv install --three django  åˆ›å»ºä¸€ä¸ªpython3çš„è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…djangoï¼Œéšæœºç”Ÿæˆä¸€ä¸ªå’Œå½“å‰æ–‡ä»¶å¤¹åæœ‰å…³çš„è™šæ‹Ÿç¯å¢ƒã€‚ä¹Ÿå¯ä»¥ç”¨è¿‡--python 3.7æŒ‡å®špythonç‰ˆæœ¬ã€‚\n TODOï¼Œ ä¸èƒ½æŒ‡å®šåç§°å—ï¼Ÿ  è¿›å…¥è™šæ‹Ÿç¯å¢ƒ $ pipenv shell  ä¸è¿‡å°±ç®—ä¸è¿›å…¥ç¯å¢ƒï¼Œpipenv installä¾ç„¶å¯ä»¥æ­£ç¡®å®‰è£…åŒ…åˆ°å¯¹åº”çš„ç¯å¢ƒã€‚\næ–°ç¯å¢ƒä¾èµ– è‡ªåŠ¨è¯†åˆ«Pipfileï¼Œç„¶åå®‰è£…ã€‚\n$ pipenv install  ä¸€å¹¶å®‰è£…å¼€å‘ç¯å¢ƒçš„åŒ…ï¼š\n$ pipenv install --dev  åŒºåˆ«å¼€å‘ç¯å¢ƒ åœ¨å®‰è£…åŒ…çš„æ—¶å€™æ·»åŠ ä¸€ä¸ª--devé€‰é¡¹ï¼Œä¼šåˆ†ç±»åˆ°å¼€å‘ä¾èµ–ã€‚\næ›´æ¢æº æ›´æ¢Pipfileä¸­çš„source-url\n[[source]] url = \u0026quot;https://mirrors.aliyun.com/pypi/simple\u0026quot; verify_ssl = true name = \u0026quot;pypi\u0026quot;  è®¾ç½®ç¯å¢ƒå˜é‡ PIPENV_PYPI_MIRROR æ•ˆæœç›¸åŒã€‚ç±»ä¼¼æŒ‡å®š\u0026ndash;pypi-mirroré€‰é¡¹ï¼š\n$ pipenv install --pypi-mirror https://mirrors.","title":"pipenv"},{"content":"PostgreSQL åˆ†è¡¨ ç»§æ‰¿å®ç°æ›´çµæ´»ï¼Œå¯ä»¥ç›´æ¥åœ¨å·²æœ‰æ•°æ®çš„è¡¨ä¸Šå®ç°ï¼Œä¸ç”¨é‡æ–°è¿ç§»ã€‚\n-- https://www.postgresql.org/docs/current/ddl-partitioning.html -- zh -- http://postgres.cn/docs/11/ddl-partitioning.html -- keyword: further redirect  -- å·²æœ‰æ•°æ®åˆ†è¡¨ï¼Œå› ä¸ºä¸»è¡¨ä¸èƒ½æœ‰æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å…ˆå¤‡ä»½ï¼Œåˆ›å»ºåˆ†è¡¨å’Œè§„åˆ™å®Œæ¯•åé‡æ–°æ’å…¥ -- æˆ–è€…ç”¨æ–°çš„è¡¨åï¼Œä¹‹åå†åˆ†æ‰¹è¯»å–æ’å…¥  -- åˆ›å»ºä¸»è¡¨ CREATE TABLE measurement ( city_id int not null, logdate date not null, peaktemp int, unitsales int ) PARTITION BY RANGE (logdate); -- åˆ›å»ºåˆ†è¡¨åŠè§„åˆ™ -- è¿˜å¯ä»¥é€šè¿‡partition by å†æ¬¡åˆ›å»ºsub-partitioningï¼Œå¯¹æ’å…¥measurement_y2006m02çš„æ•°æ®å†æ¬¡é‡å®šå‘ -- CREATE TABLE measurement_y2006m02 PARTITION OF measurement -- FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;) -- PARTITION BY RANGE (peaktemp); CREATE TABLE measurement_y2006m02 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;); CREATE TABLE measurement_y2006m03 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-03-01\u0026#39;) TO (\u0026#39;2006-04-01\u0026#39;); -- åˆ›å»ºç´¢å¼•ï¼Œè‡ªåŠ¨å†æ¯ä¸ªåˆ†åŒºä¸Šåˆ›å»ºç´¢å¼• CREATE INDEX ON measurement (logdate); -- Ensure that the enable_partition_pruning configuration parameter is not disabled in postgresql.conf. If it is, queries will not be optimized as desired.  -- test INSERT INTO measurement (city_id, logdate, peaktemp, unitsales) VALUES (1, \u0026#39;2008-2-1\u0026#39;, 1, 1); INSERT INTO measurement (city_id, logdate, peaktemp, unitsales) VALUES (1, \u0026#39;2006-2-1\u0026#39;, 1, 1); ---- ç»´æŠ¤ ----  -- åˆ é™¤åˆ†è¡¨ï¼Œå¯ä»¥å¿«é€Ÿåˆ é™¤ç™¾ä¸‡æ•°æ®ï¼Œä½†æ˜¯éœ€è¦çˆ¶è¡¨çš„ ACCESS EXCLUSIVE é” DROP TABLE measurement_y2006m02; -- æ›´å¥½çš„å¤„ç†æ–¹å¼ï¼Œå°†åˆ†è¡¨ä»ä¸»è¡¨ä¸­åˆ†ç¦»ï¼Œä»¥å•ç‹¬çš„å½¢å¼å­˜åœ¨ -- This allows further operations to be performed on the data before it is dropped. For example, this is often a useful time to back up the data using COPY, pg_dump, or similar tools. It might also be a useful time to aggregate data into smaller formats, perform other data manipulations, or run reports. ALTER TABLE measurement DETACH PARTITION measurement_y2006m02; -- åœ¨æ–°çš„è‡ªç›˜ç©ºé—´ç”³æ˜ï¼Œä¸€èˆ¬æ˜¯ç”¨äºæŠŠé‡è¦æ•°æ®æ”¾åœ¨å¯é å¿«é€Ÿç£ç›˜ï¼Œå°†æ—¥å¿—å‹ç­‰æ•°æ®æ”¾äºæ™®é€šç£ç›˜ -- CREATE TABLE measurement_y2008m02 PARTITION OF measurement -- FOR VALUES FROM (\u0026#39;2008-02-01\u0026#39;) TO (\u0026#39;2008-03-01\u0026#39;) -- TABLESPACE fasttablespace;  -- åˆ†åŒºè¡¨æœ‰ä¸‹åˆ—é™åˆ¶ï¼š -- -- æ²¡æœ‰åŠæ³•åˆ›å»ºè·¨è¶Šæ‰€æœ‰åˆ†åŒºçš„æ’é™¤çº¦æŸï¼Œåªå¯èƒ½å•ä¸ªçº¦æŸæ¯ä¸ªå¶å­åˆ†åŒºã€‚ -- -- è™½ç„¶åœ¨åˆ†åŒºè¡¨ä¸Šæ”¯æŒä¸»é”®ï¼Œä½†å¼•ç”¨åˆ†åŒºè¡¨çš„å¤–é”®ä¸å—æ”¯æŒï¼ˆä½†æ”¯æŒä»åˆ†åŒºè¡¨åˆ°æŸä¸ªå…¶ä»–è¡¨çš„å¤–é”®å¼•ç”¨ï¼‰ã€‚ -- -- å½“ä¸€ä¸ªUPDATEå¯¼è‡´ä¸€è¡Œä»ä¸€ä¸ªåˆ†åŒºç§»åŠ¨åˆ°å¦ä¸€ä¸ªåˆ†åŒºæ—¶ï¼Œå¦ä¸€ä¸ªå¹¶å‘çš„UPDATEæˆ–DELETEå¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªä¸²è¡ŒåŒ–é”™è¯¯ã€‚å‡è®¾ä¼šè¯1æ­£åœ¨æ‰§è¡Œä¸€ä¸ªåˆ†åŒºé”®ä¸Šçš„UPDATEï¼ŒåŒæ—¶ä¸€ä¸ªå¹¶å‘çš„èƒ½çœ‹è§è¿™ä¸ªè¡Œçš„ä¼šè¯2æ‰§è¡Œäº†å¯¹è¯¥è¡Œçš„UPDATEæˆ–è€…DELETEæ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šè¯2çš„UPDATEæˆ–è€…DELETEä¼šæ£€æµ‹åˆ°è¡Œçš„ç§»åŠ¨ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªä¸²è¡ŒåŒ–çš„é”™è¯¯(å°†æ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ªSQLSTATE \u0026#39;40001\u0026#39;)ã€‚ å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å¸Œæœ›é‡è¯•è¯¥äº‹åŠ¡ã€‚ åœ¨æ²¡æœ‰åˆ†åŒºè¡¨æˆ–æ²¡æœ‰è¡Œç§»åŠ¨çš„é€šå¸¸æƒ…å†µä¸‹ï¼Œ ä¼šè¯2å°†è¯†åˆ«æ–°æ›´æ–°çš„è¡Œå¹¶åœ¨æ–°è¡Œä¸Šæ‰§è¡ŒUPDATE/DELETEã€‚ -- -- å¦‚æœå¿…è¦ï¼Œå¿…é¡»åœ¨ä¸ªä½“åˆ†åŒºä¸Šå®šä¹‰BEFORE ROWè§¦å‘å™¨ï¼Œåˆ†åŒºè¡¨ä¸Šä¸éœ€è¦ã€‚ -- -- ä¸å…è®¸åœ¨åŒä¸€ä¸ªåˆ†åŒºæ ‘ä¸­æ··æ‚ä¸´æ—¶å…³ç³»å’ŒæŒä¹…å…³ç³»ã€‚å› æ­¤ï¼Œå¦‚æœåˆ†åŒºè¡¨æ˜¯æŒä¹…çš„ï¼Œåˆ™å…¶åˆ†åŒºä¹Ÿå¿…é¡»æ˜¯æŒä¹…çš„ï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨ä½¿ç”¨ä¸´æ—¶å…³ç³»æ—¶ï¼Œåˆ†åŒºæ•°çš„æ‰€æœ‰æˆå‘˜éƒ½å¿…é¡»æ¥è‡ªäºåŒä¸€ä¸ªä¼šè¯ã€‚  -- ä½¿ç”¨ç»§æ‰¿å®ç°  -- è™½ç„¶å†…å»ºçš„å£°æ˜å¼åˆ†åŒºé€‚åˆäºå¤§éƒ¨åˆ†å¸¸è§çš„ç”¨ä¾‹ï¼Œä½†è¿˜æ˜¯æœ‰ä¸€äº›åœºæ™¯éœ€è¦æ›´åŠ çµæ´»çš„æ–¹æ³•ã€‚åˆ†åŒºå¯ä»¥ä½¿ç”¨è¡¨ç»§æ‰¿æ¥å®ç°ï¼Œè¿™èƒ½å¤Ÿå¸¦æ¥ä¸€äº›å£°æ˜å¼åˆ†åŒºä¸æ”¯æŒçš„ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼š -- -- å¯¹å£°æ˜å¼åˆ†åŒºæ¥è¯´ï¼Œåˆ†åŒºå¿…é¡»å…·æœ‰å’Œåˆ†åŒºè¡¨æ­£å¥½ç›¸åŒçš„åˆ—é›†åˆï¼Œè€Œåœ¨è¡¨ç»§æ‰¿ä¸­ï¼Œå­è¡¨å¯ä»¥æœ‰çˆ¶è¡¨ä¸­æ²¡æœ‰å‡ºç°è¿‡çš„é¢å¤–åˆ—ã€‚ -- -- è¡¨ç»§æ‰¿å…è®¸å¤šç»§æ‰¿ã€‚ -- -- å£°æ˜å¼åˆ†åŒºä»…æ”¯æŒèŒƒå›´ã€åˆ—è¡¨ä»¥åŠå“ˆå¸Œåˆ†åŒºï¼Œè€Œè¡¨ç»§æ‰¿å…è®¸æ•°æ®æŒ‰ç…§ç”¨æˆ·çš„é€‰æ‹©æ¥åˆ’åˆ†ï¼ˆä¸è¿‡æ³¨æ„ï¼Œå¦‚æœçº¦æŸæ’é™¤ä¸èƒ½æœ‰æ•ˆåœ°å‰ªæå­è¡¨ï¼ŒæŸ¥è¯¢æ€§èƒ½å¯èƒ½ä¼šå¾ˆå·®ï¼‰ã€‚ -- -- åœ¨ä½¿ç”¨å£°æ˜å¼åˆ†åŒºæ—¶ï¼Œä¸€äº›æ“ä½œæ¯”ä½¿ç”¨è¡¨ç»§æ‰¿æ—¶è¦æ±‚æ›´é•¿çš„æŒé”æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œå‘åˆ†åŒºè¡¨ä¸­å¢åŠ åˆ†åŒºæˆ–è€…ä»åˆ†åŒºè¡¨ç§»é™¤åˆ†åŒºè¦æ±‚åœ¨çˆ¶è¡¨ä¸Šå–å¾—ä¸€ä¸ªACCESS EXCLUSIVEé”ï¼Œè€Œåœ¨å¸¸è§„ç»§æ‰¿çš„æƒ…å†µä¸‹ä¸€ä¸ªSHARE UPDATE EXCLUSIVEé”å°±è¶³å¤Ÿäº†ã€‚  --ç»§æ‰¿å®ç°å¯ä»¥åœ¨å·²æœ‰æ•°æ®ä¸­å®ç°å—ï¼Ÿ create table measurement3 ( id int not null, name char not null ); insert into measurement3 (id, name) values (1, \u0026#39;a\u0026#39;); insert into measurement3 (id, name) values (2, \u0026#39;b\u0026#39;); insert into measurement3 (id, name) values (3, \u0026#39;c\u0026#39;); insert into measurement3 (id, name) values (4, \u0026#39;d\u0026#39;); create table measurement3_y1 (check ( id \u0026gt;= 10 and id \u0026lt; 20 )) inherits (measurement3); create table measurement3_y2 (check ( id \u0026gt;= 20 and id \u0026lt; 30 )) inherits (measurement3); create function measurement_insert_trigger() returns trigger language plpgsql as $$ BEGIN IF (NEW.id \u0026gt;= 10 and NEW.id \u0026lt; 20) then INSERT INTO measurement3_y1 VALUES (NEW.*); ELSIF (NEW.id \u0026gt;= 20 and NEW.id \u0026lt; 30) then INSERT INTO measurement3_y2 VALUES (NEW.*); ELSE RAISE EXCEPTION \u0026#39;id out of range. Fix the measurement_insert_trigger function!\u0026#39;; END IF; RETURN NULL; END; $$; alter function measurement_insert_trigger() owner to develop; CREATE TRIGGER insert_measurement_trigger BEFORE INSERT ON measurement3 FOR EACH ROW EXECUTE FUNCTION measurement_insert_trigger(); insert into measurement3 (id, name) values (100, \u0026#39;d\u0026#39;); ","permalink":"http://localhost:8000/posts/postgresql/partition/","summary":"PostgreSQL åˆ†è¡¨ ç»§æ‰¿å®ç°æ›´çµæ´»ï¼Œå¯ä»¥ç›´æ¥åœ¨å·²æœ‰æ•°æ®çš„è¡¨ä¸Šå®ç°ï¼Œä¸ç”¨é‡æ–°è¿ç§»ã€‚\n-- https://www.postgresql.org/docs/current/ddl-partitioning.html -- zh -- http://postgres.cn/docs/11/ddl-partitioning.html -- keyword: further redirect  -- å·²æœ‰æ•°æ®åˆ†è¡¨ï¼Œå› ä¸ºä¸»è¡¨ä¸èƒ½æœ‰æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦å…ˆå¤‡ä»½ï¼Œåˆ›å»ºåˆ†è¡¨å’Œè§„åˆ™å®Œæ¯•åé‡æ–°æ’å…¥ -- æˆ–è€…ç”¨æ–°çš„è¡¨åï¼Œä¹‹åå†åˆ†æ‰¹è¯»å–æ’å…¥  -- åˆ›å»ºä¸»è¡¨ CREATE TABLE measurement ( city_id int not null, logdate date not null, peaktemp int, unitsales int ) PARTITION BY RANGE (logdate); -- åˆ›å»ºåˆ†è¡¨åŠè§„åˆ™ -- è¿˜å¯ä»¥é€šè¿‡partition by å†æ¬¡åˆ›å»ºsub-partitioningï¼Œå¯¹æ’å…¥measurement_y2006m02çš„æ•°æ®å†æ¬¡é‡å®šå‘ -- CREATE TABLE measurement_y2006m02 PARTITION OF measurement -- FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;) -- PARTITION BY RANGE (peaktemp); CREATE TABLE measurement_y2006m02 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-02-01\u0026#39;) TO (\u0026#39;2006-03-01\u0026#39;); CREATE TABLE measurement_y2006m03 PARTITION OF measurement FOR VALUES FROM (\u0026#39;2006-03-01\u0026#39;) TO (\u0026#39;2006-04-01\u0026#39;); -- åˆ›å»ºç´¢å¼•ï¼Œè‡ªåŠ¨å†æ¯ä¸ªåˆ†åŒºä¸Šåˆ›å»ºç´¢å¼• CREATE INDEX ON measurement (logdate); -- Ensure that the enable_partition_pruning configuration parameter is not disabled in postgresql.","title":"PostgreSQL åˆ†è¡¨"},{"content":"Teamcity æ­å»ºCI/CD install server\nmkdir teamcity_server docker run -it --name teamcity-server-instance \\  -v /home/ubuntu/teamcity_server/datadir:/data/teamcity_server/datadir \\  -v /home/ubuntu/teamcity_server/logs:/opt/teamcity/logs \\  -p 8111:8111 \\  jetbrains/teamcity-server  agent, conf æœ‰æƒé™é—®é¢˜ï¼Œæœ€å¥½åœ¨rootè¿è¡Œ å¦‚æœè¦ä½¿ç”¨docker-in-dockerç‰¹æ€§ï¼ˆsudo command not foundï¼‰ï¼Œè¯·ä½¿ç”¨linux-sudo tagçš„image  sudo docker run -it -e SERVER_URL=\u0026#34;http://10.200.160.4:8111\u0026#34; \\  -u 0 \\  -v docker_volumes:/var/lib/docker \\  -v /var/run/docker.sock:/var/run/docker.sock \\  -v /opt/buildagent/work:/opt/buildagent/work \\  -v /opt/buildagent/temp:/opt/buildagent/temp \\  -v /opt/buildagent/tools:/opt/buildagent/tools \\  -v /opt/buildagent/plugins:/opt/buildagent/plugins \\  -v /opt/buildagent/system:/opt/buildagent/system \\  --privileged -e DOCKER_IN_DOCKER=start \\  -v /home/ubuntu/teamcity_agent/conf:/data/teamcity_agent/conf \\  jetbrains/teamcity-agent register agent agent å®‰è£…å¥½åï¼Œåœ¨server UI/Agents ä¸­è¿›è¡Œè®¤è¯æˆæƒã€‚å¾…agentå°±ç»ªåï¼Œå¯ä»¥æ·»åŠ éœ€è¦çš„é¡¹ç›®å’Œæ“ä½œç­‰ã€‚\né¡¹ç›® æˆ‘ä½¿ç”¨çš„æ˜¯gitlabï¼Œteamcityé»˜è®¤æ˜¯æ”¯æŒçš„\n å³ä¸Šè§’ Administration åœ¨root project/connections ä¸­æ·»åŠ  gitlab ce/eeï¼ŒæŒ‰ç…§æŒ‡ç¤ºå³å¯ï¼Œä¼šæœ‰ä¸ªoauthè®¤è¯çš„è¿‡ç¨‹ ä¹‹åå°±å¯ä»¥åœ¨root project ä¸‹åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥å¯¼å…¥gitlabçš„é¡¹ç›®äº†  Build  åˆ›å»ºäº†é¡¹ç›®åï¼Œåœ¨Build Configurationsä¸­åˆ›å»ºæ–°çš„configurationï¼Œè¿™ä¸ªé…ç½®å¯ä»¥åŒ…å«å¤šä¸ªsteps æ¯ä¸ªé…ç½®å¯ä»¥é…ç½®triggerå’Œbranchï¼Œè¿˜æœ‰å‚æ•° è¿™é‡Œå¯ä»¥ç”¨é…ç½®éš”ç¦»ä¸åŒç¯å¢ƒçš„æµ‹è¯•ï¼Œæˆ‘è¿™é‡Œåªæœ‰ä¸€ä¸ªå•å…ƒæµ‹è¯•çš„ç¯å¢ƒï¼Œbranchæ˜¯æˆ‘è‡ªå·±ä»“åº“çš„devï¼Œåœ¨Version Control Settingsä¸­è®¾ç½®ï¼Œå¯ä»¥å¤šä¸ª Build Stepï¼Œæˆ‘é€‰ç”¨çš„Command Lineï¼Œåœ¨dockerä¸­è¿è¡Œ  é…ç½® docker settings python:3.7    echo \u0026#39;Webserver CI start ...\u0026#39; pip install --default-timeout=60 --no-cache-dir -r requirements/ci.txt -i https://mirrors.aliyun.com/pypi/simple/ \u0026amp;\u0026amp; \\ cp generalapps/settings/ci.py generalapps/settings/settings.py \u0026amp;\u0026amp; \\ python manage.py test --keepdb notification rules å¯ä»¥é…ç½® Email/Browser/IDE/Jabber/Slack\n æˆ‘ä½¿ç”¨Pycharmï¼Œåœ¨æ’ä»¶ä¸­å®‰è£…teamcityæ’ä»¶ï¼Œç„¶åä½¿ç”¨server url/username/passwordç™»å½•å³å¯ åœ¨ä¸ªäººé…ç½®ä¸­é€‰æ‹©å…³æ³¨çš„é¡¹ç›®å’Œäº‹ä»¶ ä¹‹ååœ¨ideä¸­å³å¯çœ‹åˆ°é¡¹ç›®CIçš„åŠ¨æ€  ","permalink":"http://localhost:8000/posts/teamcity/teamcity/","summary":"Teamcity æ­å»ºCI/CD install server\nmkdir teamcity_server docker run -it --name teamcity-server-instance \\  -v /home/ubuntu/teamcity_server/datadir:/data/teamcity_server/datadir \\  -v /home/ubuntu/teamcity_server/logs:/opt/teamcity/logs \\  -p 8111:8111 \\  jetbrains/teamcity-server  agent, conf æœ‰æƒé™é—®é¢˜ï¼Œæœ€å¥½åœ¨rootè¿è¡Œ å¦‚æœè¦ä½¿ç”¨docker-in-dockerç‰¹æ€§ï¼ˆsudo command not foundï¼‰ï¼Œè¯·ä½¿ç”¨linux-sudo tagçš„image  sudo docker run -it -e SERVER_URL=\u0026#34;http://10.200.160.4:8111\u0026#34; \\  -u 0 \\  -v docker_volumes:/var/lib/docker \\  -v /var/run/docker.sock:/var/run/docker.sock \\  -v /opt/buildagent/work:/opt/buildagent/work \\  -v /opt/buildagent/temp:/opt/buildagent/temp \\  -v /opt/buildagent/tools:/opt/buildagent/tools \\  -v /opt/buildagent/plugins:/opt/buildagent/plugins \\  -v /opt/buildagent/system:/opt/buildagent/system \\  --privileged -e DOCKER_IN_DOCKER=start \\  -v /home/ubuntu/teamcity_agent/conf:/data/teamcity_agent/conf \\  jetbrains/teamcity-agent register agent agent å®‰è£…å¥½åï¼Œåœ¨server UI/Agents ä¸­è¿›è¡Œè®¤è¯æˆæƒã€‚å¾…agentå°±ç»ªåï¼Œå¯ä»¥æ·»åŠ éœ€è¦çš„é¡¹ç›®å’Œæ“ä½œç­‰ã€‚","title":"TeamCity æ­å»ºCI/CD"},{"content":"å¦‚ä½•ä½¿ç”¨ Vagrant å¿«é€Ÿæ­å»ºç¯å¢ƒ åŠ é€Ÿ å¯ä»¥ç›´æ¥ä»å›½å†…é•œåƒä¸‹è½½ boxæ ¼å¼çš„æ–‡ä»¶ï¼Œç„¶åç”¨ vagrant box add NAME URLæ·»åŠ \n# è‡ªå·±ä¸‹è½½ https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cloud-images/focal/current/  åˆ¶ä½œè‡ªå·±çš„box å®˜æ–¹æ–‡æ¡£\næ­£å¸¸å®‰è£…é•œåƒï¼Œç„¶åå®‰è£…åŸºç¡€ç¯å¢ƒ\nå¯¼å‡º\nvagrant package --base ubuntu20.04 --output ./ubuntu2004.box  æ·»åŠ box\nvagrant box add ubuntu2004 .\\ubuntu2004.box  å¦‚æœæ²¡æœ‰Vagrantfileï¼Œåˆ™åˆå§‹åŒ–\nvagrant box add ubuntu2004 .\\ubuntu2004.box  å¯åŠ¨\nvagrant up  VagrantFile # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :k3s1 =\u0026gt; \u0026#39;192.168.1.21\u0026#39;, :k3s2 =\u0026gt; \u0026#39;192.168.1.22\u0026#39;, :k3s3 =\u0026gt; \u0026#39;192.168.1.23\u0026#39; } Vagrant.configure(\u0026#34;2\u0026#34;) do |config| # å¯ä»¥æŒ‡å®šè‡ªå·±å¯¼å‡ºçš„box config.vm.box = \u0026#34;ubuntu/focal64\u0026#34; servers.each do |server_name, server_ip| config.vm.define server_name do |server_config| server_config.vm.hostname = \u0026#34;#{server_name.to_s}\u0026#34; server_config.vm.network :private_network, ip: server_ip server_config.vm.provider \u0026#34;virtualbox\u0026#34; do |vb| vb.name = server_name.to_s vb.memory = 1024 vb.cpus = 1 end end end end ","permalink":"http://localhost:8000/posts/vagrant/vagrant/","summary":"å¦‚ä½•ä½¿ç”¨ Vagrant å¿«é€Ÿæ­å»ºç¯å¢ƒ åŠ é€Ÿ å¯ä»¥ç›´æ¥ä»å›½å†…é•œåƒä¸‹è½½ boxæ ¼å¼çš„æ–‡ä»¶ï¼Œç„¶åç”¨ vagrant box add NAME URLæ·»åŠ \n# è‡ªå·±ä¸‹è½½ https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cloud-images/focal/current/  åˆ¶ä½œè‡ªå·±çš„box å®˜æ–¹æ–‡æ¡£\næ­£å¸¸å®‰è£…é•œåƒï¼Œç„¶åå®‰è£…åŸºç¡€ç¯å¢ƒ\nå¯¼å‡º\nvagrant package --base ubuntu20.04 --output ./ubuntu2004.box  æ·»åŠ box\nvagrant box add ubuntu2004 .\\ubuntu2004.box  å¦‚æœæ²¡æœ‰Vagrantfileï¼Œåˆ™åˆå§‹åŒ–\nvagrant box add ubuntu2004 .\\ubuntu2004.box  å¯åŠ¨\nvagrant up  VagrantFile # -*- mode: ruby -*- # vi: set ft=ruby : servers = { :k3s1 =\u0026gt; \u0026#39;192.168.1.21\u0026#39;, :k3s2 =\u0026gt; \u0026#39;192.168.1.22\u0026#39;, :k3s3 =\u0026gt; \u0026#39;192.168.1.23\u0026#39; } Vagrant.configure(\u0026#34;2\u0026#34;) do |config| # å¯ä»¥æŒ‡å®šè‡ªå·±å¯¼å‡ºçš„box config.","title":"Vagrant"},{"content":"wheel æä¾›ç»™ç³»ç»Ÿç»„çš„wheelåŒ…æ„å»ºï¼Œè¦æ±‚none-any\nä»¥oss2åŒ…ä¸ºä¾‹\npip download oss2 --platform=any --abi=none --no-deps æŸ¥çœ‹setup.pyä¸­çš„ä¾èµ–ï¼Œåˆ†åˆ«ç”¨ä¸Šé¢çš„å‘½ä»¤ä¸‹è½½ï¼Œè·å¾—æ‰€æœ‰çš„æºç åŒ…ã€‚\næ‰“åŒ…wheelï¼Œuniversalé€‰é¡¹å¯ä»¥æ‰“åŒ…å¿½ç•¥å¹³å°å’Œæ¶æ„çš„åŒ…;å¦‚æœåŒ…é‡Œé¢å«æœ‰c extensionæ˜¯ä¸æ”¯æŒuniversalçš„ï¼Œå¿…é¡»æ˜¯çº¯pythonå®ç°\npython .\\setup.py bdist_wheel --universal å¦‚æœé‡åˆ°æ‰“åŒ…é”™è¯¯ error: invalid command 'bdist_wheel'ï¼Œå¯ä»¥ä¿®æ”¹setup.pyä½¿ç”¨setuptoolsçš„setupæ–¹æ³•ï¼š\n# from distutils.core import setup from setuptools import setup ","permalink":"http://localhost:8000/posts/python/pip/wheel/","summary":"wheel æä¾›ç»™ç³»ç»Ÿç»„çš„wheelåŒ…æ„å»ºï¼Œè¦æ±‚none-any\nä»¥oss2åŒ…ä¸ºä¾‹\npip download oss2 --platform=any --abi=none --no-deps æŸ¥çœ‹setup.pyä¸­çš„ä¾èµ–ï¼Œåˆ†åˆ«ç”¨ä¸Šé¢çš„å‘½ä»¤ä¸‹è½½ï¼Œè·å¾—æ‰€æœ‰çš„æºç åŒ…ã€‚\næ‰“åŒ…wheelï¼Œuniversalé€‰é¡¹å¯ä»¥æ‰“åŒ…å¿½ç•¥å¹³å°å’Œæ¶æ„çš„åŒ…;å¦‚æœåŒ…é‡Œé¢å«æœ‰c extensionæ˜¯ä¸æ”¯æŒuniversalçš„ï¼Œå¿…é¡»æ˜¯çº¯pythonå®ç°\npython .\\setup.py bdist_wheel --universal å¦‚æœé‡åˆ°æ‰“åŒ…é”™è¯¯ error: invalid command 'bdist_wheel'ï¼Œå¯ä»¥ä¿®æ”¹setup.pyä½¿ç”¨setuptoolsçš„setupæ–¹æ³•ï¼š\n# from distutils.core import setup from setuptools import setup ","title":"wheel"}]